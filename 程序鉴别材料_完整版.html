<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>程序鉴别材料 - ExcelAIFinder V1.0</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Consolas', 'Courier New', monospace; font-size: 10pt; line-height: 1.4; color: #000; background: #fff; }
        .page { width: 210mm; min-height: 297mm; padding: 15mm 20mm; margin: 0 auto; background: white; page-break-after: always; position: relative; }
        .page:last-child { page-break-after: auto; }
        .header { position: absolute; top: 10mm; left: 20mm; right: 20mm; text-align: center; font-size: 12pt; font-weight: bold; border-bottom: 1px solid #000; padding-bottom: 3mm; }
        .page-number { position: absolute; top: 10mm; right: 20mm; font-size: 10pt; }
        .content { margin-top: 25mm; }
        .line { font-family: 'Consolas', monospace; font-size: 9pt; line-height: 1.3; white-space: pre-wrap; word-wrap: break-word; margin: 0; padding: 0; }
        .line-number { display: inline-block; width: 50px; text-align: right; padding-right: 10px; color: #666; font-size: 8pt; }
        .code-content { display: inline; }
        @media print { body { margin: 0; padding: 0; } .page { margin: 0; padding: 15mm 20mm; page-break-after: always; } }
        @page { size: A4; margin: 0; }
    </style>
</head>
<body>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 1 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1</span><span class="code-content">// src/main.js</span></pre>
            <pre class="line"><span class="line-number">2</span><span class="code-content">import Vue from &#039;vue&#039;</span></pre>
            <pre class="line"><span class="line-number">3</span><span class="code-content">import ElementUI from &#039;element-ui&#039;</span></pre>
            <pre class="line"><span class="line-number">4</span><span class="code-content">import &#039;element-ui/lib/theme-chalk/index.css&#039;</span></pre>
            <pre class="line"><span class="line-number">5</span><span class="code-content">import App from &#039;./App.vue&#039;</span></pre>
            <pre class="line"><span class="line-number">6</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">7</span><span class="code-content">Vue.use(ElementUI)</span></pre>
            <pre class="line"><span class="line-number">8</span><span class="code-content">Vue.config.productionTip = false</span></pre>
            <pre class="line"><span class="line-number">9</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">10</span><span class="code-content">new Vue({</span></pre>
            <pre class="line"><span class="line-number">11</span><span class="code-content">  render: h =&gt; h(App)</span></pre>
            <pre class="line"><span class="line-number">12</span><span class="code-content">}).$mount(&#039;#app&#039;) </span></pre>
            <pre class="line"><span class="line-number">13</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">14</span><span class="code-content">// src/App.vue</span></pre>
            <pre class="line"><span class="line-number">15</span><span class="code-content">&lt;template&gt;</span></pre>
            <pre class="line"><span class="line-number">16</span><span class="code-content">  &lt;div id=&quot;app&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">17</span><span class="code-content">    &lt;ExcelContentFinder /&gt;</span></pre>
            <pre class="line"><span class="line-number">18</span><span class="code-content">  &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">19</span><span class="code-content">&lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">20</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">21</span><span class="code-content">&lt;script&gt;</span></pre>
            <pre class="line"><span class="line-number">22</span><span class="code-content">import ExcelContentFinder from &#039;./components/ExcelContentFinder.vue&#039;</span></pre>
            <pre class="line"><span class="line-number">23</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">24</span><span class="code-content">export default {</span></pre>
            <pre class="line"><span class="line-number">25</span><span class="code-content">  name: &#039;App&#039;,</span></pre>
            <pre class="line"><span class="line-number">26</span><span class="code-content">  components: {</span></pre>
            <pre class="line"><span class="line-number">27</span><span class="code-content">    ExcelContentFinder</span></pre>
            <pre class="line"><span class="line-number">28</span><span class="code-content">  }</span></pre>
            <pre class="line"><span class="line-number">29</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">30</span><span class="code-content">&lt;/script&gt;</span></pre>
            <pre class="line"><span class="line-number">31</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">32</span><span class="code-content">&lt;style&gt;</span></pre>
            <pre class="line"><span class="line-number">33</span><span class="code-content">#app {</span></pre>
            <pre class="line"><span class="line-number">34</span><span class="code-content">  font-family: Avenir, Helvetica, Arial, sans-serif;</span></pre>
            <pre class="line"><span class="line-number">35</span><span class="code-content">  -webkit-font-smoothing: antialiased;</span></pre>
            <pre class="line"><span class="line-number">36</span><span class="code-content">  -moz-osx-font-smoothing: grayscale;</span></pre>
            <pre class="line"><span class="line-number">37</span><span class="code-content">  color: #2c3e50;</span></pre>
            <pre class="line"><span class="line-number">38</span><span class="code-content">  margin-top: 60px;</span></pre>
            <pre class="line"><span class="line-number">39</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">40</span><span class="code-content">&lt;/style&gt; </span></pre>
            <pre class="line"><span class="line-number">41</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">42</span><span class="code-content">// src/components/ExcelContentFinder.vue</span></pre>
            <pre class="line"><span class="line-number">43</span><span class="code-content">&lt;template&gt;</span></pre>
            <pre class="line"><span class="line-number">44</span><span class="code-content">  &lt;div class=&quot;excel-content-finder&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">45</span><span class="code-content">    &lt;h2&gt;Excel 内容查找器&lt;/h2&gt;</span></pre>
            <pre class="line"><span class="line-number">46</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">47</span><span class="code-content">    &lt;div class=&quot;server-status-container&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">48</span><span class="code-content">    &lt;div class=&quot;server-status&quot; :class=&quot;{ &#039;connected&#039;: serverConnected }&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">49</span><span class="code-content">      服务器状态: {{ serverConnected ? &#039;已连接&#039; : &#039;未连接&#039; }}</span></pre>
            <pre class="line"><span class="line-number">50</span><span class="code-content">      &lt;/div&gt;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 2 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">51</span><span class="code-content">      &lt;el-tooltip content=&quot;API配置设置&quot; placement=&quot;bottom&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">52</span><span class="code-content">        &lt;el-button </span></pre>
            <pre class="line"><span class="line-number">53</span><span class="code-content">          type=&quot;primary&quot;</span></pre>
            <pre class="line"><span class="line-number">54</span><span class="code-content">          icon=&quot;el-icon-setting&quot; </span></pre>
            <pre class="line"><span class="line-number">55</span><span class="code-content">          @click=&quot;showApiConfig = true&quot;</span></pre>
            <pre class="line"><span class="line-number">56</span><span class="code-content">          circle</span></pre>
            <pre class="line"><span class="line-number">57</span><span class="code-content">          size=&quot;small&quot;</span></pre>
            <pre class="line"><span class="line-number">58</span><span class="code-content">          class=&quot;api-config-button&quot;</span></pre>
            <pre class="line"><span class="line-number">59</span><span class="code-content">        &gt;&lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">60</span><span class="code-content">      &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">61</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">62</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">63</span><span class="code-content">    &lt;!-- API配置对话框 --&gt;</span></pre>
            <pre class="line"><span class="line-number">64</span><span class="code-content">    &lt;el-dialog</span></pre>
            <pre class="line"><span class="line-number">65</span><span class="code-content">      title=&quot;API配置&quot;</span></pre>
            <pre class="line"><span class="line-number">66</span><span class="code-content">      :visible.sync=&quot;showApiConfig&quot;</span></pre>
            <pre class="line"><span class="line-number">67</span><span class="code-content">      width=&quot;500px&quot;</span></pre>
            <pre class="line"><span class="line-number">68</span><span class="code-content">      @open=&quot;onConfigDialogOpen&quot;</span></pre>
            <pre class="line"><span class="line-number">69</span><span class="code-content">    &gt;</span></pre>
            <pre class="line"><span class="line-number">70</span><span class="code-content">      &lt;el-alert</span></pre>
            <pre class="line"><span class="line-number">71</span><span class="code-content">        v-if=&quot;apiErrorMessage&quot;</span></pre>
            <pre class="line"><span class="line-number">72</span><span class="code-content">        title=&quot;API连接错误&quot;</span></pre>
            <pre class="line"><span class="line-number">73</span><span class="code-content">        type=&quot;error&quot;</span></pre>
            <pre class="line"><span class="line-number">74</span><span class="code-content">        description=&quot;当前API配置可能无效，请检查并更新配置信息。&quot;</span></pre>
            <pre class="line"><span class="line-number">75</span><span class="code-content">        show-icon</span></pre>
            <pre class="line"><span class="line-number">76</span><span class="code-content">        :closable=&quot;false&quot;</span></pre>
            <pre class="line"><span class="line-number">77</span><span class="code-content">        style=&quot;margin-bottom: 20px&quot;</span></pre>
            <pre class="line"><span class="line-number">78</span><span class="code-content">      &gt;</span></pre>
            <pre class="line"><span class="line-number">79</span><span class="code-content">        &lt;div class=&quot;error-details&quot;&gt;{{ apiErrorMessage }}&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">80</span><span class="code-content">      &lt;/el-alert&gt;</span></pre>
            <pre class="line"><span class="line-number">81</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">82</span><span class="code-content">      &lt;el-form :model=&quot;apiConfig&quot; label-width=&quot;120px&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">83</span><span class="code-content">        &lt;el-form-item label=&quot;API地址&quot; required&gt;</span></pre>
            <pre class="line"><span class="line-number">84</span><span class="code-content">          &lt;el-input v-model=&quot;apiConfig.apiUrl&quot; placeholder=&quot;例如: https://www.sophnet.com/api/open-apis/v1/chat/completions&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">85</span><span class="code-content">            &lt;template slot=&quot;prepend&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">86</span><span class="code-content">              &lt;el-tooltip content=&quot;API地址应为SophNet官方提供的完整URL&quot; placement=&quot;top&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">87</span><span class="code-content">                &lt;i class=&quot;el-icon-info&quot;&gt;&lt;/i&gt;</span></pre>
            <pre class="line"><span class="line-number">88</span><span class="code-content">              &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">89</span><span class="code-content">            &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">90</span><span class="code-content">          &lt;/el-input&gt;</span></pre>
            <pre class="line"><span class="line-number">91</span><span class="code-content">        &lt;/el-form-item&gt;</span></pre>
            <pre class="line"><span class="line-number">92</span><span class="code-content">        &lt;el-form-item label=&quot;API密钥&quot; required&gt;</span></pre>
            <pre class="line"><span class="line-number">93</span><span class="code-content">          &lt;el-input </span></pre>
            <pre class="line"><span class="line-number">94</span><span class="code-content">            v-model=&quot;apiConfig.apiKey&quot; </span></pre>
            <pre class="line"><span class="line-number">95</span><span class="code-content">            placeholder=&quot;输入您的API密钥&quot;</span></pre>
            <pre class="line"><span class="line-number">96</span><span class="code-content">            :type=&quot;showApiKey ? &#039;text&#039; : &#039;password&#039;&quot;</span></pre>
            <pre class="line"><span class="line-number">97</span><span class="code-content">          &gt;</span></pre>
            <pre class="line"><span class="line-number">98</span><span class="code-content">            &lt;template slot=&quot;prepend&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">99</span><span class="code-content">              &lt;el-tooltip content=&quot;API密钥应为SophNet平台生成的密钥，不包含额外空格&quot; placement=&quot;top&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">100</span><span class="code-content">                &lt;i class=&quot;el-icon-info&quot;&gt;&lt;/i&gt;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 3 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">101</span><span class="code-content">              &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">102</span><span class="code-content">            &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">103</span><span class="code-content">            &lt;el-button </span></pre>
            <pre class="line"><span class="line-number">104</span><span class="code-content">              slot=&quot;append&quot; </span></pre>
            <pre class="line"><span class="line-number">105</span><span class="code-content">              icon=&quot;el-icon-view&quot; </span></pre>
            <pre class="line"><span class="line-number">106</span><span class="code-content">              @click=&quot;showApiKey = !showApiKey&quot;</span></pre>
            <pre class="line"><span class="line-number">107</span><span class="code-content">            &gt;&lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">108</span><span class="code-content">          &lt;/el-input&gt;</span></pre>
            <pre class="line"><span class="line-number">109</span><span class="code-content">          &lt;div class=&quot;form-tip&quot;&gt;注意：授权格式为 &quot;Bearer API密钥&quot;，请确保API密钥无多余空格&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">110</span><span class="code-content">        &lt;/el-form-item&gt;</span></pre>
            <pre class="line"><span class="line-number">111</span><span class="code-content">        &lt;el-form-item label=&quot;模型名称&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">112</span><span class="code-content">          &lt;el-select v-model=&quot;apiConfig.model&quot; placeholder=&quot;请选择模型&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">113</span><span class="code-content">            &lt;el-option</span></pre>
            <pre class="line"><span class="line-number">114</span><span class="code-content">              v-for=&quot;item in modelOptions&quot;</span></pre>
            <pre class="line"><span class="line-number">115</span><span class="code-content">              :key=&quot;item.value&quot;</span></pre>
            <pre class="line"><span class="line-number">116</span><span class="code-content">              :label=&quot;item.label&quot;</span></pre>
            <pre class="line"><span class="line-number">117</span><span class="code-content">              :value=&quot;item.value&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">118</span><span class="code-content">            &lt;/el-option&gt;</span></pre>
            <pre class="line"><span class="line-number">119</span><span class="code-content">          &lt;/el-select&gt;</span></pre>
            <pre class="line"><span class="line-number">120</span><span class="code-content">          &lt;div class=&quot;form-tip&quot;&gt;SophNet API仅支持max_tokens参数，其他超参数如temperature在此模型中不支持&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">121</span><span class="code-content">        &lt;/el-form-item&gt;</span></pre>
            <pre class="line"><span class="line-number">122</span><span class="code-content">        &lt;el-form-item label=&quot;最大Token数&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">123</span><span class="code-content">          &lt;el-slider</span></pre>
            <pre class="line"><span class="line-number">124</span><span class="code-content">            v-model=&quot;apiConfig.maxTokens&quot;</span></pre>
            <pre class="line"><span class="line-number">125</span><span class="code-content">            :min=&quot;1000&quot;</span></pre>
            <pre class="line"><span class="line-number">126</span><span class="code-content">            :max=&quot;32768&quot;</span></pre>
            <pre class="line"><span class="line-number">127</span><span class="code-content">            :step=&quot;100&quot;</span></pre>
            <pre class="line"><span class="line-number">128</span><span class="code-content">            show-input</span></pre>
            <pre class="line"><span class="line-number">129</span><span class="code-content">            :show-input-controls=&quot;false&quot;</span></pre>
            <pre class="line"><span class="line-number">130</span><span class="code-content">            input-size=&quot;mini&quot;</span></pre>
            <pre class="line"><span class="line-number">131</span><span class="code-content">          &gt;&lt;/el-slider&gt;</span></pre>
            <pre class="line"><span class="line-number">132</span><span class="code-content">          &lt;div class=&quot;form-tip&quot;&gt;建议值：32768 (SophNet推荐最大值)&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">133</span><span class="code-content">        &lt;/el-form-item&gt;</span></pre>
            <pre class="line"><span class="line-number">134</span><span class="code-content">      &lt;/el-form&gt;</span></pre>
            <pre class="line"><span class="line-number">135</span><span class="code-content">      &lt;div slot=&quot;footer&quot; class=&quot;dialog-footer&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">136</span><span class="code-content">        &lt;el-button @click=&quot;resetApiConfig&quot; type=&quot;info&quot; plain&gt;重置&lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">137</span><span class="code-content">        &lt;el-button @click=&quot;showApiConfig = false&quot;&gt;取消&lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">138</span><span class="code-content">        &lt;el-button type=&quot;primary&quot; @click=&quot;saveApiConfig&quot; :loading=&quot;saveConfigLoading&quot;&gt;保存配置&lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">139</span><span class="code-content">        &lt;el-button type=&quot;success&quot; @click=&quot;testApiConnection&quot; :loading=&quot;testApiLoading&quot;&gt;测试连接&lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">140</span><span class="code-content">      &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">141</span><span class="code-content">    &lt;/el-dialog&gt;</span></pre>
            <pre class="line"><span class="line-number">142</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">143</span><span class="code-content">    &lt;!-- 分析方式说明 --&gt;</span></pre>
            <pre class="line"><span class="line-number">144</span><span class="code-content">    &lt;div class=&quot;analysis-method-info&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">145</span><span class="code-content">      &lt;el-collapse&gt;</span></pre>
            <pre class="line"><span class="line-number">146</span><span class="code-content">        &lt;el-collapse-item title=&quot;关于分析方式&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">147</span><span class="code-content">          &lt;p&gt;本系统使用以下方式分析Excel文件:&lt;/p&gt;</span></pre>
            <pre class="line"><span class="line-number">148</span><span class="code-content">          &lt;ol&gt;</span></pre>
            <pre class="line"><span class="line-number">149</span><span class="code-content">            &lt;li&gt;上传Excel文件到服务器&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">150</span><span class="code-content">            &lt;li&gt;使用XLSX库读取文件内容和结构&lt;/li&gt;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 4 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">151</span><span class="code-content">            &lt;li&gt;按行提取工作表中的文本数据&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">152</span><span class="code-content">            &lt;li&gt;进行两种层次的分析：</span></pre>
            <pre class="line"><span class="line-number">153</span><span class="code-content">              &lt;ul&gt;</span></pre>
            <pre class="line"><span class="line-number">154</span><span class="code-content">                &lt;li&gt;基本匹配：直接搜索文本内容中是否包含搜索词&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">155</span><span class="code-content">                &lt;li&gt;语义分析：通过SophNet AI (DeepSeek-R1/v3系列模型)分析文本内容与搜索内容的语义相关度&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">156</span><span class="code-content">              &lt;/ul&gt;</span></pre>
            <pre class="line"><span class="line-number">157</span><span class="code-content">            &lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">158</span><span class="code-content">            &lt;li&gt;返回0-100的相关度分数和具体匹配位置&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">159</span><span class="code-content">            &lt;li&gt;根据分数和匹配项提供文件相关性排序和建议&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">160</span><span class="code-content">          &lt;/ol&gt;</span></pre>
            <pre class="line"><span class="line-number">161</span><span class="code-content">          &lt;div class=&quot;api-info&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">162</span><span class="code-content">            &lt;p&gt;&lt;strong&gt;API技术说明：&lt;/strong&gt;&lt;/p&gt;</span></pre>
            <pre class="line"><span class="line-number">163</span><span class="code-content">            &lt;p&gt;本系统使用SophNet API进行语义分析，其中：&lt;/p&gt;</span></pre>
            <pre class="line"><span class="line-number">164</span><span class="code-content">            &lt;ul&gt;</span></pre>
            <pre class="line"><span class="line-number">165</span><span class="code-content">              &lt;li&gt;支持DeepSeek-R1、DeepSeek-v3等大语言模型&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">166</span><span class="code-content">              &lt;li&gt;使用最大Token限制控制API请求消耗&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">167</span><span class="code-content">              &lt;li&gt;采用智能分析优化策略：</span></pre>
            <pre class="line"><span class="line-number">168</span><span class="code-content">                &lt;ul&gt;</span></pre>
            <pre class="line"><span class="line-number">169</span><span class="code-content">                  &lt;li&gt;当文件中有大量直接匹配(&gt;5处)时，自动跳过API调用，节约Token&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">170</span><span class="code-content">                  &lt;li&gt;分析时只提取必要的文本片段(最多1000字符)，降低处理负担&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">171</span><span class="code-content">                  &lt;li&gt;支持限制批处理文件数量，避免超时错误&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">172</span><span class="code-content">                &lt;/ul&gt;</span></pre>
            <pre class="line"><span class="line-number">173</span><span class="code-content">              &lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">174</span><span class="code-content">              &lt;li&gt;通过Bearer认证方式进行API调用&lt;/li&gt;</span></pre>
            <pre class="line"><span class="line-number">175</span><span class="code-content">            &lt;/ul&gt;</span></pre>
            <pre class="line"><span class="line-number">176</span><span class="code-content">          &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">177</span><span class="code-content">          &lt;p class=&quot;small-text&quot;&gt;注: 分析仅针对Excel中的文本内容，暂不支持图表、图片等非文本元素的分析&lt;/p&gt;</span></pre>
            <pre class="line"><span class="line-number">178</span><span class="code-content">        &lt;/el-collapse-item&gt;</span></pre>
            <pre class="line"><span class="line-number">179</span><span class="code-content">      &lt;/el-collapse&gt;</span></pre>
            <pre class="line"><span class="line-number">180</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">181</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">182</span><span class="code-content">    &lt;!-- 文件选择区域 --&gt;</span></pre>
            <pre class="line"><span class="line-number">183</span><span class="code-content">    &lt;div class=&quot;folder-selection-section&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">184</span><span class="code-content">      &lt;el-button @click=&quot;$refs.folderInput.click()&quot; :disabled=&quot;loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">185</span><span class="code-content">        选择本地文件夹</span></pre>
            <pre class="line"><span class="line-number">186</span><span class="code-content">      &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">187</span><span class="code-content">      &lt;span v-if=&quot;selectedFiles.length &gt; 0&quot; class=&quot;selected-files-info&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">188</span><span class="code-content">        已选择 {{ selectedFiles.length }} 个Excel文件</span></pre>
            <pre class="line"><span class="line-number">189</span><span class="code-content">        &lt;el-tooltip content=&quot;选择过多文件可能导致处理时间过长&quot; placement=&quot;top&quot; v-if=&quot;selectedFiles.length &gt; 10&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">190</span><span class="code-content">          &lt;i class=&quot;el-icon-warning&quot; style=&quot;color: #E6A23C;&quot;&gt;&lt;/i&gt;</span></pre>
            <pre class="line"><span class="line-number">191</span><span class="code-content">        &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">192</span><span class="code-content">      &lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">193</span><span class="code-content">      &lt;input </span></pre>
            <pre class="line"><span class="line-number">194</span><span class="code-content">        ref=&quot;folderInput&quot; </span></pre>
            <pre class="line"><span class="line-number">195</span><span class="code-content">        type=&quot;file&quot; </span></pre>
            <pre class="line"><span class="line-number">196</span><span class="code-content">        webkitdirectory </span></pre>
            <pre class="line"><span class="line-number">197</span><span class="code-content">        multiple </span></pre>
            <pre class="line"><span class="line-number">198</span><span class="code-content">        style=&quot;display: none&quot; </span></pre>
            <pre class="line"><span class="line-number">199</span><span class="code-content">        @change=&quot;handleFolderSelection&quot; </span></pre>
            <pre class="line"><span class="line-number">200</span><span class="code-content">      /&gt;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 5 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">201</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">202</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">203</span><span class="code-content">    &lt;div class=&quot;search-section&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">204</span><span class="code-content">      &lt;el-input</span></pre>
            <pre class="line"><span class="line-number">205</span><span class="code-content">        v-model=&quot;searchContent&quot;</span></pre>
            <pre class="line"><span class="line-number">206</span><span class="code-content">        placeholder=&quot;请输入要在所选文件中查找的内容&quot;</span></pre>
            <pre class="line"><span class="line-number">207</span><span class="code-content">        class=&quot;search-input&quot;</span></pre>
            <pre class="line"><span class="line-number">208</span><span class="code-content">        clearable</span></pre>
            <pre class="line"><span class="line-number">209</span><span class="code-content">        @keyup.enter=&quot;startBatchAnalysis&quot;</span></pre>
            <pre class="line"><span class="line-number">210</span><span class="code-content">        :disabled=&quot;loading&quot;</span></pre>
            <pre class="line"><span class="line-number">211</span><span class="code-content">      /&gt;</span></pre>
            <pre class="line"><span class="line-number">212</span><span class="code-content">      &lt;el-button </span></pre>
            <pre class="line"><span class="line-number">213</span><span class="code-content">        type=&quot;primary&quot; </span></pre>
            <pre class="line"><span class="line-number">214</span><span class="code-content">        @click=&quot;startBatchAnalysis&quot; </span></pre>
            <pre class="line"><span class="line-number">215</span><span class="code-content">        :loading=&quot;loading&quot; </span></pre>
            <pre class="line"><span class="line-number">216</span><span class="code-content">        :disabled=&quot;!serverConnected || !searchContent || selectedFiles.length === 0 || loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">217</span><span class="code-content">        {{ loading ? &#039;分析中...&#039; : &#039;分析&#039; }}</span></pre>
            <pre class="line"><span class="line-number">218</span><span class="code-content">      &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">219</span><span class="code-content">      &lt;el-button </span></pre>
            <pre class="line"><span class="line-number">220</span><span class="code-content">        type=&quot;text&quot; </span></pre>
            <pre class="line"><span class="line-number">221</span><span class="code-content">        @click=&quot;showAdvancedOptions = !showAdvancedOptions&quot; </span></pre>
            <pre class="line"><span class="line-number">222</span><span class="code-content">        :disabled=&quot;loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">223</span><span class="code-content">        高级选项</span></pre>
            <pre class="line"><span class="line-number">224</span><span class="code-content">        &lt;i :class=&quot;showAdvancedOptions ? &#039;el-icon-arrow-up&#039; : &#039;el-icon-arrow-down&#039;&quot;&gt;&lt;/i&gt;</span></pre>
            <pre class="line"><span class="line-number">225</span><span class="code-content">      &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">226</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">227</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">228</span><span class="code-content">    &lt;!-- 高级选项 --&gt;</span></pre>
            <pre class="line"><span class="line-number">229</span><span class="code-content">    &lt;el-collapse-transition&gt;</span></pre>
            <pre class="line"><span class="line-number">230</span><span class="code-content">      &lt;div v-if=&quot;showAdvancedOptions&quot; class=&quot;advanced-options&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">231</span><span class="code-content">        &lt;el-card&gt;</span></pre>
            <pre class="line"><span class="line-number">232</span><span class="code-content">          &lt;div slot=&quot;header&quot; class=&quot;clearfix&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">233</span><span class="code-content">            &lt;span&gt;高级搜索选项&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">234</span><span class="code-content">          &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">235</span><span class="code-content">          &lt;el-form label-position=&quot;left&quot; label-width=&quot;140px&quot; size=&quot;small&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">236</span><span class="code-content">            &lt;el-form-item label=&quot;内容理解模式&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">237</span><span class="code-content">              &lt;el-select v-model=&quot;searchOptions.understandingMode&quot; style=&quot;width: 100%&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">238</span><span class="code-content">                &lt;el-option label=&quot;智能语义理解 (更理解意图)&quot; value=&quot;semantic&quot; /&gt;</span></pre>
            <pre class="line"><span class="line-number">239</span><span class="code-content">                &lt;el-option label=&quot;精确匹配 (更关注关键词)&quot; value=&quot;exact&quot; /&gt;</span></pre>
            <pre class="line"><span class="line-number">240</span><span class="code-content">                &lt;el-option label=&quot;平衡模式 (结合两种方法)&quot; value=&quot;balanced&quot; /&gt;</span></pre>
            <pre class="line"><span class="line-number">241</span><span class="code-content">              &lt;/el-select&gt;</span></pre>
            <pre class="line"><span class="line-number">242</span><span class="code-content">            &lt;/el-form-item&gt;</span></pre>
            <pre class="line"><span class="line-number">243</span><span class="code-content">            </span></pre>
            <pre class="line"><span class="line-number">244</span><span class="code-content">            &lt;el-form-item label=&quot;最低相关度阈值&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">245</span><span class="code-content">              &lt;el-slider </span></pre>
            <pre class="line"><span class="line-number">246</span><span class="code-content">                v-model=&quot;searchOptions.minRelevanceThreshold&quot;</span></pre>
            <pre class="line"><span class="line-number">247</span><span class="code-content">                :min=&quot;0&quot;</span></pre>
            <pre class="line"><span class="line-number">248</span><span class="code-content">                :max=&quot;100&quot;</span></pre>
            <pre class="line"><span class="line-number">249</span><span class="code-content">                :step=&quot;5&quot;</span></pre>
            <pre class="line"><span class="line-number">250</span><span class="code-content">                :format-tooltip=&quot;value =&gt; `${value}%`&quot;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 6 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">251</span><span class="code-content">                show-stops</span></pre>
            <pre class="line"><span class="line-number">252</span><span class="code-content">                show-input</span></pre>
            <pre class="line"><span class="line-number">253</span><span class="code-content">              /&gt;</span></pre>
            <pre class="line"><span class="line-number">254</span><span class="code-content">            &lt;/el-form-item&gt;</span></pre>
            <pre class="line"><span class="line-number">255</span><span class="code-content">            </span></pre>
            <pre class="line"><span class="line-number">256</span><span class="code-content">            &lt;el-form-item label=&quot;分析深度&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">257</span><span class="code-content">              &lt;el-radio-group v-model=&quot;searchOptions.analysisDepth&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">258</span><span class="code-content">                &lt;el-radio label=&quot;shallow&quot;&gt;浅层 (速度快，仅分析匹配区域)&lt;/el-radio&gt;</span></pre>
            <pre class="line"><span class="line-number">259</span><span class="code-content">                &lt;el-radio label=&quot;deep&quot;&gt;深层 (更全面，分析更多内容)&lt;/el-radio&gt;</span></pre>
            <pre class="line"><span class="line-number">260</span><span class="code-content">              &lt;/el-radio-group&gt;</span></pre>
            <pre class="line"><span class="line-number">261</span><span class="code-content">            &lt;/el-form-item&gt;</span></pre>
            <pre class="line"><span class="line-number">262</span><span class="code-content">          &lt;/el-form&gt;</span></pre>
            <pre class="line"><span class="line-number">263</span><span class="code-content">        &lt;/el-card&gt;</span></pre>
            <pre class="line"><span class="line-number">264</span><span class="code-content">      &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">265</span><span class="code-content">    &lt;/el-collapse-transition&gt;</span></pre>
            <pre class="line"><span class="line-number">266</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">267</span><span class="code-content">    &lt;!-- 批量处理配置 --&gt;</span></pre>
            <pre class="line"><span class="line-number">268</span><span class="code-content">    &lt;div class=&quot;batch-process-settings&quot; v-if=&quot;selectedFiles.length &gt; 5&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">269</span><span class="code-content">      &lt;el-alert</span></pre>
            <pre class="line"><span class="line-number">270</span><span class="code-content">        title=&quot;处理优化设置&quot;</span></pre>
            <pre class="line"><span class="line-number">271</span><span class="code-content">        type=&quot;info&quot;</span></pre>
            <pre class="line"><span class="line-number">272</span><span class="code-content">        :closable=&quot;false&quot;</span></pre>
            <pre class="line"><span class="line-number">273</span><span class="code-content">        show-icon</span></pre>
            <pre class="line"><span class="line-number">274</span><span class="code-content">      &gt;</span></pre>
            <pre class="line"><span class="line-number">275</span><span class="code-content">        &lt;div&gt;</span></pre>
            <pre class="line"><span class="line-number">276</span><span class="code-content">          &lt;span&gt;每批处理文件数量：&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">277</span><span class="code-content">          &lt;el-select v-model=&quot;batchSizeLimit&quot; size=&quot;small&quot; style=&quot;width: 120px;&quot; :disabled=&quot;loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">278</span><span class="code-content">            &lt;el-option :value=&quot;5&quot; label=&quot;5 个&quot;&gt;&lt;/el-option&gt;</span></pre>
            <pre class="line"><span class="line-number">279</span><span class="code-content">            &lt;el-option :value=&quot;10&quot; label=&quot;10 个&quot;&gt;&lt;/el-option&gt;</span></pre>
            <pre class="line"><span class="line-number">280</span><span class="code-content">            &lt;el-option :value=&quot;20&quot; label=&quot;20 个&quot;&gt;&lt;/el-option&gt;</span></pre>
            <pre class="line"><span class="line-number">281</span><span class="code-content">            &lt;el-option :value=&quot;50&quot; label=&quot;50 个&quot;&gt;&lt;/el-option&gt;</span></pre>
            <pre class="line"><span class="line-number">282</span><span class="code-content">            &lt;el-option :value=&quot;0&quot; label=&quot;不限制&quot;&gt;&lt;/el-option&gt;</span></pre>
            <pre class="line"><span class="line-number">283</span><span class="code-content">          &lt;/el-select&gt;</span></pre>
            <pre class="line"><span class="line-number">284</span><span class="code-content">          &lt;el-tooltip content=&quot;限制一次处理的文件数量，可减少请求超时风险&quot; placement=&quot;right&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">285</span><span class="code-content">            &lt;i class=&quot;el-icon-question&quot; style=&quot;margin-left: 5px;&quot;&gt;&lt;/i&gt;</span></pre>
            <pre class="line"><span class="line-number">286</span><span class="code-content">          &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">287</span><span class="code-content">        &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">288</span><span class="code-content">      &lt;/el-alert&gt;</span></pre>
            <pre class="line"><span class="line-number">289</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">290</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">291</span><span class="code-content">    &lt;!-- 批次处理进度 --&gt;</span></pre>
            <pre class="line"><span class="line-number">292</span><span class="code-content">    &lt;div v-if=&quot;batchProcessInfo.enabled&quot; class=&quot;batch-process-info&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">293</span><span class="code-content">      &lt;el-alert</span></pre>
            <pre class="line"><span class="line-number">294</span><span class="code-content">        :title=&quot;`批次处理进度: ${batchProcessInfo.currentBatch}/${batchProcessInfo.totalBatches}`&quot;</span></pre>
            <pre class="line"><span class="line-number">295</span><span class="code-content">        type=&quot;success&quot;</span></pre>
            <pre class="line"><span class="line-number">296</span><span class="code-content">        :closable=&quot;false&quot;</span></pre>
            <pre class="line"><span class="line-number">297</span><span class="code-content">        show-icon</span></pre>
            <pre class="line"><span class="line-number">298</span><span class="code-content">      &gt;</span></pre>
            <pre class="line"><span class="line-number">299</span><span class="code-content">        &lt;div&gt;</span></pre>
            <pre class="line"><span class="line-number">300</span><span class="code-content">          &lt;el-progress </span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 7 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">301</span><span class="code-content">            :percentage=&quot;batchProcessInfo.percentage&quot; </span></pre>
            <pre class="line"><span class="line-number">302</span><span class="code-content">            :text-inside=&quot;true&quot; </span></pre>
            <pre class="line"><span class="line-number">303</span><span class="code-content">            :stroke-width=&quot;18&quot;</span></pre>
            <pre class="line"><span class="line-number">304</span><span class="code-content">            :status=&quot;batchProcessInfo.currentBatch === batchProcessInfo.totalBatches ? &#039;success&#039; : &#039;warning&#039;&quot;</span></pre>
            <pre class="line"><span class="line-number">305</span><span class="code-content">          &gt;&lt;/el-progress&gt;</span></pre>
            <pre class="line"><span class="line-number">306</span><span class="code-content">          &lt;div class=&quot;batch-process-stats&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">307</span><span class="code-content">            &lt;span&gt;已处理: {{batchProcessInfo.processedFiles}} 个文件&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">308</span><span class="code-content">            &lt;span&gt;总计: {{batchProcessInfo.totalFiles}} 个文件&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">309</span><span class="code-content">            &lt;span v-if=&quot;batchProcessInfo.processedFiles &lt; batchProcessInfo.totalFiles &amp;&amp; !loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">310</span><span class="code-content">              &lt;el-button size=&quot;mini&quot; type=&quot;primary&quot; @click=&quot;continueNextBatch&quot;&gt;继续下一批&lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">311</span><span class="code-content">            &lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">312</span><span class="code-content">          &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">313</span><span class="code-content">        &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">314</span><span class="code-content">      &lt;/el-alert&gt;</span></pre>
            <pre class="line"><span class="line-number">315</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">316</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">317</span><span class="code-content">    &lt;!-- 状态区域 --&gt;</span></pre>
            <pre class="line"><span class="line-number">318</span><span class="code-content">    &lt;div v-if=&quot;loading || analysisLogs.length &gt; 0&quot; class=&quot;status-section&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">319</span><span class="code-content">      &lt;el-collapse v-model=&quot;processCollapse&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">320</span><span class="code-content">        &lt;el-collapse-item name=&quot;process&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">321</span><span class="code-content">          &lt;template slot=&quot;title&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">322</span><span class="code-content">            &lt;span v-if=&quot;loading&quot;&gt;正在分析文件中，请耐心等待...&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">323</span><span class="code-content">            &lt;span v-else&gt;分析已完成 ({{ searchResults.length }} 个结果)&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">324</span><span class="code-content">          &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">325</span><span class="code-content">          &lt;div&gt;</span></pre>
            <pre class="line"><span class="line-number">326</span><span class="code-content">            &lt;el-progress </span></pre>
            <pre class="line"><span class="line-number">327</span><span class="code-content">              v-if=&quot;loading &amp;&amp; analysisProgress.total &gt; 0&quot; </span></pre>
            <pre class="line"><span class="line-number">328</span><span class="code-content">              :percentage=&quot;analysisProgressPercentage&quot; </span></pre>
            <pre class="line"><span class="line-number">329</span><span class="code-content">              :text-inside=&quot;true&quot; </span></pre>
            <pre class="line"><span class="line-number">330</span><span class="code-content">              :stroke-width=&quot;20&quot;</span></pre>
            <pre class="line"><span class="line-number">331</span><span class="code-content">              style=&quot;margin-top: 10px; margin-bottom: 15px;&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">332</span><span class="code-content">              &lt;span&gt;{{ analysisProgress.processed }} / {{ analysisProgress.total }} 文件&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">333</span><span class="code-content">            &lt;/el-progress&gt;</span></pre>
            <pre class="line"><span class="line-number">334</span><span class="code-content">            </span></pre>
            <pre class="line"><span class="line-number">335</span><span class="code-content">            &lt;!-- 分析日志 --&gt;</span></pre>
            <pre class="line"><span class="line-number">336</span><span class="code-content">            &lt;div v-if=&quot;analysisLogs.length &gt; 0&quot; class=&quot;analysis-logs&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">337</span><span class="code-content">              &lt;div class=&quot;log-header&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">338</span><span class="code-content">                &lt;span&gt;分析日志&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">339</span><span class="code-content">                &lt;el-button </span></pre>
            <pre class="line"><span class="line-number">340</span><span class="code-content">                  type=&quot;text&quot; </span></pre>
            <pre class="line"><span class="line-number">341</span><span class="code-content">                  size=&quot;mini&quot; </span></pre>
            <pre class="line"><span class="line-number">342</span><span class="code-content">                  @click=&quot;clearAnalysisLogs&quot;</span></pre>
            <pre class="line"><span class="line-number">343</span><span class="code-content">                  v-if=&quot;!loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">344</span><span class="code-content">                  清除日志</span></pre>
            <pre class="line"><span class="line-number">345</span><span class="code-content">                &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">346</span><span class="code-content">              &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">347</span><span class="code-content">              &lt;div class=&quot;log-container&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">348</span><span class="code-content">                &lt;div </span></pre>
            <pre class="line"><span class="line-number">349</span><span class="code-content">                  v-for=&quot;(log, index) in analysisLogs&quot; </span></pre>
            <pre class="line"><span class="line-number">350</span><span class="code-content">                  :key=&quot;index&quot; </span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 8 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">351</span><span class="code-content">                  class=&quot;log-item&quot;</span></pre>
            <pre class="line"><span class="line-number">352</span><span class="code-content">                  :class=&quot;{&#039;log-error&#039;: log.type === &#039;error&#039;, &#039;log-success&#039;: log.type === &#039;success&#039;}&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">353</span><span class="code-content">                  &lt;span class=&quot;log-time&quot;&gt;{{ log.time }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">354</span><span class="code-content">                  &lt;span class=&quot;log-message&quot;&gt;{{ log.message }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">355</span><span class="code-content">                &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">356</span><span class="code-content">              &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">357</span><span class="code-content">            &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">358</span><span class="code-content">          &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">359</span><span class="code-content">        &lt;/el-collapse-item&gt;</span></pre>
            <pre class="line"><span class="line-number">360</span><span class="code-content">      &lt;/el-collapse&gt;</span></pre>
            <pre class="line"><span class="line-number">361</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">362</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">363</span><span class="code-content">    &lt;!-- 文件列表 --&gt;</span></pre>
            <pre class="line"><span class="line-number">364</span><span class="code-content">    &lt;div v-if=&quot;selectedFiles.length &gt; 0&quot; class=&quot;file-list-section&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">365</span><span class="code-content">      &lt;el-collapse v-model=&quot;fileListCollapse&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">366</span><span class="code-content">        &lt;el-collapse-item name=&quot;fileList&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">367</span><span class="code-content">          &lt;template slot=&quot;title&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">368</span><span class="code-content">            &lt;h3 style=&quot;margin: 0&quot;&gt;已选择的文件 ({{ selectedFiles.length }})&lt;/h3&gt;</span></pre>
            <pre class="line"><span class="line-number">369</span><span class="code-content">          &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">370</span><span class="code-content">          &lt;el-table :data=&quot;selectedFilesTable&quot; style=&quot;width: 100%&quot; height=&quot;200&quot; max-height=&quot;200&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">371</span><span class="code-content">            &lt;el-table-column prop=&quot;name&quot; label=&quot;文件名&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">372</span><span class="code-content">              &lt;template slot-scope=&quot;scope&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">373</span><span class="code-content">                &lt;el-tooltip :content=&quot;scope.row.name&quot; placement=&quot;top&quot; :disabled=&quot;scope.row.name.length &lt; 30&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">374</span><span class="code-content">                  &lt;span&gt;{{ scope.row.name }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">375</span><span class="code-content">                &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">376</span><span class="code-content">              &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">377</span><span class="code-content">            &lt;/el-table-column&gt;</span></pre>
            <pre class="line"><span class="line-number">378</span><span class="code-content">            &lt;el-table-column prop=&quot;size&quot; label=&quot;大小&quot; width=&quot;120&quot; /&gt;</span></pre>
            <pre class="line"><span class="line-number">379</span><span class="code-content">          &lt;/el-table&gt;</span></pre>
            <pre class="line"><span class="line-number">380</span><span class="code-content">        &lt;/el-collapse-item&gt;</span></pre>
            <pre class="line"><span class="line-number">381</span><span class="code-content">      &lt;/el-collapse&gt;</span></pre>
            <pre class="line"><span class="line-number">382</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">383</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">384</span><span class="code-content">    &lt;!-- 结果区域 --&gt;</span></pre>
            <pre class="line"><span class="line-number">385</span><span class="code-content">    &lt;div class=&quot;results-section&quot; v-if=&quot;searchResults.length &gt; 0&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">386</span><span class="code-content">      &lt;h3&gt;搜索结果 ({{ searchResults.length }} 文件)&lt;/h3&gt;</span></pre>
            <pre class="line"><span class="line-number">387</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">388</span><span class="code-content">      &lt;!-- 批量操作按钮 --&gt;</span></pre>
            <pre class="line"><span class="line-number">389</span><span class="code-content">      &lt;div class=&quot;batch-actions&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">390</span><span class="code-content">        &lt;el-button size=&quot;small&quot; @click=&quot;expandAllResults&quot; :disabled=&quot;loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">391</span><span class="code-content">          &lt;i class=&quot;el-icon-arrow-down&quot;&gt;&lt;/i&gt; 展开全部</span></pre>
            <pre class="line"><span class="line-number">392</span><span class="code-content">        &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">393</span><span class="code-content">        &lt;el-button size=&quot;small&quot; @click=&quot;collapseAllResults&quot; :disabled=&quot;loading&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">394</span><span class="code-content">          &lt;i class=&quot;el-icon-arrow-up&quot;&gt;&lt;/i&gt; 收起全部</span></pre>
            <pre class="line"><span class="line-number">395</span><span class="code-content">        &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">396</span><span class="code-content">        &lt;span class=&quot;match-total&quot; v-if=&quot;getTotalMatchCount() &gt; 0&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">397</span><span class="code-content">          共找到 {{ getTotalMatchCount() }} 处匹配</span></pre>
            <pre class="line"><span class="line-number">398</span><span class="code-content">        &lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">399</span><span class="code-content">      &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">400</span><span class="code-content">      </span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 9 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">401</span><span class="code-content">      &lt;el-table :data=&quot;sortedSearchResults&quot; style=&quot;width: 100%&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">402</span><span class="code-content">        &lt;el-table-column prop=&quot;fileName&quot; label=&quot;文件名&quot; width=&quot;250&quot; sortable&gt;</span></pre>
            <pre class="line"><span class="line-number">403</span><span class="code-content">          &lt;template slot-scope=&quot;scope&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">404</span><span class="code-content">            &lt;el-tooltip :content=&quot;scope.row.fileName&quot; placement=&quot;top&quot; :disabled=&quot;scope.row.fileName.length &lt; 30&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">405</span><span class="code-content">              &lt;span&gt;{{ scope.row.fileName }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">406</span><span class="code-content">            &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">407</span><span class="code-content">          &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">408</span><span class="code-content">        &lt;/el-table-column&gt;</span></pre>
            <pre class="line"><span class="line-number">409</span><span class="code-content">        &lt;el-table-column prop=&quot;relevance&quot; label=&quot;相关度&quot; width=&quot;100&quot; sortable&gt;</span></pre>
            <pre class="line"><span class="line-number">410</span><span class="code-content">          &lt;template slot-scope=&quot;scope&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">411</span><span class="code-content">            &lt;el-tooltip v-if=&quot;scope.row.error&quot; :content=&quot;`分析错误: ${scope.row.error}`&quot; placement=&quot;top&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">412</span><span class="code-content">               &lt;span style=&quot;color: #F56C6C;&quot;&gt;错误 &lt;i class=&quot;el-icon-warning-outline&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">413</span><span class="code-content">            &lt;/el-tooltip&gt;</span></pre>
            <pre class="line"><span class="line-number">414</span><span class="code-content">            &lt;div v-else&gt;</span></pre>
            <pre class="line"><span class="line-number">415</span><span class="code-content">              &lt;el-progress :percentage=&quot;scope.row.relevance&quot; :status=&quot;scope.row.relevance &gt; 80 ? &#039;success&#039; : scope.row.relevance &gt; 50 ? &#039;warning&#039; : &#039;exception&#039;&quot;&gt;&lt;/el-progress&gt;</span></pre>
            <pre class="line"><span class="line-number">416</span><span class="code-content">              &lt;div class=&quot;score-tags&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">417</span><span class="code-content">                &lt;el-tag size=&quot;mini&quot; type=&quot;info&quot; v-if=&quot;scope.row.apiSkipped&quot;&gt;基于直接匹配&lt;/el-tag&gt;</span></pre>
            <pre class="line"><span class="line-number">418</span><span class="code-content">                &lt;el-tag size=&quot;mini&quot; type=&quot;success&quot; v-else-if=&quot;scope.row.useSemanticMatch&quot;&gt;语义理解&lt;/el-tag&gt;</span></pre>
            <pre class="line"><span class="line-number">419</span><span class="code-content">                &lt;el-tag size=&quot;mini&quot; type=&quot;warning&quot; v-if=&quot;scope.row.apiWarning&quot;&gt;API异常&lt;/el-tag&gt;</span></pre>
            <pre class="line"><span class="line-number">420</span><span class="code-content">              &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">421</span><span class="code-content">            &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">422</span><span class="code-content">          &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">423</span><span class="code-content">        &lt;/el-table-column&gt;</span></pre>
            <pre class="line"><span class="line-number">424</span><span class="code-content">        &lt;el-table-column label=&quot;匹配内容&quot; min-width=&quot;300&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">425</span><span class="code-content">          &lt;template slot-scope=&quot;scope&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">426</span><span class="code-content">            &lt;div v-if=&quot;scope.row.relevanceExplanation&quot; class=&quot;relevance-explanation&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">427</span><span class="code-content">              {{ scope.row.relevanceExplanation }}</span></pre>
            <pre class="line"><span class="line-number">428</span><span class="code-content">            &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">429</span><span class="code-content">            &lt;div v-if=&quot;scope.row.matchedLines &amp;&amp; scope.row.matchedLines.length &gt; 0&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">430</span><span class="code-content">              &lt;div class=&quot;match-summary&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">431</span><span class="code-content">                &lt;span class=&quot;match-count&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">432</span><span class="code-content">                  {{ scope.row.matchedLines.length }}处匹配</span></pre>
            <pre class="line"><span class="line-number">433</span><span class="code-content">                  &lt;el-tag size=&quot;mini&quot; v-if=&quot;scope.row.matchCountExceedsLimit&quot; type=&quot;warning&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">434</span><span class="code-content">                    显示前100条（匹配过多）</span></pre>
            <pre class="line"><span class="line-number">435</span><span class="code-content">                  &lt;/el-tag&gt;</span></pre>
            <pre class="line"><span class="line-number">436</span><span class="code-content">                &lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">437</span><span class="code-content">                &lt;el-button </span></pre>
            <pre class="line"><span class="line-number">438</span><span class="code-content">                  type=&quot;text&quot; </span></pre>
            <pre class="line"><span class="line-number">439</span><span class="code-content">                  @click=&quot;toggleMatchDetails(scope.row)&quot; </span></pre>
            <pre class="line"><span class="line-number">440</span><span class="code-content">                  class=&quot;toggle-btn&quot;</span></pre>
            <pre class="line"><span class="line-number">441</span><span class="code-content">                &gt;</span></pre>
            <pre class="line"><span class="line-number">442</span><span class="code-content">                  {{ scope.row.showDetails ? &#039;收起&#039; : &#039;展开&#039; }}</span></pre>
            <pre class="line"><span class="line-number">443</span><span class="code-content">                  &lt;i :class=&quot;scope.row.showDetails ? &#039;el-icon-arrow-up&#039; : &#039;el-icon-arrow-down&#039;&quot;&gt;&lt;/i&gt;</span></pre>
            <pre class="line"><span class="line-number">444</span><span class="code-content">                &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">445</span><span class="code-content">              &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">446</span><span class="code-content">              &lt;div v-if=&quot;scope.row.showDetails&quot; class=&quot;matched-lines&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">447</span><span class="code-content">                &lt;div v-if=&quot;scope.row.matchedLines.length &gt; 10&quot; class=&quot;match-filter&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">448</span><span class="code-content">                  &lt;el-input</span></pre>
            <pre class="line"><span class="line-number">449</span><span class="code-content">                    v-model=&quot;scope.row.filterText&quot;</span></pre>
            <pre class="line"><span class="line-number">450</span><span class="code-content">                    placeholder=&quot;在当前匹配中搜索&quot;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 10 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">451</span><span class="code-content">                    prefix-icon=&quot;el-icon-search&quot;</span></pre>
            <pre class="line"><span class="line-number">452</span><span class="code-content">                    clearable</span></pre>
            <pre class="line"><span class="line-number">453</span><span class="code-content">                    size=&quot;small&quot;</span></pre>
            <pre class="line"><span class="line-number">454</span><span class="code-content">                    @input=&quot;handleMatchFilter(scope.row)&quot;</span></pre>
            <pre class="line"><span class="line-number">455</span><span class="code-content">                  &gt;&lt;/el-input&gt;</span></pre>
            <pre class="line"><span class="line-number">456</span><span class="code-content">                &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">457</span><span class="code-content">                &lt;div v-if=&quot;scope.row.filteredMatches &amp;&amp; scope.row.filteredMatches.length === 0&quot; class=&quot;no-filter-matches&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">458</span><span class="code-content">                  没有符合筛选条件的匹配项</span></pre>
            <pre class="line"><span class="line-number">459</span><span class="code-content">                &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">460</span><span class="code-content">                &lt;div v-if=&quot;(scope.row.filteredMatches || scope.row.matchedLines).length &gt; matchPagination.pageSize&quot; class=&quot;pagination-control top&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">461</span><span class="code-content">                  &lt;div class=&quot;pagination-info&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">462</span><span class="code-content">                    显示 {{ getPaginatedMatches(scope.row).length }} / {{ (scope.row.filteredMatches || scope.row.matchedLines).length }} 条匹配</span></pre>
            <pre class="line"><span class="line-number">463</span><span class="code-content">                  &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">464</span><span class="code-content">                  &lt;el-pagination</span></pre>
            <pre class="line"><span class="line-number">465</span><span class="code-content">                    @current-change=&quot;(page) =&gt; handlePageChange(page, scope.row.id)&quot;</span></pre>
            <pre class="line"><span class="line-number">466</span><span class="code-content">                    :current-page=&quot;matchPagination.currentPageMap[scope.row.id] || 1&quot;</span></pre>
            <pre class="line"><span class="line-number">467</span><span class="code-content">                    :page-size=&quot;matchPagination.pageSize&quot;</span></pre>
            <pre class="line"><span class="line-number">468</span><span class="code-content">                    layout=&quot;prev, pager, next, jumper&quot;</span></pre>
            <pre class="line"><span class="line-number">469</span><span class="code-content">                    :total=&quot;(scope.row.filteredMatches || scope.row.matchedLines).length&quot;</span></pre>
            <pre class="line"><span class="line-number">470</span><span class="code-content">                    small</span></pre>
            <pre class="line"><span class="line-number">471</span><span class="code-content">                  &gt;&lt;/el-pagination&gt;</span></pre>
            <pre class="line"><span class="line-number">472</span><span class="code-content">                &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">473</span><span class="code-content">                &lt;el-card </span></pre>
            <pre class="line"><span class="line-number">474</span><span class="code-content">                  v-for=&quot;(match, index) in getPaginatedMatches(scope.row)&quot; </span></pre>
            <pre class="line"><span class="line-number">475</span><span class="code-content">                  :key=&quot;index&quot; </span></pre>
            <pre class="line"><span class="line-number">476</span><span class="code-content">                  class=&quot;match-card&quot;</span></pre>
            <pre class="line"><span class="line-number">477</span><span class="code-content">                &gt;</span></pre>
            <pre class="line"><span class="line-number">478</span><span class="code-content">                  &lt;div slot=&quot;header&quot; class=&quot;match-header&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">479</span><span class="code-content">                    &lt;span class=&quot;sheet-name&quot;&gt;工作表: {{ match.sheet }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">480</span><span class="code-content">                    &lt;span class=&quot;row-number&quot;&gt;行 {{ match.row }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">481</span><span class="code-content">                  &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">482</span><span class="code-content">                  &lt;div class=&quot;match-content-wrapper&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">483</span><span class="code-content">                    &lt;div v-html=&quot;highlightMatch(match.content, lastSearchedContent)&quot; class=&quot;match-content&quot;&gt;&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">484</span><span class="code-content">                    </span></pre>
            <pre class="line"><span class="line-number">485</span><span class="code-content">                    &lt;!-- 添加一个&quot;查看完整内容&quot;对话框 --&gt;</span></pre>
            <pre class="line"><span class="line-number">486</span><span class="code-content">                    &lt;div class=&quot;content-actions&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">487</span><span class="code-content">                      &lt;el-button size=&quot;mini&quot; type=&quot;text&quot; @click=&quot;showFullContent(match)&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">488</span><span class="code-content">                        查看完整内容 &lt;i class=&quot;el-icon-view&quot;&gt;&lt;/i&gt;</span></pre>
            <pre class="line"><span class="line-number">489</span><span class="code-content">                      &lt;/el-button&gt;</span></pre>
            <pre class="line"><span class="line-number">490</span><span class="code-content">                    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">491</span><span class="code-content">                  &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">492</span><span class="code-content">                  &lt;div class=&quot;cell-details&quot; v-if=&quot;match.cells &amp;&amp; match.cells.length &gt; 0&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">493</span><span class="code-content">                    &lt;div class=&quot;cell-details-header&quot;&gt;单元格详情:&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">494</span><span class="code-content">                    &lt;el-table :data=&quot;formatCellsForTable(match.cells)&quot; size=&quot;mini&quot; border&gt;</span></pre>
            <pre class="line"><span class="line-number">495</span><span class="code-content">                      &lt;el-table-column prop=&quot;column&quot; label=&quot;列&quot; width=&quot;60&quot;&gt;&lt;/el-table-column&gt;</span></pre>
            <pre class="line"><span class="line-number">496</span><span class="code-content">                      &lt;el-table-column prop=&quot;value&quot; label=&quot;值&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">497</span><span class="code-content">                        &lt;template slot-scope=&quot;cellScope&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">498</span><span class="code-content">                          &lt;div v-html=&quot;highlightMatch(cellScope.row.value, lastSearchedContent)&quot;&gt;&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">499</span><span class="code-content">                        &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">500</span><span class="code-content">                      &lt;/el-table-column&gt;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 11 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">501</span><span class="code-content">                    &lt;/el-table&gt;</span></pre>
            <pre class="line"><span class="line-number">502</span><span class="code-content">                  &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">503</span><span class="code-content">                &lt;/el-card&gt;</span></pre>
            <pre class="line"><span class="line-number">504</span><span class="code-content">              &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">505</span><span class="code-content">            &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">506</span><span class="code-content">            &lt;div v-else class=&quot;no-matches&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">507</span><span class="code-content">              {{ scope.row.suggestedLocation }}</span></pre>
            <pre class="line"><span class="line-number">508</span><span class="code-content">            &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">509</span><span class="code-content">          &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">510</span><span class="code-content">        &lt;/el-table-column&gt;</span></pre>
            <pre class="line"><span class="line-number">511</span><span class="code-content">      &lt;/el-table&gt;</span></pre>
            <pre class="line"><span class="line-number">512</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">513</span><span class="code-content">    &lt;div v-else-if=&quot;!loading &amp;&amp; searched&quot; class=&quot;no-results&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">514</span><span class="code-content">        未找到包含 &quot;{{ lastSearchedContent }}&quot; 相关内容的文件，或所有文件分析出错。</span></pre>
            <pre class="line"><span class="line-number">515</span><span class="code-content">    &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">516</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">517</span><span class="code-content">    &lt;!-- 添加完整内容对话框 --&gt;</span></pre>
            <pre class="line"><span class="line-number">518</span><span class="code-content">    &lt;el-dialog</span></pre>
            <pre class="line"><span class="line-number">519</span><span class="code-content">      title=&quot;完整匹配内容&quot;</span></pre>
            <pre class="line"><span class="line-number">520</span><span class="code-content">      :visible.sync=&quot;fullContentDialog.visible&quot;</span></pre>
            <pre class="line"><span class="line-number">521</span><span class="code-content">      width=&quot;80%&quot;</span></pre>
            <pre class="line"><span class="line-number">522</span><span class="code-content">      class=&quot;full-content-dialog&quot;</span></pre>
            <pre class="line"><span class="line-number">523</span><span class="code-content">    &gt;</span></pre>
            <pre class="line"><span class="line-number">524</span><span class="code-content">      &lt;div class=&quot;sheet-info&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">525</span><span class="code-content">        &lt;span class=&quot;sheet-name-full&quot;&gt;工作表: {{ fullContentDialog.match.sheet }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">526</span><span class="code-content">        &lt;span class=&quot;row-number-full&quot;&gt;行: {{ fullContentDialog.match.row }}&lt;/span&gt;</span></pre>
            <pre class="line"><span class="line-number">527</span><span class="code-content">      &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">528</span><span class="code-content">      &lt;div class=&quot;full-content-wrapper&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">529</span><span class="code-content">        &lt;div v-html=&quot;highlightMatch(fullContentDialog.match.content, lastSearchedContent)&quot; class=&quot;full-content&quot;&gt;&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">530</span><span class="code-content">      &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">531</span><span class="code-content">      &lt;div class=&quot;cell-details-full&quot; v-if=&quot;fullContentDialog.match.cells &amp;&amp; fullContentDialog.match.cells.length &gt; 0&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">532</span><span class="code-content">        &lt;div class=&quot;cell-details-header&quot;&gt;单元格详情:&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">533</span><span class="code-content">        &lt;el-table :data=&quot;formatCellsForTable(fullContentDialog.match.cells)&quot; size=&quot;mini&quot; border stripe&gt;</span></pre>
            <pre class="line"><span class="line-number">534</span><span class="code-content">          &lt;el-table-column prop=&quot;column&quot; label=&quot;列&quot; width=&quot;80&quot;&gt;&lt;/el-table-column&gt;</span></pre>
            <pre class="line"><span class="line-number">535</span><span class="code-content">          &lt;el-table-column prop=&quot;value&quot; label=&quot;值&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">536</span><span class="code-content">            &lt;template slot-scope=&quot;cellScope&quot;&gt;</span></pre>
            <pre class="line"><span class="line-number">537</span><span class="code-content">              &lt;div v-html=&quot;highlightMatch(cellScope.row.value, lastSearchedContent)&quot;&gt;&lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">538</span><span class="code-content">            &lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">539</span><span class="code-content">          &lt;/el-table-column&gt;</span></pre>
            <pre class="line"><span class="line-number">540</span><span class="code-content">        &lt;/el-table&gt;</span></pre>
            <pre class="line"><span class="line-number">541</span><span class="code-content">      &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">542</span><span class="code-content">    &lt;/el-dialog&gt;</span></pre>
            <pre class="line"><span class="line-number">543</span><span class="code-content">  &lt;/div&gt;</span></pre>
            <pre class="line"><span class="line-number">544</span><span class="code-content">&lt;/template&gt;</span></pre>
            <pre class="line"><span class="line-number">545</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">546</span><span class="code-content">&lt;script&gt;</span></pre>
            <pre class="line"><span class="line-number">547</span><span class="code-content">import axios from &#039;axios&#039;</span></pre>
            <pre class="line"><span class="line-number">548</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">549</span><span class="code-content">const API_BASE_URL = process.env.VUE_APP_API_BASE_URL || &#039;http://localhost:3000&#039;</span></pre>
            <pre class="line"><span class="line-number">550</span><span class="code-content"></span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 12 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">551</span><span class="code-content">export default {</span></pre>
            <pre class="line"><span class="line-number">552</span><span class="code-content">  name: &#039;ExcelContentFinder&#039;,</span></pre>
            <pre class="line"><span class="line-number">553</span><span class="code-content">  data() {</span></pre>
            <pre class="line"><span class="line-number">554</span><span class="code-content">    return {</span></pre>
            <pre class="line"><span class="line-number">555</span><span class="code-content">      searchContent: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">556</span><span class="code-content">      lastSearchedContent: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">557</span><span class="code-content">      selectedFiles: [], // 用户选择的Excel文件</span></pre>
            <pre class="line"><span class="line-number">558</span><span class="code-content">      searchResults: [],</span></pre>
            <pre class="line"><span class="line-number">559</span><span class="code-content">      loading: false,</span></pre>
            <pre class="line"><span class="line-number">560</span><span class="code-content">      serverConnected: false,</span></pre>
            <pre class="line"><span class="line-number">561</span><span class="code-content">      searched: false,</span></pre>
            <pre class="line"><span class="line-number">562</span><span class="code-content">      analysisProgress: { processed: 0, total: 0 },</span></pre>
            <pre class="line"><span class="line-number">563</span><span class="code-content">      showApiConfig: false,</span></pre>
            <pre class="line"><span class="line-number">564</span><span class="code-content">      fileListCollapse: [], // 用于控制文件列表折叠状态，默认收起</span></pre>
            <pre class="line"><span class="line-number">565</span><span class="code-content">      processCollapse: [&#039;process&#039;], // 用于控制处理过程折叠状态，默认展开</span></pre>
            <pre class="line"><span class="line-number">566</span><span class="code-content">      apiConfig: {</span></pre>
            <pre class="line"><span class="line-number">567</span><span class="code-content">        apiUrl: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">568</span><span class="code-content">        apiKey: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">569</span><span class="code-content">        model: &#039;DeepSeek-R1&#039;,</span></pre>
            <pre class="line"><span class="line-number">570</span><span class="code-content">        maxTokens: 32768</span></pre>
            <pre class="line"><span class="line-number">571</span><span class="code-content">      },</span></pre>
            <pre class="line"><span class="line-number">572</span><span class="code-content">      modelOptions: [</span></pre>
            <pre class="line"><span class="line-number">573</span><span class="code-content">        { value: &#039;DeepSeek-R1&#039;, label: &#039;DeepSeek-R1&#039; },</span></pre>
            <pre class="line"><span class="line-number">574</span><span class="code-content">        { value: &#039;DeepSeek-v3&#039;, label: &#039;DeepSeek-v3&#039; },</span></pre>
            <pre class="line"><span class="line-number">575</span><span class="code-content">        { value: &#039;Qwen3-235B-A22B&#039;, label: &#039;Qwen3-235B-A22B&#039; },</span></pre>
            <pre class="line"><span class="line-number">576</span><span class="code-content">        { value: &#039;Qwen2.5-72B-Instruct&#039;, label: &#039;Qwen2.5-72B-Instruct&#039; },</span></pre>
            <pre class="line"><span class="line-number">577</span><span class="code-content">        { value: &#039;Qwen2.5-32B-Instruct&#039;, label: &#039;Qwen2.5-32B-Instruct&#039; },</span></pre>
            <pre class="line"><span class="line-number">578</span><span class="code-content">        { value: &#039;QwQ-32B&#039;, label: &#039;QwQ-32B&#039; },</span></pre>
            <pre class="line"><span class="line-number">579</span><span class="code-content">        { value: &#039;Qwen2.5-7B-Instruct&#039;, label: &#039;Qwen2.5-7B-Instruct&#039; },</span></pre>
            <pre class="line"><span class="line-number">580</span><span class="code-content">        { value: &#039;DeepSeek-R1-Distill-Qwen-32B&#039;, label: &#039;DeepSeek-R1-Distill-Qwen-32B&#039; },</span></pre>
            <pre class="line"><span class="line-number">581</span><span class="code-content">        { value: &#039;DeepSeek-R1-Distill-Qwen-7B&#039;, label: &#039;DeepSeek-R1-Distill-Qwen-7B&#039; }</span></pre>
            <pre class="line"><span class="line-number">582</span><span class="code-content">      ],</span></pre>
            <pre class="line"><span class="line-number">583</span><span class="code-content">      originalApiConfig: {}, // 用于重置</span></pre>
            <pre class="line"><span class="line-number">584</span><span class="code-content">      saveConfigLoading: false,</span></pre>
            <pre class="line"><span class="line-number">585</span><span class="code-content">      testApiLoading: false,</span></pre>
            <pre class="line"><span class="line-number">586</span><span class="code-content">      showApiKey: false,</span></pre>
            <pre class="line"><span class="line-number">587</span><span class="code-content">      apiErrorMessage: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">588</span><span class="code-content">      analysisLogs: [], // 存储分析过程中的日志</span></pre>
            <pre class="line"><span class="line-number">589</span><span class="code-content">      batchSizeLimit: 10, // 默认每次最多处理10个文件</span></pre>
            <pre class="line"><span class="line-number">590</span><span class="code-content">      // 批次处理信息</span></pre>
            <pre class="line"><span class="line-number">591</span><span class="code-content">      batchProcessInfo: {</span></pre>
            <pre class="line"><span class="line-number">592</span><span class="code-content">        enabled: false, // 是否开启批次处理</span></pre>
            <pre class="line"><span class="line-number">593</span><span class="code-content">        totalFiles: 0, // 所有要处理的文件数</span></pre>
            <pre class="line"><span class="line-number">594</span><span class="code-content">        processedFiles: 0, // 已处理的文件数</span></pre>
            <pre class="line"><span class="line-number">595</span><span class="code-content">        currentBatch: 0, // 当前批次</span></pre>
            <pre class="line"><span class="line-number">596</span><span class="code-content">        totalBatches: 0, // 总批次</span></pre>
            <pre class="line"><span class="line-number">597</span><span class="code-content">        percentage: 0, // 进度百分比</span></pre>
            <pre class="line"><span class="line-number">598</span><span class="code-content">        remainingFiles: [], // 剩余的待处理文件</span></pre>
            <pre class="line"><span class="line-number">599</span><span class="code-content">        autoContinue: true, // 是否自动继续处理下一批</span></pre>
            <pre class="line"><span class="line-number">600</span><span class="code-content">      },</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 13 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">601</span><span class="code-content">      showAdvancedOptions: false,</span></pre>
            <pre class="line"><span class="line-number">602</span><span class="code-content">      searchOptions: {</span></pre>
            <pre class="line"><span class="line-number">603</span><span class="code-content">        understandingMode: &#039;semantic&#039;,</span></pre>
            <pre class="line"><span class="line-number">604</span><span class="code-content">        minRelevanceThreshold: 50,</span></pre>
            <pre class="line"><span class="line-number">605</span><span class="code-content">        analysisDepth: &#039;shallow&#039;</span></pre>
            <pre class="line"><span class="line-number">606</span><span class="code-content">      },</span></pre>
            <pre class="line"><span class="line-number">607</span><span class="code-content">      matchPagination: {</span></pre>
            <pre class="line"><span class="line-number">608</span><span class="code-content">        pageSize: 20,</span></pre>
            <pre class="line"><span class="line-number">609</span><span class="code-content">        currentPageMap: {} // 存储每个文件结果的当前页码</span></pre>
            <pre class="line"><span class="line-number">610</span><span class="code-content">      },</span></pre>
            <pre class="line"><span class="line-number">611</span><span class="code-content">      fullContentDialog: {</span></pre>
            <pre class="line"><span class="line-number">612</span><span class="code-content">        visible: false,</span></pre>
            <pre class="line"><span class="line-number">613</span><span class="code-content">        match: { </span></pre>
            <pre class="line"><span class="line-number">614</span><span class="code-content">          content: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">615</span><span class="code-content">          cells: [],</span></pre>
            <pre class="line"><span class="line-number">616</span><span class="code-content">          sheet: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">617</span><span class="code-content">          row: 0</span></pre>
            <pre class="line"><span class="line-number">618</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">619</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">620</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">621</span><span class="code-content">  },</span></pre>
            <pre class="line"><span class="line-number">622</span><span class="code-content">  computed: {</span></pre>
            <pre class="line"><span class="line-number">623</span><span class="code-content">    // 计算分析进度百分比</span></pre>
            <pre class="line"><span class="line-number">624</span><span class="code-content">    analysisProgressPercentage() {</span></pre>
            <pre class="line"><span class="line-number">625</span><span class="code-content">      if (!this.analysisProgress.total) return 0;</span></pre>
            <pre class="line"><span class="line-number">626</span><span class="code-content">      return Math.round((this.analysisProgress.processed / this.analysisProgress.total) * 100);</span></pre>
            <pre class="line"><span class="line-number">627</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">628</span><span class="code-content">    // 排序后的搜索结果</span></pre>
            <pre class="line"><span class="line-number">629</span><span class="code-content">    sortedSearchResults() {</span></pre>
            <pre class="line"><span class="line-number">630</span><span class="code-content">      return [...this.searchResults].sort((a, b) =&gt; b.relevance - a.relevance);</span></pre>
            <pre class="line"><span class="line-number">631</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">632</span><span class="code-content">    // 文件列表表格数据</span></pre>
            <pre class="line"><span class="line-number">633</span><span class="code-content">    selectedFilesTable() {</span></pre>
            <pre class="line"><span class="line-number">634</span><span class="code-content">      return this.selectedFiles.map(file =&gt; ({</span></pre>
            <pre class="line"><span class="line-number">635</span><span class="code-content">        name: file.name,</span></pre>
            <pre class="line"><span class="line-number">636</span><span class="code-content">        size: this.formatFileSize(file.size)</span></pre>
            <pre class="line"><span class="line-number">637</span><span class="code-content">      }));</span></pre>
            <pre class="line"><span class="line-number">638</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">639</span><span class="code-content">    // 计算每个文件的匹配内容总数</span></pre>
            <pre class="line"><span class="line-number">640</span><span class="code-content">    matchedContentStats() {</span></pre>
            <pre class="line"><span class="line-number">641</span><span class="code-content">      return this.searchResults.reduce((acc, file) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">642</span><span class="code-content">        acc.total += file.matchedLines ? file.matchedLines.length : 0;</span></pre>
            <pre class="line"><span class="line-number">643</span><span class="code-content">        acc.files += file.matchedLines &amp;&amp; file.matchedLines.length &gt; 0 ? 1 : 0;</span></pre>
            <pre class="line"><span class="line-number">644</span><span class="code-content">        return acc;</span></pre>
            <pre class="line"><span class="line-number">645</span><span class="code-content">      }, { total: 0, files: 0 });</span></pre>
            <pre class="line"><span class="line-number">646</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">647</span><span class="code-content">  },</span></pre>
            <pre class="line"><span class="line-number">648</span><span class="code-content">  created() {</span></pre>
            <pre class="line"><span class="line-number">649</span><span class="code-content">    this.checkServerConnection()</span></pre>
            <pre class="line"><span class="line-number">650</span><span class="code-content">    this.getApiConfig()</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 14 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">651</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">652</span><span class="code-content">    // 设置文件列表默认收起</span></pre>
            <pre class="line"><span class="line-number">653</span><span class="code-content">    this.fileListCollapse = []</span></pre>
            <pre class="line"><span class="line-number">654</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">655</span><span class="code-content">    // 设置分析进度默认展开</span></pre>
            <pre class="line"><span class="line-number">656</span><span class="code-content">    this.processCollapse = [&#039;process&#039;]</span></pre>
            <pre class="line"><span class="line-number">657</span><span class="code-content">  },</span></pre>
            <pre class="line"><span class="line-number">658</span><span class="code-content">  methods: {</span></pre>
            <pre class="line"><span class="line-number">659</span><span class="code-content">    // 格式化文件大小</span></pre>
            <pre class="line"><span class="line-number">660</span><span class="code-content">    formatFileSize(bytes) {</span></pre>
            <pre class="line"><span class="line-number">661</span><span class="code-content">      if (bytes === 0) return &#039;0 Bytes&#039;;</span></pre>
            <pre class="line"><span class="line-number">662</span><span class="code-content">      const k = 1024;</span></pre>
            <pre class="line"><span class="line-number">663</span><span class="code-content">      const sizes = [&#039;Bytes&#039;, &#039;KB&#039;, &#039;MB&#039;, &#039;GB&#039;];</span></pre>
            <pre class="line"><span class="line-number">664</span><span class="code-content">      const i = Math.floor(Math.log(bytes) / Math.log(k));</span></pre>
            <pre class="line"><span class="line-number">665</span><span class="code-content">      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + &#039; &#039; + sizes[i];</span></pre>
            <pre class="line"><span class="line-number">666</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">667</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">668</span><span class="code-content">    // 检查服务器连接</span></pre>
            <pre class="line"><span class="line-number">669</span><span class="code-content">    async checkServerConnection() {</span></pre>
            <pre class="line"><span class="line-number">670</span><span class="code-content">      this.serverConnected = false;</span></pre>
            <pre class="line"><span class="line-number">671</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">672</span><span class="code-content">        await axios.get(`${API_BASE_URL}/api/health`, { timeout: 3000 });</span></pre>
            <pre class="line"><span class="line-number">673</span><span class="code-content">        this.serverConnected = true</span></pre>
            <pre class="line"><span class="line-number">674</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">675</span><span class="code-content">        console.error(&#039;服务器连接失败:&#039;, error)</span></pre>
            <pre class="line"><span class="line-number">676</span><span class="code-content">        this.serverConnected = false</span></pre>
            <pre class="line"><span class="line-number">677</span><span class="code-content">        this.$message.error(&#039;无法连接到后台服务，请确保服务已启动并检查网络。&#039;)</span></pre>
            <pre class="line"><span class="line-number">678</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">679</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">680</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">681</span><span class="code-content">    // 处理文件夹选择</span></pre>
            <pre class="line"><span class="line-number">682</span><span class="code-content">    handleFolderSelection(event) {</span></pre>
            <pre class="line"><span class="line-number">683</span><span class="code-content">      const files = event.target.files;</span></pre>
            <pre class="line"><span class="line-number">684</span><span class="code-content">      if (!files || files.length === 0) return;</span></pre>
            <pre class="line"><span class="line-number">685</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">686</span><span class="code-content">      // 清空之前选择的文件</span></pre>
            <pre class="line"><span class="line-number">687</span><span class="code-content">      this.selectedFiles = [];</span></pre>
            <pre class="line"><span class="line-number">688</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">689</span><span class="code-content">      // 过滤出Excel文件</span></pre>
            <pre class="line"><span class="line-number">690</span><span class="code-content">      Array.from(files).forEach(file =&gt; {</span></pre>
            <pre class="line"><span class="line-number">691</span><span class="code-content">        const fileName = file.name.toLowerCase();</span></pre>
            <pre class="line"><span class="line-number">692</span><span class="code-content">        if (fileName.endsWith(&#039;.xlsx&#039;) || fileName.endsWith(&#039;.xls&#039;)) {</span></pre>
            <pre class="line"><span class="line-number">693</span><span class="code-content">          this.selectedFiles.push(file);</span></pre>
            <pre class="line"><span class="line-number">694</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">695</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">696</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">697</span><span class="code-content">      if (this.selectedFiles.length === 0) {</span></pre>
            <pre class="line"><span class="line-number">698</span><span class="code-content">        this.$message.warning(&#039;所选文件夹中未发现Excel文件&#039;);</span></pre>
            <pre class="line"><span class="line-number">699</span><span class="code-content">      } else {</span></pre>
            <pre class="line"><span class="line-number">700</span><span class="code-content">        this.$message.success(`已选择 ${this.selectedFiles.length} 个Excel文件`);</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 15 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">701</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">702</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">703</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">704</span><span class="code-content">    // 处理匹配内容的筛选</span></pre>
            <pre class="line"><span class="line-number">705</span><span class="code-content">    handleMatchFilter(file) {</span></pre>
            <pre class="line"><span class="line-number">706</span><span class="code-content">      if (!file.filterText || file.filterText.trim() === &#039;&#039;) {</span></pre>
            <pre class="line"><span class="line-number">707</span><span class="code-content">        file.filteredMatches = null; // 清空筛选，显示所有匹配</span></pre>
            <pre class="line"><span class="line-number">708</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">709</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">710</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">711</span><span class="code-content">      const filterText = file.filterText.toLowerCase();</span></pre>
            <pre class="line"><span class="line-number">712</span><span class="code-content">      file.filteredMatches = file.matchedLines.filter(match =&gt; </span></pre>
            <pre class="line"><span class="line-number">713</span><span class="code-content">        match.content.toLowerCase().includes(filterText)</span></pre>
            <pre class="line"><span class="line-number">714</span><span class="code-content">      );</span></pre>
            <pre class="line"><span class="line-number">715</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">716</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">717</span><span class="code-content">    // 获取当前文件的分页结果</span></pre>
            <pre class="line"><span class="line-number">718</span><span class="code-content">    getPaginatedMatches(file) {</span></pre>
            <pre class="line"><span class="line-number">719</span><span class="code-content">      // 处理可能为null或未定义的情况</span></pre>
            <pre class="line"><span class="line-number">720</span><span class="code-content">      if (!file || !file.matchedLines) {</span></pre>
            <pre class="line"><span class="line-number">721</span><span class="code-content">        return [];</span></pre>
            <pre class="line"><span class="line-number">722</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">723</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">724</span><span class="code-content">      // 如果有筛选内容，优先返回筛选结果</span></pre>
            <pre class="line"><span class="line-number">725</span><span class="code-content">      if (file.filteredMatches) {</span></pre>
            <pre class="line"><span class="line-number">726</span><span class="code-content">        return this.paginateArray(file.filteredMatches, file.id);</span></pre>
            <pre class="line"><span class="line-number">727</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">728</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">729</span><span class="code-content">      // 否则返回分页后的原始匹配结果</span></pre>
            <pre class="line"><span class="line-number">730</span><span class="code-content">      return this.paginateArray(file.matchedLines, file.id);</span></pre>
            <pre class="line"><span class="line-number">731</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">732</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">733</span><span class="code-content">    // 数组分页处理</span></pre>
            <pre class="line"><span class="line-number">734</span><span class="code-content">    paginateArray(array, fileId) {</span></pre>
            <pre class="line"><span class="line-number">735</span><span class="code-content">      if (!array || array.length === 0) return [];</span></pre>
            <pre class="line"><span class="line-number">736</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">737</span><span class="code-content">      // 确保文件ID存在，用于唯一标识当前文件的分页状态</span></pre>
            <pre class="line"><span class="line-number">738</span><span class="code-content">      if (!fileId) {</span></pre>
            <pre class="line"><span class="line-number">739</span><span class="code-content">        fileId = array.toString().slice(0, 10);</span></pre>
            <pre class="line"><span class="line-number">740</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">741</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">742</span><span class="code-content">      // 初始化当前页码</span></pre>
            <pre class="line"><span class="line-number">743</span><span class="code-content">      if (!this.matchPagination.currentPageMap[fileId]) {</span></pre>
            <pre class="line"><span class="line-number">744</span><span class="code-content">        this.$set(this.matchPagination.currentPageMap, fileId, 1);</span></pre>
            <pre class="line"><span class="line-number">745</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">746</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">747</span><span class="code-content">      const currentPage = this.matchPagination.currentPageMap[fileId];</span></pre>
            <pre class="line"><span class="line-number">748</span><span class="code-content">      const pageSize = this.matchPagination.pageSize;</span></pre>
            <pre class="line"><span class="line-number">749</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">750</span><span class="code-content">      // 计算起始和结束索引</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 16 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">751</span><span class="code-content">      const startIndex = (currentPage - 1) * pageSize;</span></pre>
            <pre class="line"><span class="line-number">752</span><span class="code-content">      const endIndex = currentPage * pageSize;</span></pre>
            <pre class="line"><span class="line-number">753</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">754</span><span class="code-content">      // 返回当前页的数据</span></pre>
            <pre class="line"><span class="line-number">755</span><span class="code-content">      return array.slice(startIndex, endIndex);</span></pre>
            <pre class="line"><span class="line-number">756</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">757</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">758</span><span class="code-content">    // 切换分页</span></pre>
            <pre class="line"><span class="line-number">759</span><span class="code-content">    handlePageChange(currentPage, fileId) {</span></pre>
            <pre class="line"><span class="line-number">760</span><span class="code-content">      this.$set(this.matchPagination.currentPageMap, fileId, currentPage);</span></pre>
            <pre class="line"><span class="line-number">761</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">762</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">763</span><span class="code-content">    // 切换匹配详情的显示状态</span></pre>
            <pre class="line"><span class="line-number">764</span><span class="code-content">    toggleMatchDetails(file) {</span></pre>
            <pre class="line"><span class="line-number">765</span><span class="code-content">      // 使用Vue.set确保响应式更新</span></pre>
            <pre class="line"><span class="line-number">766</span><span class="code-content">      this.$set(file, &#039;showDetails&#039;, !file.showDetails);</span></pre>
            <pre class="line"><span class="line-number">767</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">768</span><span class="code-content">      // 初始化筛选和分页状态</span></pre>
            <pre class="line"><span class="line-number">769</span><span class="code-content">      if (file.showDetails) {</span></pre>
            <pre class="line"><span class="line-number">770</span><span class="code-content">        if (!file.hasOwnProperty(&#039;filterText&#039;)) {</span></pre>
            <pre class="line"><span class="line-number">771</span><span class="code-content">          this.$set(file, &#039;filterText&#039;, &#039;&#039;);</span></pre>
            <pre class="line"><span class="line-number">772</span><span class="code-content">          this.$set(file, &#039;filteredMatches&#039;, null);</span></pre>
            <pre class="line"><span class="line-number">773</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">774</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">775</span><span class="code-content">        // 重置分页</span></pre>
            <pre class="line"><span class="line-number">776</span><span class="code-content">        if (!file.id) {</span></pre>
            <pre class="line"><span class="line-number">777</span><span class="code-content">          // 生成唯一ID</span></pre>
            <pre class="line"><span class="line-number">778</span><span class="code-content">          file.id = file.fileName.replace(/\W/g, &#039;&#039;) + Date.now().toString().slice(-6);</span></pre>
            <pre class="line"><span class="line-number">779</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">780</span><span class="code-content">        this.$set(this.matchPagination.currentPageMap, file.id, 1);</span></pre>
            <pre class="line"><span class="line-number">781</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">782</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">783</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">784</span><span class="code-content">    // 开始批量分析处理</span></pre>
            <pre class="line"><span class="line-number">785</span><span class="code-content">    startBatchAnalysis() {</span></pre>
            <pre class="line"><span class="line-number">786</span><span class="code-content">      if (!this.serverConnected) {</span></pre>
            <pre class="line"><span class="line-number">787</span><span class="code-content">        this.$message.error(&#039;服务器未连接，请先确保后台服务运行正常&#039;);</span></pre>
            <pre class="line"><span class="line-number">788</span><span class="code-content">        this.checkServerConnection();</span></pre>
            <pre class="line"><span class="line-number">789</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">790</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">791</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">792</span><span class="code-content">      if (!this.searchContent) {</span></pre>
            <pre class="line"><span class="line-number">793</span><span class="code-content">        this.$message.warning(&#039;请输入搜索内容&#039;);</span></pre>
            <pre class="line"><span class="line-number">794</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">795</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">796</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">797</span><span class="code-content">      if (this.selectedFiles.length === 0) {</span></pre>
            <pre class="line"><span class="line-number">798</span><span class="code-content">        this.$message.warning(&#039;请先选择包含Excel文件的文件夹&#039;);</span></pre>
            <pre class="line"><span class="line-number">799</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">800</span><span class="code-content">      }</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 17 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">801</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">802</span><span class="code-content">      if (this.loading) {</span></pre>
            <pre class="line"><span class="line-number">803</span><span class="code-content">        this.$message.warning(&#039;正在分析中，请稍候...&#039;);</span></pre>
            <pre class="line"><span class="line-number">804</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">805</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">806</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">807</span><span class="code-content">      // 重置状态</span></pre>
            <pre class="line"><span class="line-number">808</span><span class="code-content">      this.searchResults = [];</span></pre>
            <pre class="line"><span class="line-number">809</span><span class="code-content">      this.lastSearchedContent = this.searchContent;</span></pre>
            <pre class="line"><span class="line-number">810</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">811</span><span class="code-content">      // 初始化批处理信息</span></pre>
            <pre class="line"><span class="line-number">812</span><span class="code-content">      this.batchProcessInfo.enabled = true;</span></pre>
            <pre class="line"><span class="line-number">813</span><span class="code-content">      this.batchProcessInfo.totalFiles = this.selectedFiles.length;</span></pre>
            <pre class="line"><span class="line-number">814</span><span class="code-content">      this.batchProcessInfo.processedFiles = 0;</span></pre>
            <pre class="line"><span class="line-number">815</span><span class="code-content">      this.batchProcessInfo.currentBatch = 1;</span></pre>
            <pre class="line"><span class="line-number">816</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">817</span><span class="code-content">      // 计算总批次数</span></pre>
            <pre class="line"><span class="line-number">818</span><span class="code-content">      if (this.batchSizeLimit &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">819</span><span class="code-content">        this.batchProcessInfo.totalBatches = Math.ceil(this.selectedFiles.length / this.batchSizeLimit);</span></pre>
            <pre class="line"><span class="line-number">820</span><span class="code-content">      } else {</span></pre>
            <pre class="line"><span class="line-number">821</span><span class="code-content">        this.batchProcessInfo.totalBatches = 1;</span></pre>
            <pre class="line"><span class="line-number">822</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">823</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">824</span><span class="code-content">      this.batchProcessInfo.percentage = 0;</span></pre>
            <pre class="line"><span class="line-number">825</span><span class="code-content">      this.batchProcessInfo.remainingFiles = [...this.selectedFiles];</span></pre>
            <pre class="line"><span class="line-number">826</span><span class="code-content">      this.batchProcessInfo.autoContinue = true;</span></pre>
            <pre class="line"><span class="line-number">827</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">828</span><span class="code-content">      // 清空之前的日志</span></pre>
            <pre class="line"><span class="line-number">829</span><span class="code-content">      this.analysisLogs = [];</span></pre>
            <pre class="line"><span class="line-number">830</span><span class="code-content">      this.addAnalysisLog(`开始批量处理，共 ${this.selectedFiles.length} 个文件，分为 ${this.batchProcessInfo.totalBatches} 个批次`, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">831</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">832</span><span class="code-content">      // 处理第一批</span></pre>
            <pre class="line"><span class="line-number">833</span><span class="code-content">      this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">834</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">835</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">836</span><span class="code-content">    // 处理单个批次</span></pre>
            <pre class="line"><span class="line-number">837</span><span class="code-content">    async processBatch() {</span></pre>
            <pre class="line"><span class="line-number">838</span><span class="code-content">      this.loading = true;</span></pre>
            <pre class="line"><span class="line-number">839</span><span class="code-content">      this.searched = true;</span></pre>
            <pre class="line"><span class="line-number">840</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">841</span><span class="code-content">      // 确定本批次要处理的文件</span></pre>
            <pre class="line"><span class="line-number">842</span><span class="code-content">      let filesToProcess = [];</span></pre>
            <pre class="line"><span class="line-number">843</span><span class="code-content">      if (this.batchSizeLimit &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">844</span><span class="code-content">        filesToProcess = this.batchProcessInfo.remainingFiles.slice(0, this.batchSizeLimit);</span></pre>
            <pre class="line"><span class="line-number">845</span><span class="code-content">        this.batchProcessInfo.remainingFiles = this.batchProcessInfo.remainingFiles.slice(this.batchSizeLimit);</span></pre>
            <pre class="line"><span class="line-number">846</span><span class="code-content">      } else {</span></pre>
            <pre class="line"><span class="line-number">847</span><span class="code-content">        filesToProcess = [...this.batchProcessInfo.remainingFiles];</span></pre>
            <pre class="line"><span class="line-number">848</span><span class="code-content">        this.batchProcessInfo.remainingFiles = [];</span></pre>
            <pre class="line"><span class="line-number">849</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">850</span><span class="code-content">      </span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 18 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">851</span><span class="code-content">      this.analysisProgress = { processed: 0, total: filesToProcess.length };</span></pre>
            <pre class="line"><span class="line-number">852</span><span class="code-content">      this.addAnalysisLog(`处理批次 ${this.batchProcessInfo.currentBatch}/${this.batchProcessInfo.totalBatches}，本批次 ${filesToProcess.length} 个文件`, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">853</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">854</span><span class="code-content">      // 创建FormData并添加搜索内容</span></pre>
            <pre class="line"><span class="line-number">855</span><span class="code-content">      const formData = new FormData();</span></pre>
            <pre class="line"><span class="line-number">856</span><span class="code-content">      formData.append(&#039;searchContent&#039;, this.searchContent);</span></pre>
            <pre class="line"><span class="line-number">857</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">858</span><span class="code-content">      // 添加高级搜索选项</span></pre>
            <pre class="line"><span class="line-number">859</span><span class="code-content">      formData.append(&#039;understandingMode&#039;, this.searchOptions.understandingMode);</span></pre>
            <pre class="line"><span class="line-number">860</span><span class="code-content">      formData.append(&#039;minRelevanceThreshold&#039;, this.searchOptions.minRelevanceThreshold.toString());</span></pre>
            <pre class="line"><span class="line-number">861</span><span class="code-content">      formData.append(&#039;analysisDepth&#039;, this.searchOptions.analysisDepth);</span></pre>
            <pre class="line"><span class="line-number">862</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">863</span><span class="code-content">      // 添加本批次的所有Excel文件</span></pre>
            <pre class="line"><span class="line-number">864</span><span class="code-content">      filesToProcess.forEach(file =&gt; {</span></pre>
            <pre class="line"><span class="line-number">865</span><span class="code-content">        formData.append(&#039;files&#039;, file);</span></pre>
            <pre class="line"><span class="line-number">866</span><span class="code-content">        this.addAnalysisLog(`添加文件: ${file.name}`, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">867</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">868</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">869</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">870</span><span class="code-content">        this.addAnalysisLog(`开始上传文件...分析模式: ${this.searchOptions.understandingMode}`, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">871</span><span class="code-content">        const response = await axios.post(</span></pre>
            <pre class="line"><span class="line-number">872</span><span class="code-content">          `${API_BASE_URL}/api/upload-and-analyze`, </span></pre>
            <pre class="line"><span class="line-number">873</span><span class="code-content">          formData,</span></pre>
            <pre class="line"><span class="line-number">874</span><span class="code-content">          {</span></pre>
            <pre class="line"><span class="line-number">875</span><span class="code-content">          headers: {</span></pre>
            <pre class="line"><span class="line-number">876</span><span class="code-content">              // 不需要手动设置Content-Type，浏览器会自动处理FormData</span></pre>
            <pre class="line"><span class="line-number">877</span><span class="code-content">            },</span></pre>
            <pre class="line"><span class="line-number">878</span><span class="code-content">            timeout: 300000, // 5分钟超时</span></pre>
            <pre class="line"><span class="line-number">879</span><span class="code-content">            onUploadProgress: (progressEvent) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">880</span><span class="code-content">              // 如果需要显示上传进度</span></pre>
            <pre class="line"><span class="line-number">881</span><span class="code-content">              const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);</span></pre>
            <pre class="line"><span class="line-number">882</span><span class="code-content">              console.log(`上传进度: ${percentCompleted}%`);</span></pre>
            <pre class="line"><span class="line-number">883</span><span class="code-content">              if (percentCompleted === 100) {</span></pre>
            <pre class="line"><span class="line-number">884</span><span class="code-content">                this.addAnalysisLog(&#039;文件上传完成，开始分析...&#039;, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">885</span><span class="code-content">              }</span></pre>
            <pre class="line"><span class="line-number">886</span><span class="code-content">            }</span></pre>
            <pre class="line"><span class="line-number">887</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">888</span><span class="code-content">        );</span></pre>
            <pre class="line"><span class="line-number">889</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">890</span><span class="code-content">        if (response.data.error) {</span></pre>
            <pre class="line"><span class="line-number">891</span><span class="code-content">          throw new Error(response.data.error);</span></pre>
            <pre class="line"><span class="line-number">892</span><span class="code-content">        } else if (response.data.results) {</span></pre>
            <pre class="line"><span class="line-number">893</span><span class="code-content">          // 记录分析结果</span></pre>
            <pre class="line"><span class="line-number">894</span><span class="code-content">          this.addAnalysisLog(`批次 ${this.batchProcessInfo.currentBatch} 分析完成，找到 ${response.data.results.length} 个结果文件`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">895</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">896</span><span class="code-content">          // 初始化结果中的展开/折叠状态，并合并到总结果中</span></pre>
            <pre class="line"><span class="line-number">897</span><span class="code-content">          const batchResults = response.data.results.map(result =&gt; {</span></pre>
            <pre class="line"><span class="line-number">898</span><span class="code-content">            if (result.matchedLines &amp;&amp; result.matchedLines.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">899</span><span class="code-content">              this.addAnalysisLog(`文件 &quot;${result.fileName}&quot; 找到 ${result.matchedLines.length} 处匹配，相关度: ${result.relevance}`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">900</span><span class="code-content">            }</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 19 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">901</span><span class="code-content">            return {</span></pre>
            <pre class="line"><span class="line-number">902</span><span class="code-content">              ...result,</span></pre>
            <pre class="line"><span class="line-number">903</span><span class="code-content">              showDetails: false,</span></pre>
            <pre class="line"><span class="line-number">904</span><span class="code-content">              filterText: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">905</span><span class="code-content">              filteredMatches: null</span></pre>
            <pre class="line"><span class="line-number">906</span><span class="code-content">            };</span></pre>
            <pre class="line"><span class="line-number">907</span><span class="code-content">          });</span></pre>
            <pre class="line"><span class="line-number">908</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">909</span><span class="code-content">          // 合并结果</span></pre>
            <pre class="line"><span class="line-number">910</span><span class="code-content">          this.searchResults = [...this.searchResults, ...batchResults];</span></pre>
            <pre class="line"><span class="line-number">911</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">912</span><span class="code-content">          console.warn(&quot;意外的响应结构:&quot;, response.data);</span></pre>
            <pre class="line"><span class="line-number">913</span><span class="code-content">          this.addAnalysisLog(&#039;收到未预期的服务器响应格式&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">914</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">915</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">916</span><span class="code-content">        // 更新批处理进度信息</span></pre>
            <pre class="line"><span class="line-number">917</span><span class="code-content">        this.batchProcessInfo.processedFiles += filesToProcess.length;</span></pre>
            <pre class="line"><span class="line-number">918</span><span class="code-content">        this.batchProcessInfo.percentage = Math.floor((this.batchProcessInfo.processedFiles / this.batchProcessInfo.totalFiles) * 100);</span></pre>
            <pre class="line"><span class="line-number">919</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">920</span><span class="code-content">        // 检查是否还有剩余批次</span></pre>
            <pre class="line"><span class="line-number">921</span><span class="code-content">        if (this.batchProcessInfo.remainingFiles.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">922</span><span class="code-content">          this.batchProcessInfo.currentBatch++;</span></pre>
            <pre class="line"><span class="line-number">923</span><span class="code-content">          this.addAnalysisLog(`批次 ${this.batchProcessInfo.currentBatch - 1}/${this.batchProcessInfo.totalBatches} 处理完成，剩余 ${this.batchProcessInfo.remainingFiles.length} 个文件待处理`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">924</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">925</span><span class="code-content">          // 是否自动处理下一批</span></pre>
            <pre class="line"><span class="line-number">926</span><span class="code-content">          if (this.batchProcessInfo.autoContinue) {</span></pre>
            <pre class="line"><span class="line-number">927</span><span class="code-content">            // 给用户一些时间查看结果，然后再继续处理下一批</span></pre>
            <pre class="line"><span class="line-number">928</span><span class="code-content">            setTimeout(() =&gt; {</span></pre>
            <pre class="line"><span class="line-number">929</span><span class="code-content">              this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">930</span><span class="code-content">            }, 1000);</span></pre>
            <pre class="line"><span class="line-number">931</span><span class="code-content">          } else {</span></pre>
            <pre class="line"><span class="line-number">932</span><span class="code-content">            this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">933</span><span class="code-content">            this.addAnalysisLog(&#039;等待用户手动继续下一批处理&#039;, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">934</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">935</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">936</span><span class="code-content">          // 所有批次已处理完成</span></pre>
            <pre class="line"><span class="line-number">937</span><span class="code-content">          this.addAnalysisLog(`所有 ${this.batchProcessInfo.totalBatches} 个批次处理完成，共分析 ${this.batchProcessInfo.processedFiles} 个文件`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">938</span><span class="code-content">          this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">939</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">940</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">941</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">942</span><span class="code-content">        console.error(&#039;分析过程中发生错误:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">943</span><span class="code-content">        let errorMessage = &#039;分析过程中发生错误&#039;;</span></pre>
            <pre class="line"><span class="line-number">944</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">945</span><span class="code-content">        if (error.code === &#039;ECONNABORTED&#039;) {</span></pre>
            <pre class="line"><span class="line-number">946</span><span class="code-content">          errorMessage = &#039;请求超时，分析过程可能需要较长时间，请减少文件数量后再试。&#039;;</span></pre>
            <pre class="line"><span class="line-number">947</span><span class="code-content">          this.addAnalysisLog(&#039;请求超时，请减少文件数量后重试&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">948</span><span class="code-content">          // 自动减少批次大小并重试</span></pre>
            <pre class="line"><span class="line-number">949</span><span class="code-content">          if (this.batchSizeLimit &gt; 5) {</span></pre>
            <pre class="line"><span class="line-number">950</span><span class="code-content">            const newBatchSize = Math.max(5, Math.floor(this.batchSizeLimit / 2));</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 20 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">951</span><span class="code-content">            this.addAnalysisLog(`自动减少批次大小至 ${newBatchSize} 并重试`, &#039;warning&#039;);</span></pre>
            <pre class="line"><span class="line-number">952</span><span class="code-content">            this.batchSizeLimit = newBatchSize;</span></pre>
            <pre class="line"><span class="line-number">953</span><span class="code-content">            // 将当前批次的文件重新放回待处理队列</span></pre>
            <pre class="line"><span class="line-number">954</span><span class="code-content">            this.batchProcessInfo.remainingFiles = [...filesToProcess, ...this.batchProcessInfo.remainingFiles];</span></pre>
            <pre class="line"><span class="line-number">955</span><span class="code-content">            setTimeout(() =&gt; {</span></pre>
            <pre class="line"><span class="line-number">956</span><span class="code-content">              this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">957</span><span class="code-content">              this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">958</span><span class="code-content">            }, 2000);</span></pre>
            <pre class="line"><span class="line-number">959</span><span class="code-content">            return;</span></pre>
            <pre class="line"><span class="line-number">960</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">961</span><span class="code-content">        } else if (error.response) {</span></pre>
            <pre class="line"><span class="line-number">962</span><span class="code-content">          errorMessage = error.response.data?.error || `服务器错误 (${error.response.status})`;</span></pre>
            <pre class="line"><span class="line-number">963</span><span class="code-content">          this.addAnalysisLog(`服务器返回错误: ${errorMessage}`, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">964</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">965</span><span class="code-content">          // 检测API错误并提供配置入口</span></pre>
            <pre class="line"><span class="line-number">966</span><span class="code-content">          if (error.response.status === 401) {</span></pre>
            <pre class="line"><span class="line-number">967</span><span class="code-content">            this.apiErrorMessage = &#039;认证失败 (401): API密钥可能无效或已过期&#039;;</span></pre>
            <pre class="line"><span class="line-number">968</span><span class="code-content">            this.addAnalysisLog(&#039;API认证失败，请检查API配置&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">969</span><span class="code-content">            this.$confirm(&#039;API认证失败，是否打开API配置页面进行设置？&#039;, &#039;认证错误&#039;, {</span></pre>
            <pre class="line"><span class="line-number">970</span><span class="code-content">              confirmButtonText: &#039;去设置&#039;,</span></pre>
            <pre class="line"><span class="line-number">971</span><span class="code-content">              cancelButtonText: &#039;取消&#039;,</span></pre>
            <pre class="line"><span class="line-number">972</span><span class="code-content">              type: &#039;warning&#039;</span></pre>
            <pre class="line"><span class="line-number">973</span><span class="code-content">            }).then(() =&gt; {</span></pre>
            <pre class="line"><span class="line-number">974</span><span class="code-content">              this.showApiConfig = true;</span></pre>
            <pre class="line"><span class="line-number">975</span><span class="code-content">            }).catch(() =&gt; {});</span></pre>
            <pre class="line"><span class="line-number">976</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">977</span><span class="code-content">        } else if (error.request) {</span></pre>
            <pre class="line"><span class="line-number">978</span><span class="code-content">          errorMessage = &#039;无法从服务器获取响应，请检查网络和服务状态。&#039;;</span></pre>
            <pre class="line"><span class="line-number">979</span><span class="code-content">          this.addAnalysisLog(&#039;无法获取服务器响应，请检查网络连接&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">980</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">981</span><span class="code-content">          errorMessage = error.message || errorMessage;</span></pre>
            <pre class="line"><span class="line-number">982</span><span class="code-content">          this.addAnalysisLog(`错误: ${errorMessage}`, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">983</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">984</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">985</span><span class="code-content">        this.$message.error(errorMessage);</span></pre>
            <pre class="line"><span class="line-number">986</span><span class="code-content">        this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">987</span><span class="code-content">        // 停止自动批处理，等待用户手动继续</span></pre>
            <pre class="line"><span class="line-number">988</span><span class="code-content">        this.batchProcessInfo.autoContinue = false;</span></pre>
            <pre class="line"><span class="line-number">989</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">990</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">991</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">992</span><span class="code-content">    // 手动继续处理下一批</span></pre>
            <pre class="line"><span class="line-number">993</span><span class="code-content">    continueNextBatch() {</span></pre>
            <pre class="line"><span class="line-number">994</span><span class="code-content">      if (this.loading) {</span></pre>
            <pre class="line"><span class="line-number">995</span><span class="code-content">        this.$message.warning(&#039;正在分析中，请稍候...&#039;);</span></pre>
            <pre class="line"><span class="line-number">996</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">997</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">998</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">999</span><span class="code-content">      if (this.batchProcessInfo.remainingFiles.length === 0) {</span></pre>
            <pre class="line"><span class="line-number">1000</span><span class="code-content">        this.$message.info(&#039;所有文件已处理完成&#039;);</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 21 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1001</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">1002</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1003</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1004</span><span class="code-content">      this.addAnalysisLog(&#039;手动继续处理下一批&#039;, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">1005</span><span class="code-content">      this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">1006</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1007</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1008</span><span class="code-content">    // 上传并分析文件 (保留以兼容可能的外部调用)</span></pre>
            <pre class="line"><span class="line-number">1009</span><span class="code-content">    async handleUploadAndAnalyze() {</span></pre>
            <pre class="line"><span class="line-number">1010</span><span class="code-content">      this.startBatchAnalysis();</span></pre>
            <pre class="line"><span class="line-number">1011</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1012</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1013</span><span class="code-content">    // 高亮匹配的内容</span></pre>
            <pre class="line"><span class="line-number">1014</span><span class="code-content">    highlightMatch(text, searchTerm) {</span></pre>
            <pre class="line"><span class="line-number">1015</span><span class="code-content">      if (!text || !searchTerm) return text;</span></pre>
            <pre class="line"><span class="line-number">1016</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1017</span><span class="code-content">      // 转义正则表达式中的特殊字符</span></pre>
            <pre class="line"><span class="line-number">1018</span><span class="code-content">      const escapeRegExp = (string) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1019</span><span class="code-content">        return string.replace(/[.*+?^${}()|[\]\\]/g, &#039;\\$&amp;&#039;);</span></pre>
            <pre class="line"><span class="line-number">1020</span><span class="code-content">      };</span></pre>
            <pre class="line"><span class="line-number">1021</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1022</span><span class="code-content">      // 不区分大小写匹配</span></pre>
            <pre class="line"><span class="line-number">1023</span><span class="code-content">      const regex = new RegExp(escapeRegExp(searchTerm), &#039;gi&#039;);</span></pre>
            <pre class="line"><span class="line-number">1024</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1025</span><span class="code-content">      // 替换为高亮样式，并添加独特的标记以便更容易找到</span></pre>
            <pre class="line"><span class="line-number">1026</span><span class="code-content">      const highlighted = text.replace(regex, match =&gt; </span></pre>
            <pre class="line"><span class="line-number">1027</span><span class="code-content">        `&lt;span class=&quot;highlight&quot; data-match=&quot;${this.lastSearchedContent}&quot;&gt;${match}&lt;/span&gt;`);</span></pre>
            <pre class="line"><span class="line-number">1028</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1029</span><span class="code-content">      return highlighted;</span></pre>
            <pre class="line"><span class="line-number">1030</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1031</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1032</span><span class="code-content">    // 将单元格数组格式化为表格数据</span></pre>
            <pre class="line"><span class="line-number">1033</span><span class="code-content">    formatCellsForTable(cells) {</span></pre>
            <pre class="line"><span class="line-number">1034</span><span class="code-content">      return cells.map((value, index) =&gt; ({</span></pre>
            <pre class="line"><span class="line-number">1035</span><span class="code-content">        column: this.getColumnLetter(index),</span></pre>
            <pre class="line"><span class="line-number">1036</span><span class="code-content">        value: value !== undefined &amp;&amp; value !== null ? String(value) : &#039;&#039;</span></pre>
            <pre class="line"><span class="line-number">1037</span><span class="code-content">      }));</span></pre>
            <pre class="line"><span class="line-number">1038</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1039</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1040</span><span class="code-content">    // 将列索引转换为Excel列字母（A, B, C...AA, AB...）</span></pre>
            <pre class="line"><span class="line-number">1041</span><span class="code-content">    getColumnLetter(index) {</span></pre>
            <pre class="line"><span class="line-number">1042</span><span class="code-content">      let column = &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1043</span><span class="code-content">      let temp = index;</span></pre>
            <pre class="line"><span class="line-number">1044</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1045</span><span class="code-content">      while (temp &gt;= 0) {</span></pre>
            <pre class="line"><span class="line-number">1046</span><span class="code-content">        column = String.fromCharCode(65 + (temp % 26)) + column;</span></pre>
            <pre class="line"><span class="line-number">1047</span><span class="code-content">        temp = Math.floor(temp / 26) - 1;</span></pre>
            <pre class="line"><span class="line-number">1048</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1049</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1050</span><span class="code-content">      return column;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 22 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1051</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1052</span><span class="code-content">    // 获取总匹配数</span></pre>
            <pre class="line"><span class="line-number">1053</span><span class="code-content">    getTotalMatchCount() {</span></pre>
            <pre class="line"><span class="line-number">1054</span><span class="code-content">      return this.searchResults.reduce((total, file) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1055</span><span class="code-content">        return total + (file.matchedLines ? file.matchedLines.length : 0);</span></pre>
            <pre class="line"><span class="line-number">1056</span><span class="code-content">      }, 0);</span></pre>
            <pre class="line"><span class="line-number">1057</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1058</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1059</span><span class="code-content">    // 展开所有结果</span></pre>
            <pre class="line"><span class="line-number">1060</span><span class="code-content">    expandAllResults() {</span></pre>
            <pre class="line"><span class="line-number">1061</span><span class="code-content">      if (this.searchResults &amp;&amp; this.searchResults.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">1062</span><span class="code-content">        this.searchResults.forEach(file =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1063</span><span class="code-content">          if (file &amp;&amp; file.matchedLines &amp;&amp; file.matchedLines.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">1064</span><span class="code-content">            this.$set(file, &#039;showDetails&#039;, true);</span></pre>
            <pre class="line"><span class="line-number">1065</span><span class="code-content">            // 确保初始化筛选</span></pre>
            <pre class="line"><span class="line-number">1066</span><span class="code-content">            if (!file.hasOwnProperty(&#039;filterText&#039;)) {</span></pre>
            <pre class="line"><span class="line-number">1067</span><span class="code-content">              this.$set(file, &#039;filterText&#039;, &#039;&#039;);</span></pre>
            <pre class="line"><span class="line-number">1068</span><span class="code-content">              this.$set(file, &#039;filteredMatches&#039;, null);</span></pre>
            <pre class="line"><span class="line-number">1069</span><span class="code-content">            }</span></pre>
            <pre class="line"><span class="line-number">1070</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">1071</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1072</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1073</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1074</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1075</span><span class="code-content">    // 收起所有结果</span></pre>
            <pre class="line"><span class="line-number">1076</span><span class="code-content">    collapseAllResults() {</span></pre>
            <pre class="line"><span class="line-number">1077</span><span class="code-content">      if (this.searchResults &amp;&amp; this.searchResults.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">1078</span><span class="code-content">        this.searchResults.forEach(file =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1079</span><span class="code-content">          if (file) {</span></pre>
            <pre class="line"><span class="line-number">1080</span><span class="code-content">            this.$set(file, &#039;showDetails&#039;, false);</span></pre>
            <pre class="line"><span class="line-number">1081</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">1082</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1083</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1084</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1085</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1086</span><span class="code-content">    // 获取API配置</span></pre>
            <pre class="line"><span class="line-number">1087</span><span class="code-content">    async getApiConfig() {</span></pre>
            <pre class="line"><span class="line-number">1088</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">1089</span><span class="code-content">        const response = await axios.get(`${API_BASE_URL}/api/config`);</span></pre>
            <pre class="line"><span class="line-number">1090</span><span class="code-content">        if (response.data &amp;&amp; response.data.config) {</span></pre>
            <pre class="line"><span class="line-number">1091</span><span class="code-content">          this.apiConfig.apiUrl = response.data.config.SOPHNET_API_URL || &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1092</span><span class="code-content">          this.apiConfig.apiKey = response.data.config.SOPHNET_API_KEY || &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1093</span><span class="code-content">          this.apiConfig.model = response.data.config.SOPHNET_MODEL || &#039;DeepSeek-R1&#039;;</span></pre>
            <pre class="line"><span class="line-number">1094</span><span class="code-content">          this.apiConfig.maxTokens = response.data.config.SOPHNET_MAX_TOKENS || 32768;</span></pre>
            <pre class="line"><span class="line-number">1095</span><span class="code-content">          // 清除错误信息</span></pre>
            <pre class="line"><span class="line-number">1096</span><span class="code-content">          this.apiErrorMessage = &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1097</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">1098</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">1099</span><span class="code-content">        console.error(&#039;获取API配置失败:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1100</span><span class="code-content">        this.$message.error(&#039;获取API配置失败，请检查服务器连接&#039;);</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 23 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1101</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1102</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1103</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1104</span><span class="code-content">    // 保存API配置</span></pre>
            <pre class="line"><span class="line-number">1105</span><span class="code-content">    async saveApiConfig() {</span></pre>
            <pre class="line"><span class="line-number">1106</span><span class="code-content">      this.saveConfigLoading = true;</span></pre>
            <pre class="line"><span class="line-number">1107</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">1108</span><span class="code-content">        const response = await axios.post(`${API_BASE_URL}/api/config`, {</span></pre>
            <pre class="line"><span class="line-number">1109</span><span class="code-content">          SOPHNET_API_URL: this.apiConfig.apiUrl,</span></pre>
            <pre class="line"><span class="line-number">1110</span><span class="code-content">          SOPHNET_API_KEY: this.apiConfig.apiKey,</span></pre>
            <pre class="line"><span class="line-number">1111</span><span class="code-content">          SOPHNET_MODEL: this.apiConfig.model,</span></pre>
            <pre class="line"><span class="line-number">1112</span><span class="code-content">          SOPHNET_MAX_TOKENS: this.apiConfig.maxTokens</span></pre>
            <pre class="line"><span class="line-number">1113</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1114</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1115</span><span class="code-content">        if (response.data &amp;&amp; response.data.success) {</span></pre>
            <pre class="line"><span class="line-number">1116</span><span class="code-content">          this.$message.success(&#039;API配置保存成功&#039;);</span></pre>
            <pre class="line"><span class="line-number">1117</span><span class="code-content">          this.showApiConfig = false;</span></pre>
            <pre class="line"><span class="line-number">1118</span><span class="code-content">          // 重新检查服务器连接</span></pre>
            <pre class="line"><span class="line-number">1119</span><span class="code-content">          this.checkServerConnection();</span></pre>
            <pre class="line"><span class="line-number">1120</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">1121</span><span class="code-content">          this.$message.error(&#039;保存失败: &#039; + (response.data.error || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1122</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">1123</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">1124</span><span class="code-content">        console.error(&#039;保存API配置失败:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1125</span><span class="code-content">        this.$message.error(&#039;保存API配置失败: &#039; + (error.response?.data?.error || error.message || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1126</span><span class="code-content">      } finally {</span></pre>
            <pre class="line"><span class="line-number">1127</span><span class="code-content">        this.saveConfigLoading = false;</span></pre>
            <pre class="line"><span class="line-number">1128</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1129</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1130</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1131</span><span class="code-content">    // 测试API连接</span></pre>
            <pre class="line"><span class="line-number">1132</span><span class="code-content">    async testApiConnection() {</span></pre>
            <pre class="line"><span class="line-number">1133</span><span class="code-content">      this.testApiLoading = true;</span></pre>
            <pre class="line"><span class="line-number">1134</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">1135</span><span class="code-content">        const response = await axios.post(`${API_BASE_URL}/api/test-connection`, {</span></pre>
            <pre class="line"><span class="line-number">1136</span><span class="code-content">          SOPHNET_API_URL: this.apiConfig.apiUrl,</span></pre>
            <pre class="line"><span class="line-number">1137</span><span class="code-content">          SOPHNET_API_KEY: this.apiConfig.apiKey,</span></pre>
            <pre class="line"><span class="line-number">1138</span><span class="code-content">          SOPHNET_MODEL: this.apiConfig.model</span></pre>
            <pre class="line"><span class="line-number">1139</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1140</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1141</span><span class="code-content">        if (response.data &amp;&amp; response.data.success) {</span></pre>
            <pre class="line"><span class="line-number">1142</span><span class="code-content">          this.$message.success(&#039;API连接测试成功!&#039;);</span></pre>
            <pre class="line"><span class="line-number">1143</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">1144</span><span class="code-content">          this.$message.error(&#039;API连接测试失败: &#039; + (response.data.error || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1145</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">1146</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">1147</span><span class="code-content">        console.error(&#039;API连接测试失败:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1148</span><span class="code-content">        this.$message.error(&#039;API连接测试失败: &#039; + (error.response?.data?.error || error.message || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1149</span><span class="code-content">      } finally {</span></pre>
            <pre class="line"><span class="line-number">1150</span><span class="code-content">        this.testApiLoading = false;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 24 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1151</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1152</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1153</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1154</span><span class="code-content">    // 对话框打开时的处理</span></pre>
            <pre class="line"><span class="line-number">1155</span><span class="code-content">    onConfigDialogOpen() {</span></pre>
            <pre class="line"><span class="line-number">1156</span><span class="code-content">      // 备份原始配置用于重置</span></pre>
            <pre class="line"><span class="line-number">1157</span><span class="code-content">      this.originalApiConfig = { ...this.apiConfig };</span></pre>
            <pre class="line"><span class="line-number">1158</span><span class="code-content">      // 默认隐藏API密钥</span></pre>
            <pre class="line"><span class="line-number">1159</span><span class="code-content">      this.showApiKey = false;</span></pre>
            <pre class="line"><span class="line-number">1160</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1161</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1162</span><span class="code-content">    // 重置API配置</span></pre>
            <pre class="line"><span class="line-number">1163</span><span class="code-content">    resetApiConfig() {</span></pre>
            <pre class="line"><span class="line-number">1164</span><span class="code-content">      this.apiConfig = { ...this.originalApiConfig };</span></pre>
            <pre class="line"><span class="line-number">1165</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1166</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1167</span><span class="code-content">    // 添加分析日志</span></pre>
            <pre class="line"><span class="line-number">1168</span><span class="code-content">    addAnalysisLog(message, type = &#039;info&#039;) {</span></pre>
            <pre class="line"><span class="line-number">1169</span><span class="code-content">      const now = new Date();</span></pre>
            <pre class="line"><span class="line-number">1170</span><span class="code-content">      const timeStr = `${now.getHours().toString().padStart(2, &#039;0&#039;)}:${now.getMinutes().toString().padStart(2, &#039;0&#039;)}:${now.getSeconds().toString().padStart(2, &#039;0&#039;)}`;</span></pre>
            <pre class="line"><span class="line-number">1171</span><span class="code-content">      this.analysisLogs.push({</span></pre>
            <pre class="line"><span class="line-number">1172</span><span class="code-content">        time: timeStr,</span></pre>
            <pre class="line"><span class="line-number">1173</span><span class="code-content">        message,</span></pre>
            <pre class="line"><span class="line-number">1174</span><span class="code-content">        type</span></pre>
            <pre class="line"><span class="line-number">1175</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">1176</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1177</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1178</span><span class="code-content">    // 清除分析日志</span></pre>
            <pre class="line"><span class="line-number">1179</span><span class="code-content">    clearAnalysisLogs() {</span></pre>
            <pre class="line"><span class="line-number">1180</span><span class="code-content">      this.analysisLogs = [];</span></pre>
            <pre class="line"><span class="line-number">1181</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1182</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1183</span><span class="code-content">    // 显示完整匹配内容</span></pre>
            <pre class="line"><span class="line-number">1184</span><span class="code-content">    showFullContent(match) {</span></pre>
            <pre class="line"><span class="line-number">1185</span><span class="code-content">      this.fullContentDialog.match = match;</span></pre>
            <pre class="line"><span class="line-number">1186</span><span class="code-content">      this.fullContentDialog.visible = true;</span></pre>
            <pre class="line"><span class="line-number">1187</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1188</span><span class="code-content">  },</span></pre>
            <pre class="line"><span class="line-number">1189</span><span class="code-content">  beforeDestroy() {</span></pre>
            <pre class="line"><span class="line-number">1190</span><span class="code-content">    // 这个钩子中不再需要关闭EventSource，因为我们已经不使用SSE了</span></pre>
            <pre class="line"><span class="line-number">1191</span><span class="code-content">  }</span></pre>
            <pre class="line"><span class="line-number">1192</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1193</span><span class="code-content">&lt;/script&gt;</span></pre>
            <pre class="line"><span class="line-number">1194</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1195</span><span class="code-content">&lt;style scoped&gt;</span></pre>
            <pre class="line"><span class="line-number">1196</span><span class="code-content">.excel-content-finder {</span></pre>
            <pre class="line"><span class="line-number">1197</span><span class="code-content">  padding: 20px;</span></pre>
            <pre class="line"><span class="line-number">1198</span><span class="code-content">  max-width: 900px;</span></pre>
            <pre class="line"><span class="line-number">1199</span><span class="code-content">  margin: 0 auto;</span></pre>
            <pre class="line"><span class="line-number">1200</span><span class="code-content">}</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 25 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1201</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1202</span><span class="code-content">.server-status-container {</span></pre>
            <pre class="line"><span class="line-number">1203</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1204</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1205</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1206</span><span class="code-content">  position: relative;</span></pre>
            <pre class="line"><span class="line-number">1207</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1208</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1209</span><span class="code-content">.server-status {</span></pre>
            <pre class="line"><span class="line-number">1210</span><span class="code-content">  flex: 1;</span></pre>
            <pre class="line"><span class="line-number">1211</span><span class="code-content">  padding: 10px;</span></pre>
            <pre class="line"><span class="line-number">1212</span><span class="code-content">  background-color: #f56c6c;</span></pre>
            <pre class="line"><span class="line-number">1213</span><span class="code-content">  color: white;</span></pre>
            <pre class="line"><span class="line-number">1214</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1215</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1216</span><span class="code-content">  transition: background-color 0.3s ease;</span></pre>
            <pre class="line"><span class="line-number">1217</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1218</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1219</span><span class="code-content">.server-status.connected {</span></pre>
            <pre class="line"><span class="line-number">1220</span><span class="code-content">  background-color: #67c23a;</span></pre>
            <pre class="line"><span class="line-number">1221</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1222</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1223</span><span class="code-content">.analysis-method-info {</span></pre>
            <pre class="line"><span class="line-number">1224</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1225</span><span class="code-content">  border: 1px solid #e6e6e6;</span></pre>
            <pre class="line"><span class="line-number">1226</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1227</span><span class="code-content">  overflow: hidden;</span></pre>
            <pre class="line"><span class="line-number">1228</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1229</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1230</span><span class="code-content">.folder-selection-section {</span></pre>
            <pre class="line"><span class="line-number">1231</span><span class="code-content">  margin-bottom: 15px;</span></pre>
            <pre class="line"><span class="line-number">1232</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1233</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1234</span><span class="code-content">  gap: 15px;</span></pre>
            <pre class="line"><span class="line-number">1235</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1236</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1237</span><span class="code-content">.selected-files-info {</span></pre>
            <pre class="line"><span class="line-number">1238</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1239</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1240</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1241</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1242</span><span class="code-content">.search-section {</span></pre>
            <pre class="line"><span class="line-number">1243</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1244</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1245</span><span class="code-content">  gap: 10px;</span></pre>
            <pre class="line"><span class="line-number">1246</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1247</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1248</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1249</span><span class="code-content">.search-input {</span></pre>
            <pre class="line"><span class="line-number">1250</span><span class="code-content">  flex: 1;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 26 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1251</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1252</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1253</span><span class="code-content">.file-list-section {</span></pre>
            <pre class="line"><span class="line-number">1254</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1255</span><span class="code-content">  border: 1px solid #ebeef5;</span></pre>
            <pre class="line"><span class="line-number">1256</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1257</span><span class="code-content">  padding: 10px;</span></pre>
            <pre class="line"><span class="line-number">1258</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1259</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1260</span><span class="code-content">.status-section {</span></pre>
            <pre class="line"><span class="line-number">1261</span><span class="code-content">  margin: 20px 0;</span></pre>
            <pre class="line"><span class="line-number">1262</span><span class="code-content">  padding: 0;</span></pre>
            <pre class="line"><span class="line-number">1263</span><span class="code-content">  border: 1px solid #dcdfe6;</span></pre>
            <pre class="line"><span class="line-number">1264</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1265</span><span class="code-content">  background-color: #fff;</span></pre>
            <pre class="line"><span class="line-number">1266</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1267</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1268</span><span class="code-content">.status-section p {</span></pre>
            <pre class="line"><span class="line-number">1269</span><span class="code-content">  margin: 0 0 10px 0;</span></pre>
            <pre class="line"><span class="line-number">1270</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1271</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1272</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1273</span><span class="code-content">.results-section {</span></pre>
            <pre class="line"><span class="line-number">1274</span><span class="code-content">  margin-top: 20px;</span></pre>
            <pre class="line"><span class="line-number">1275</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1276</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1277</span><span class="code-content">.no-results {</span></pre>
            <pre class="line"><span class="line-number">1278</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1279</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1280</span><span class="code-content">  margin-top: 30px;</span></pre>
            <pre class="line"><span class="line-number">1281</span><span class="code-content">  padding: 20px;</span></pre>
            <pre class="line"><span class="line-number">1282</span><span class="code-content">  border: 1px dashed #dcdfe6;</span></pre>
            <pre class="line"><span class="line-number">1283</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1284</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1285</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1286</span><span class="code-content">:deep(.el-table .el-progress__text) {</span></pre>
            <pre class="line"><span class="line-number">1287</span><span class="code-content">  font-size: 12px !important;</span></pre>
            <pre class="line"><span class="line-number">1288</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1289</span><span class="code-content">:deep(.el-table .el-progress-bar) {</span></pre>
            <pre class="line"><span class="line-number">1290</span><span class="code-content">  padding-right: 50px;</span></pre>
            <pre class="line"><span class="line-number">1291</span><span class="code-content">  margin-right: -50px;</span></pre>
            <pre class="line"><span class="line-number">1292</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1293</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1294</span><span class="code-content">.small-text {</span></pre>
            <pre class="line"><span class="line-number">1295</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1296</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1297</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1298</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1299</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1300</span><span class="code-content">.match-summary {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 27 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1301</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1302</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1303</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1304</span><span class="code-content">  margin-bottom: 5px;</span></pre>
            <pre class="line"><span class="line-number">1305</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1306</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1307</span><span class="code-content">.match-count {</span></pre>
            <pre class="line"><span class="line-number">1308</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1309</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1310</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1311</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1312</span><span class="code-content">.toggle-btn {</span></pre>
            <pre class="line"><span class="line-number">1313</span><span class="code-content">  padding: 0;</span></pre>
            <pre class="line"><span class="line-number">1314</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1315</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1316</span><span class="code-content">.matched-lines {</span></pre>
            <pre class="line"><span class="line-number">1317</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1318</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1319</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1320</span><span class="code-content">.match-card {</span></pre>
            <pre class="line"><span class="line-number">1321</span><span class="code-content">  margin-bottom: 16px;</span></pre>
            <pre class="line"><span class="line-number">1322</span><span class="code-content">  max-width: 100%;</span></pre>
            <pre class="line"><span class="line-number">1323</span><span class="code-content">  overflow: hidden;</span></pre>
            <pre class="line"><span class="line-number">1324</span><span class="code-content">  border: 1px solid #dcdfe6;</span></pre>
            <pre class="line"><span class="line-number">1325</span><span class="code-content">  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);</span></pre>
            <pre class="line"><span class="line-number">1326</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1327</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1328</span><span class="code-content">.match-card :deep(.el-card__header) {</span></pre>
            <pre class="line"><span class="line-number">1329</span><span class="code-content">  padding: 12px 15px;</span></pre>
            <pre class="line"><span class="line-number">1330</span><span class="code-content">  background-color: #f6f8fa;</span></pre>
            <pre class="line"><span class="line-number">1331</span><span class="code-content">  font-size: 13px;</span></pre>
            <pre class="line"><span class="line-number">1332</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1333</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1334</span><span class="code-content">.match-card :deep(.el-card__body) {</span></pre>
            <pre class="line"><span class="line-number">1335</span><span class="code-content">  padding: 15px;</span></pre>
            <pre class="line"><span class="line-number">1336</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1337</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1338</span><span class="code-content">.match-header {</span></pre>
            <pre class="line"><span class="line-number">1339</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1340</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1341</span><span class="code-content">  font-size: 13px;</span></pre>
            <pre class="line"><span class="line-number">1342</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1343</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1344</span><span class="code-content">.sheet-name {</span></pre>
            <pre class="line"><span class="line-number">1345</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1346</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1347</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1348</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1349</span><span class="code-content">.row-number {</span></pre>
            <pre class="line"><span class="line-number">1350</span><span class="code-content">  color: #606266;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 28 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1351</span><span class="code-content">  font-weight: normal;</span></pre>
            <pre class="line"><span class="line-number">1352</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1353</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1354</span><span class="code-content">/* 单元格详情表格样式 */</span></pre>
            <pre class="line"><span class="line-number">1355</span><span class="code-content">.cell-details {</span></pre>
            <pre class="line"><span class="line-number">1356</span><span class="code-content">  margin-top: 15px;</span></pre>
            <pre class="line"><span class="line-number">1357</span><span class="code-content">  border-top: 1px solid #ebeef5;</span></pre>
            <pre class="line"><span class="line-number">1358</span><span class="code-content">  padding-top: 12px;</span></pre>
            <pre class="line"><span class="line-number">1359</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1360</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1361</span><span class="code-content">.cell-details-header {</span></pre>
            <pre class="line"><span class="line-number">1362</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1363</span><span class="code-content">  margin-bottom: 8px;</span></pre>
            <pre class="line"><span class="line-number">1364</span><span class="code-content">  font-size: 13px;</span></pre>
            <pre class="line"><span class="line-number">1365</span><span class="code-content">  color: #303133;</span></pre>
            <pre class="line"><span class="line-number">1366</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1367</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1368</span><span class="code-content">.cell-details .el-table {</span></pre>
            <pre class="line"><span class="line-number">1369</span><span class="code-content">  margin-top: 8px;</span></pre>
            <pre class="line"><span class="line-number">1370</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1371</span><span class="code-content">  overflow: hidden;</span></pre>
            <pre class="line"><span class="line-number">1372</span><span class="code-content">  max-height: none;</span></pre>
            <pre class="line"><span class="line-number">1373</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1374</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1375</span><span class="code-content">.cell-details .el-table :deep(th) {</span></pre>
            <pre class="line"><span class="line-number">1376</span><span class="code-content">  background-color: #f5f7fa;</span></pre>
            <pre class="line"><span class="line-number">1377</span><span class="code-content">  color: #606266;</span></pre>
            <pre class="line"><span class="line-number">1378</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1379</span><span class="code-content">  padding: 8px 12px;</span></pre>
            <pre class="line"><span class="line-number">1380</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1381</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1382</span><span class="code-content">.cell-details .el-table :deep(td) {</span></pre>
            <pre class="line"><span class="line-number">1383</span><span class="code-content">  padding: 8px 12px;</span></pre>
            <pre class="line"><span class="line-number">1384</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1385</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1386</span><span class="code-content">/* 确保单元格内容完整显示 */</span></pre>
            <pre class="line"><span class="line-number">1387</span><span class="code-content">.cell-details .el-table :deep(.cell) {</span></pre>
            <pre class="line"><span class="line-number">1388</span><span class="code-content">  word-break: break-word;</span></pre>
            <pre class="line"><span class="line-number">1389</span><span class="code-content">  line-height: 1.5;</span></pre>
            <pre class="line"><span class="line-number">1390</span><span class="code-content">  min-height: 20px;</span></pre>
            <pre class="line"><span class="line-number">1391</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1392</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1393</span><span class="code-content">.batch-actions {</span></pre>
            <pre class="line"><span class="line-number">1394</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1395</span><span class="code-content">  margin-bottom: 15px;</span></pre>
            <pre class="line"><span class="line-number">1396</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1397</span><span class="code-content">  gap: 10px;</span></pre>
            <pre class="line"><span class="line-number">1398</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1399</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1400</span><span class="code-content">.match-total {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 29 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1401</span><span class="code-content">  margin-left: auto;</span></pre>
            <pre class="line"><span class="line-number">1402</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1403</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1404</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1405</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1406</span><span class="code-content">.match-filter {</span></pre>
            <pre class="line"><span class="line-number">1407</span><span class="code-content">  margin-bottom: 10px;</span></pre>
            <pre class="line"><span class="line-number">1408</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1409</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1410</span><span class="code-content">.no-filter-matches {</span></pre>
            <pre class="line"><span class="line-number">1411</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1412</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1413</span><span class="code-content">  padding: 10px;</span></pre>
            <pre class="line"><span class="line-number">1414</span><span class="code-content">  font-style: italic;</span></pre>
            <pre class="line"><span class="line-number">1415</span><span class="code-content">  background-color: #f9f9f9;</span></pre>
            <pre class="line"><span class="line-number">1416</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1417</span><span class="code-content">  margin-bottom: 10px;</span></pre>
            <pre class="line"><span class="line-number">1418</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1419</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1420</span><span class="code-content">.error-details {</span></pre>
            <pre class="line"><span class="line-number">1421</span><span class="code-content">  font-family: monospace;</span></pre>
            <pre class="line"><span class="line-number">1422</span><span class="code-content">  margin-top: 8px;</span></pre>
            <pre class="line"><span class="line-number">1423</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1424</span><span class="code-content">  white-space: pre-wrap;</span></pre>
            <pre class="line"><span class="line-number">1425</span><span class="code-content">  word-break: break-word;</span></pre>
            <pre class="line"><span class="line-number">1426</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1427</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1428</span><span class="code-content">.api-config-button {</span></pre>
            <pre class="line"><span class="line-number">1429</span><span class="code-content">  position: absolute;</span></pre>
            <pre class="line"><span class="line-number">1430</span><span class="code-content">  right: -15px;</span></pre>
            <pre class="line"><span class="line-number">1431</span><span class="code-content">  top: 50%;</span></pre>
            <pre class="line"><span class="line-number">1432</span><span class="code-content">  transform: translateY(-50%);</span></pre>
            <pre class="line"><span class="line-number">1433</span><span class="code-content">  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);</span></pre>
            <pre class="line"><span class="line-number">1434</span><span class="code-content">  z-index: 1;</span></pre>
            <pre class="line"><span class="line-number">1435</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1436</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1437</span><span class="code-content">.form-tip {</span></pre>
            <pre class="line"><span class="line-number">1438</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1439</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1440</span><span class="code-content">  line-height: 1.2;</span></pre>
            <pre class="line"><span class="line-number">1441</span><span class="code-content">  padding: 2px 0;</span></pre>
            <pre class="line"><span class="line-number">1442</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1443</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1444</span><span class="code-content">.analysis-logs {</span></pre>
            <pre class="line"><span class="line-number">1445</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1446</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1447</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1448</span><span class="code-content">.log-header {</span></pre>
            <pre class="line"><span class="line-number">1449</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1450</span><span class="code-content">  justify-content: space-between;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 30 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1451</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1452</span><span class="code-content">  margin-bottom: 5px;</span></pre>
            <pre class="line"><span class="line-number">1453</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1454</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1455</span><span class="code-content">.log-container {</span></pre>
            <pre class="line"><span class="line-number">1456</span><span class="code-content">  max-height: 200px;</span></pre>
            <pre class="line"><span class="line-number">1457</span><span class="code-content">  overflow-y: auto;</span></pre>
            <pre class="line"><span class="line-number">1458</span><span class="code-content">  border: 1px solid #EBEEF5;</span></pre>
            <pre class="line"><span class="line-number">1459</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1460</span><span class="code-content">  padding: 8px;</span></pre>
            <pre class="line"><span class="line-number">1461</span><span class="code-content">  background-color: #FAFAFA;</span></pre>
            <pre class="line"><span class="line-number">1462</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1463</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1464</span><span class="code-content">.log-item {</span></pre>
            <pre class="line"><span class="line-number">1465</span><span class="code-content">  margin-bottom: 5px;</span></pre>
            <pre class="line"><span class="line-number">1466</span><span class="code-content">  padding: 4px 0;</span></pre>
            <pre class="line"><span class="line-number">1467</span><span class="code-content">  border-bottom: 1px dashed #EBEEF5;</span></pre>
            <pre class="line"><span class="line-number">1468</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1469</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1470</span><span class="code-content">.log-time {</span></pre>
            <pre class="line"><span class="line-number">1471</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1472</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1473</span><span class="code-content">  margin-right: 8px;</span></pre>
            <pre class="line"><span class="line-number">1474</span><span class="code-content">  display: inline-block;</span></pre>
            <pre class="line"><span class="line-number">1475</span><span class="code-content">  width: 80px;</span></pre>
            <pre class="line"><span class="line-number">1476</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1477</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1478</span><span class="code-content">.log-message {</span></pre>
            <pre class="line"><span class="line-number">1479</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1480</span><span class="code-content">  color: #606266;</span></pre>
            <pre class="line"><span class="line-number">1481</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1482</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1483</span><span class="code-content">.log-error {</span></pre>
            <pre class="line"><span class="line-number">1484</span><span class="code-content">  color: #F56C6C;</span></pre>
            <pre class="line"><span class="line-number">1485</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1486</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1487</span><span class="code-content">.log-error .log-time {</span></pre>
            <pre class="line"><span class="line-number">1488</span><span class="code-content">  color: #F56C6C;</span></pre>
            <pre class="line"><span class="line-number">1489</span><span class="code-content">  opacity: 0.8;</span></pre>
            <pre class="line"><span class="line-number">1490</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1491</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1492</span><span class="code-content">.log-success {</span></pre>
            <pre class="line"><span class="line-number">1493</span><span class="code-content">  color: #67C23A;</span></pre>
            <pre class="line"><span class="line-number">1494</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1495</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1496</span><span class="code-content">.log-success .log-time {</span></pre>
            <pre class="line"><span class="line-number">1497</span><span class="code-content">  color: #67C23A;</span></pre>
            <pre class="line"><span class="line-number">1498</span><span class="code-content">  opacity: 0.8;</span></pre>
            <pre class="line"><span class="line-number">1499</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1500</span><span class="code-content"></span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 31 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">771</span><span class="code-content">          this.$set(file, &#039;filterText&#039;, &#039;&#039;);</span></pre>
            <pre class="line"><span class="line-number">772</span><span class="code-content">          this.$set(file, &#039;filteredMatches&#039;, null);</span></pre>
            <pre class="line"><span class="line-number">773</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">774</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">775</span><span class="code-content">        // 重置分页</span></pre>
            <pre class="line"><span class="line-number">776</span><span class="code-content">        if (!file.id) {</span></pre>
            <pre class="line"><span class="line-number">777</span><span class="code-content">          // 生成唯一ID</span></pre>
            <pre class="line"><span class="line-number">778</span><span class="code-content">          file.id = file.fileName.replace(/\W/g, &#039;&#039;) + Date.now().toString().slice(-6);</span></pre>
            <pre class="line"><span class="line-number">779</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">780</span><span class="code-content">        this.$set(this.matchPagination.currentPageMap, file.id, 1);</span></pre>
            <pre class="line"><span class="line-number">781</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">782</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">783</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">784</span><span class="code-content">    // 开始批量分析处理</span></pre>
            <pre class="line"><span class="line-number">785</span><span class="code-content">    startBatchAnalysis() {</span></pre>
            <pre class="line"><span class="line-number">786</span><span class="code-content">      if (!this.serverConnected) {</span></pre>
            <pre class="line"><span class="line-number">787</span><span class="code-content">        this.$message.error(&#039;服务器未连接，请先确保后台服务运行正常&#039;);</span></pre>
            <pre class="line"><span class="line-number">788</span><span class="code-content">        this.checkServerConnection();</span></pre>
            <pre class="line"><span class="line-number">789</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">790</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">791</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">792</span><span class="code-content">      if (!this.searchContent) {</span></pre>
            <pre class="line"><span class="line-number">793</span><span class="code-content">        this.$message.warning(&#039;请输入搜索内容&#039;);</span></pre>
            <pre class="line"><span class="line-number">794</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">795</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">796</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">797</span><span class="code-content">      if (this.selectedFiles.length === 0) {</span></pre>
            <pre class="line"><span class="line-number">798</span><span class="code-content">        this.$message.warning(&#039;请先选择包含Excel文件的文件夹&#039;);</span></pre>
            <pre class="line"><span class="line-number">799</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">800</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">801</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">802</span><span class="code-content">      if (this.loading) {</span></pre>
            <pre class="line"><span class="line-number">803</span><span class="code-content">        this.$message.warning(&#039;正在分析中，请稍候...&#039;);</span></pre>
            <pre class="line"><span class="line-number">804</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">805</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">806</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">807</span><span class="code-content">      // 重置状态</span></pre>
            <pre class="line"><span class="line-number">808</span><span class="code-content">      this.searchResults = [];</span></pre>
            <pre class="line"><span class="line-number">809</span><span class="code-content">      this.lastSearchedContent = this.searchContent;</span></pre>
            <pre class="line"><span class="line-number">810</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">811</span><span class="code-content">      // 初始化批处理信息</span></pre>
            <pre class="line"><span class="line-number">812</span><span class="code-content">      this.batchProcessInfo.enabled = true;</span></pre>
            <pre class="line"><span class="line-number">813</span><span class="code-content">      this.batchProcessInfo.totalFiles = this.selectedFiles.length;</span></pre>
            <pre class="line"><span class="line-number">814</span><span class="code-content">      this.batchProcessInfo.processedFiles = 0;</span></pre>
            <pre class="line"><span class="line-number">815</span><span class="code-content">      this.batchProcessInfo.currentBatch = 1;</span></pre>
            <pre class="line"><span class="line-number">816</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">817</span><span class="code-content">      // 计算总批次数</span></pre>
            <pre class="line"><span class="line-number">818</span><span class="code-content">      if (this.batchSizeLimit &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">819</span><span class="code-content">        this.batchProcessInfo.totalBatches = Math.ceil(this.selectedFiles.length / this.batchSizeLimit);</span></pre>
            <pre class="line"><span class="line-number">820</span><span class="code-content">      } else {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 32 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">821</span><span class="code-content">        this.batchProcessInfo.totalBatches = 1;</span></pre>
            <pre class="line"><span class="line-number">822</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">823</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">824</span><span class="code-content">      this.batchProcessInfo.percentage = 0;</span></pre>
            <pre class="line"><span class="line-number">825</span><span class="code-content">      this.batchProcessInfo.remainingFiles = [...this.selectedFiles];</span></pre>
            <pre class="line"><span class="line-number">826</span><span class="code-content">      this.batchProcessInfo.autoContinue = true;</span></pre>
            <pre class="line"><span class="line-number">827</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">828</span><span class="code-content">      // 清空之前的日志</span></pre>
            <pre class="line"><span class="line-number">829</span><span class="code-content">      this.analysisLogs = [];</span></pre>
            <pre class="line"><span class="line-number">830</span><span class="code-content">      this.addAnalysisLog(`开始批量处理，共 ${this.selectedFiles.length} 个文件，分为 ${this.batchProcessInfo.totalBatches} 个批次`, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">831</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">832</span><span class="code-content">      // 处理第一批</span></pre>
            <pre class="line"><span class="line-number">833</span><span class="code-content">      this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">834</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">835</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">836</span><span class="code-content">    // 处理单个批次</span></pre>
            <pre class="line"><span class="line-number">837</span><span class="code-content">    async processBatch() {</span></pre>
            <pre class="line"><span class="line-number">838</span><span class="code-content">      this.loading = true;</span></pre>
            <pre class="line"><span class="line-number">839</span><span class="code-content">      this.searched = true;</span></pre>
            <pre class="line"><span class="line-number">840</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">841</span><span class="code-content">      // 确定本批次要处理的文件</span></pre>
            <pre class="line"><span class="line-number">842</span><span class="code-content">      let filesToProcess = [];</span></pre>
            <pre class="line"><span class="line-number">843</span><span class="code-content">      if (this.batchSizeLimit &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">844</span><span class="code-content">        filesToProcess = this.batchProcessInfo.remainingFiles.slice(0, this.batchSizeLimit);</span></pre>
            <pre class="line"><span class="line-number">845</span><span class="code-content">        this.batchProcessInfo.remainingFiles = this.batchProcessInfo.remainingFiles.slice(this.batchSizeLimit);</span></pre>
            <pre class="line"><span class="line-number">846</span><span class="code-content">      } else {</span></pre>
            <pre class="line"><span class="line-number">847</span><span class="code-content">        filesToProcess = [...this.batchProcessInfo.remainingFiles];</span></pre>
            <pre class="line"><span class="line-number">848</span><span class="code-content">        this.batchProcessInfo.remainingFiles = [];</span></pre>
            <pre class="line"><span class="line-number">849</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">850</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">851</span><span class="code-content">      this.analysisProgress = { processed: 0, total: filesToProcess.length };</span></pre>
            <pre class="line"><span class="line-number">852</span><span class="code-content">      this.addAnalysisLog(`处理批次 ${this.batchProcessInfo.currentBatch}/${this.batchProcessInfo.totalBatches}，本批次 ${filesToProcess.length} 个文件`, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">853</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">854</span><span class="code-content">      // 创建FormData并添加搜索内容</span></pre>
            <pre class="line"><span class="line-number">855</span><span class="code-content">      const formData = new FormData();</span></pre>
            <pre class="line"><span class="line-number">856</span><span class="code-content">      formData.append(&#039;searchContent&#039;, this.searchContent);</span></pre>
            <pre class="line"><span class="line-number">857</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">858</span><span class="code-content">      // 添加高级搜索选项</span></pre>
            <pre class="line"><span class="line-number">859</span><span class="code-content">      formData.append(&#039;understandingMode&#039;, this.searchOptions.understandingMode);</span></pre>
            <pre class="line"><span class="line-number">860</span><span class="code-content">      formData.append(&#039;minRelevanceThreshold&#039;, this.searchOptions.minRelevanceThreshold.toString());</span></pre>
            <pre class="line"><span class="line-number">861</span><span class="code-content">      formData.append(&#039;analysisDepth&#039;, this.searchOptions.analysisDepth);</span></pre>
            <pre class="line"><span class="line-number">862</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">863</span><span class="code-content">      // 添加本批次的所有Excel文件</span></pre>
            <pre class="line"><span class="line-number">864</span><span class="code-content">      filesToProcess.forEach(file =&gt; {</span></pre>
            <pre class="line"><span class="line-number">865</span><span class="code-content">        formData.append(&#039;files&#039;, file);</span></pre>
            <pre class="line"><span class="line-number">866</span><span class="code-content">        this.addAnalysisLog(`添加文件: ${file.name}`, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">867</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">868</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">869</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">870</span><span class="code-content">        this.addAnalysisLog(`开始上传文件...分析模式: ${this.searchOptions.understandingMode}`, &#039;info&#039;);</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 33 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">871</span><span class="code-content">        const response = await axios.post(</span></pre>
            <pre class="line"><span class="line-number">872</span><span class="code-content">          `${API_BASE_URL}/api/upload-and-analyze`, </span></pre>
            <pre class="line"><span class="line-number">873</span><span class="code-content">          formData,</span></pre>
            <pre class="line"><span class="line-number">874</span><span class="code-content">          {</span></pre>
            <pre class="line"><span class="line-number">875</span><span class="code-content">          headers: {</span></pre>
            <pre class="line"><span class="line-number">876</span><span class="code-content">              // 不需要手动设置Content-Type，浏览器会自动处理FormData</span></pre>
            <pre class="line"><span class="line-number">877</span><span class="code-content">            },</span></pre>
            <pre class="line"><span class="line-number">878</span><span class="code-content">            timeout: 300000, // 5分钟超时</span></pre>
            <pre class="line"><span class="line-number">879</span><span class="code-content">            onUploadProgress: (progressEvent) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">880</span><span class="code-content">              // 如果需要显示上传进度</span></pre>
            <pre class="line"><span class="line-number">881</span><span class="code-content">              const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);</span></pre>
            <pre class="line"><span class="line-number">882</span><span class="code-content">              console.log(`上传进度: ${percentCompleted}%`);</span></pre>
            <pre class="line"><span class="line-number">883</span><span class="code-content">              if (percentCompleted === 100) {</span></pre>
            <pre class="line"><span class="line-number">884</span><span class="code-content">                this.addAnalysisLog(&#039;文件上传完成，开始分析...&#039;, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">885</span><span class="code-content">              }</span></pre>
            <pre class="line"><span class="line-number">886</span><span class="code-content">            }</span></pre>
            <pre class="line"><span class="line-number">887</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">888</span><span class="code-content">        );</span></pre>
            <pre class="line"><span class="line-number">889</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">890</span><span class="code-content">        if (response.data.error) {</span></pre>
            <pre class="line"><span class="line-number">891</span><span class="code-content">          throw new Error(response.data.error);</span></pre>
            <pre class="line"><span class="line-number">892</span><span class="code-content">        } else if (response.data.results) {</span></pre>
            <pre class="line"><span class="line-number">893</span><span class="code-content">          // 记录分析结果</span></pre>
            <pre class="line"><span class="line-number">894</span><span class="code-content">          this.addAnalysisLog(`批次 ${this.batchProcessInfo.currentBatch} 分析完成，找到 ${response.data.results.length} 个结果文件`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">895</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">896</span><span class="code-content">          // 初始化结果中的展开/折叠状态，并合并到总结果中</span></pre>
            <pre class="line"><span class="line-number">897</span><span class="code-content">          const batchResults = response.data.results.map(result =&gt; {</span></pre>
            <pre class="line"><span class="line-number">898</span><span class="code-content">            if (result.matchedLines &amp;&amp; result.matchedLines.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">899</span><span class="code-content">              this.addAnalysisLog(`文件 &quot;${result.fileName}&quot; 找到 ${result.matchedLines.length} 处匹配，相关度: ${result.relevance}`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">900</span><span class="code-content">            }</span></pre>
            <pre class="line"><span class="line-number">901</span><span class="code-content">            return {</span></pre>
            <pre class="line"><span class="line-number">902</span><span class="code-content">              ...result,</span></pre>
            <pre class="line"><span class="line-number">903</span><span class="code-content">              showDetails: false,</span></pre>
            <pre class="line"><span class="line-number">904</span><span class="code-content">              filterText: &#039;&#039;,</span></pre>
            <pre class="line"><span class="line-number">905</span><span class="code-content">              filteredMatches: null</span></pre>
            <pre class="line"><span class="line-number">906</span><span class="code-content">            };</span></pre>
            <pre class="line"><span class="line-number">907</span><span class="code-content">          });</span></pre>
            <pre class="line"><span class="line-number">908</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">909</span><span class="code-content">          // 合并结果</span></pre>
            <pre class="line"><span class="line-number">910</span><span class="code-content">          this.searchResults = [...this.searchResults, ...batchResults];</span></pre>
            <pre class="line"><span class="line-number">911</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">912</span><span class="code-content">          console.warn(&quot;意外的响应结构:&quot;, response.data);</span></pre>
            <pre class="line"><span class="line-number">913</span><span class="code-content">          this.addAnalysisLog(&#039;收到未预期的服务器响应格式&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">914</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">915</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">916</span><span class="code-content">        // 更新批处理进度信息</span></pre>
            <pre class="line"><span class="line-number">917</span><span class="code-content">        this.batchProcessInfo.processedFiles += filesToProcess.length;</span></pre>
            <pre class="line"><span class="line-number">918</span><span class="code-content">        this.batchProcessInfo.percentage = Math.floor((this.batchProcessInfo.processedFiles / this.batchProcessInfo.totalFiles) * 100);</span></pre>
            <pre class="line"><span class="line-number">919</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">920</span><span class="code-content">        // 检查是否还有剩余批次</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 34 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">921</span><span class="code-content">        if (this.batchProcessInfo.remainingFiles.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">922</span><span class="code-content">          this.batchProcessInfo.currentBatch++;</span></pre>
            <pre class="line"><span class="line-number">923</span><span class="code-content">          this.addAnalysisLog(`批次 ${this.batchProcessInfo.currentBatch - 1}/${this.batchProcessInfo.totalBatches} 处理完成，剩余 ${this.batchProcessInfo.remainingFiles.length} 个文件待处理`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">924</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">925</span><span class="code-content">          // 是否自动处理下一批</span></pre>
            <pre class="line"><span class="line-number">926</span><span class="code-content">          if (this.batchProcessInfo.autoContinue) {</span></pre>
            <pre class="line"><span class="line-number">927</span><span class="code-content">            // 给用户一些时间查看结果，然后再继续处理下一批</span></pre>
            <pre class="line"><span class="line-number">928</span><span class="code-content">            setTimeout(() =&gt; {</span></pre>
            <pre class="line"><span class="line-number">929</span><span class="code-content">              this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">930</span><span class="code-content">            }, 1000);</span></pre>
            <pre class="line"><span class="line-number">931</span><span class="code-content">          } else {</span></pre>
            <pre class="line"><span class="line-number">932</span><span class="code-content">            this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">933</span><span class="code-content">            this.addAnalysisLog(&#039;等待用户手动继续下一批处理&#039;, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">934</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">935</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">936</span><span class="code-content">          // 所有批次已处理完成</span></pre>
            <pre class="line"><span class="line-number">937</span><span class="code-content">          this.addAnalysisLog(`所有 ${this.batchProcessInfo.totalBatches} 个批次处理完成，共分析 ${this.batchProcessInfo.processedFiles} 个文件`, &#039;success&#039;);</span></pre>
            <pre class="line"><span class="line-number">938</span><span class="code-content">          this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">939</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">940</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">941</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">942</span><span class="code-content">        console.error(&#039;分析过程中发生错误:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">943</span><span class="code-content">        let errorMessage = &#039;分析过程中发生错误&#039;;</span></pre>
            <pre class="line"><span class="line-number">944</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">945</span><span class="code-content">        if (error.code === &#039;ECONNABORTED&#039;) {</span></pre>
            <pre class="line"><span class="line-number">946</span><span class="code-content">          errorMessage = &#039;请求超时，分析过程可能需要较长时间，请减少文件数量后再试。&#039;;</span></pre>
            <pre class="line"><span class="line-number">947</span><span class="code-content">          this.addAnalysisLog(&#039;请求超时，请减少文件数量后重试&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">948</span><span class="code-content">          // 自动减少批次大小并重试</span></pre>
            <pre class="line"><span class="line-number">949</span><span class="code-content">          if (this.batchSizeLimit &gt; 5) {</span></pre>
            <pre class="line"><span class="line-number">950</span><span class="code-content">            const newBatchSize = Math.max(5, Math.floor(this.batchSizeLimit / 2));</span></pre>
            <pre class="line"><span class="line-number">951</span><span class="code-content">            this.addAnalysisLog(`自动减少批次大小至 ${newBatchSize} 并重试`, &#039;warning&#039;);</span></pre>
            <pre class="line"><span class="line-number">952</span><span class="code-content">            this.batchSizeLimit = newBatchSize;</span></pre>
            <pre class="line"><span class="line-number">953</span><span class="code-content">            // 将当前批次的文件重新放回待处理队列</span></pre>
            <pre class="line"><span class="line-number">954</span><span class="code-content">            this.batchProcessInfo.remainingFiles = [...filesToProcess, ...this.batchProcessInfo.remainingFiles];</span></pre>
            <pre class="line"><span class="line-number">955</span><span class="code-content">            setTimeout(() =&gt; {</span></pre>
            <pre class="line"><span class="line-number">956</span><span class="code-content">              this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">957</span><span class="code-content">              this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">958</span><span class="code-content">            }, 2000);</span></pre>
            <pre class="line"><span class="line-number">959</span><span class="code-content">            return;</span></pre>
            <pre class="line"><span class="line-number">960</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">961</span><span class="code-content">        } else if (error.response) {</span></pre>
            <pre class="line"><span class="line-number">962</span><span class="code-content">          errorMessage = error.response.data?.error || `服务器错误 (${error.response.status})`;</span></pre>
            <pre class="line"><span class="line-number">963</span><span class="code-content">          this.addAnalysisLog(`服务器返回错误: ${errorMessage}`, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">964</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">965</span><span class="code-content">          // 检测API错误并提供配置入口</span></pre>
            <pre class="line"><span class="line-number">966</span><span class="code-content">          if (error.response.status === 401) {</span></pre>
            <pre class="line"><span class="line-number">967</span><span class="code-content">            this.apiErrorMessage = &#039;认证失败 (401): API密钥可能无效或已过期&#039;;</span></pre>
            <pre class="line"><span class="line-number">968</span><span class="code-content">            this.addAnalysisLog(&#039;API认证失败，请检查API配置&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">969</span><span class="code-content">            this.$confirm(&#039;API认证失败，是否打开API配置页面进行设置？&#039;, &#039;认证错误&#039;, {</span></pre>
            <pre class="line"><span class="line-number">970</span><span class="code-content">              confirmButtonText: &#039;去设置&#039;,</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 35 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">971</span><span class="code-content">              cancelButtonText: &#039;取消&#039;,</span></pre>
            <pre class="line"><span class="line-number">972</span><span class="code-content">              type: &#039;warning&#039;</span></pre>
            <pre class="line"><span class="line-number">973</span><span class="code-content">            }).then(() =&gt; {</span></pre>
            <pre class="line"><span class="line-number">974</span><span class="code-content">              this.showApiConfig = true;</span></pre>
            <pre class="line"><span class="line-number">975</span><span class="code-content">            }).catch(() =&gt; {});</span></pre>
            <pre class="line"><span class="line-number">976</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">977</span><span class="code-content">        } else if (error.request) {</span></pre>
            <pre class="line"><span class="line-number">978</span><span class="code-content">          errorMessage = &#039;无法从服务器获取响应，请检查网络和服务状态。&#039;;</span></pre>
            <pre class="line"><span class="line-number">979</span><span class="code-content">          this.addAnalysisLog(&#039;无法获取服务器响应，请检查网络连接&#039;, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">980</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">981</span><span class="code-content">          errorMessage = error.message || errorMessage;</span></pre>
            <pre class="line"><span class="line-number">982</span><span class="code-content">          this.addAnalysisLog(`错误: ${errorMessage}`, &#039;error&#039;);</span></pre>
            <pre class="line"><span class="line-number">983</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">984</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">985</span><span class="code-content">        this.$message.error(errorMessage);</span></pre>
            <pre class="line"><span class="line-number">986</span><span class="code-content">        this.loading = false;</span></pre>
            <pre class="line"><span class="line-number">987</span><span class="code-content">        // 停止自动批处理，等待用户手动继续</span></pre>
            <pre class="line"><span class="line-number">988</span><span class="code-content">        this.batchProcessInfo.autoContinue = false;</span></pre>
            <pre class="line"><span class="line-number">989</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">990</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">991</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">992</span><span class="code-content">    // 手动继续处理下一批</span></pre>
            <pre class="line"><span class="line-number">993</span><span class="code-content">    continueNextBatch() {</span></pre>
            <pre class="line"><span class="line-number">994</span><span class="code-content">      if (this.loading) {</span></pre>
            <pre class="line"><span class="line-number">995</span><span class="code-content">        this.$message.warning(&#039;正在分析中，请稍候...&#039;);</span></pre>
            <pre class="line"><span class="line-number">996</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">997</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">998</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">999</span><span class="code-content">      if (this.batchProcessInfo.remainingFiles.length === 0) {</span></pre>
            <pre class="line"><span class="line-number">1000</span><span class="code-content">        this.$message.info(&#039;所有文件已处理完成&#039;);</span></pre>
            <pre class="line"><span class="line-number">1001</span><span class="code-content">        return;</span></pre>
            <pre class="line"><span class="line-number">1002</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1003</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1004</span><span class="code-content">      this.addAnalysisLog(&#039;手动继续处理下一批&#039;, &#039;info&#039;);</span></pre>
            <pre class="line"><span class="line-number">1005</span><span class="code-content">      this.processBatch();</span></pre>
            <pre class="line"><span class="line-number">1006</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1007</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1008</span><span class="code-content">    // 上传并分析文件 (保留以兼容可能的外部调用)</span></pre>
            <pre class="line"><span class="line-number">1009</span><span class="code-content">    async handleUploadAndAnalyze() {</span></pre>
            <pre class="line"><span class="line-number">1010</span><span class="code-content">      this.startBatchAnalysis();</span></pre>
            <pre class="line"><span class="line-number">1011</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1012</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1013</span><span class="code-content">    // 高亮匹配的内容</span></pre>
            <pre class="line"><span class="line-number">1014</span><span class="code-content">    highlightMatch(text, searchTerm) {</span></pre>
            <pre class="line"><span class="line-number">1015</span><span class="code-content">      if (!text || !searchTerm) return text;</span></pre>
            <pre class="line"><span class="line-number">1016</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1017</span><span class="code-content">      // 转义正则表达式中的特殊字符</span></pre>
            <pre class="line"><span class="line-number">1018</span><span class="code-content">      const escapeRegExp = (string) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1019</span><span class="code-content">        return string.replace(/[.*+?^${}()|[\]\\]/g, &#039;\\$&amp;&#039;);</span></pre>
            <pre class="line"><span class="line-number">1020</span><span class="code-content">      };</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 36 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1021</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1022</span><span class="code-content">      // 不区分大小写匹配</span></pre>
            <pre class="line"><span class="line-number">1023</span><span class="code-content">      const regex = new RegExp(escapeRegExp(searchTerm), &#039;gi&#039;);</span></pre>
            <pre class="line"><span class="line-number">1024</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1025</span><span class="code-content">      // 替换为高亮样式，并添加独特的标记以便更容易找到</span></pre>
            <pre class="line"><span class="line-number">1026</span><span class="code-content">      const highlighted = text.replace(regex, match =&gt; </span></pre>
            <pre class="line"><span class="line-number">1027</span><span class="code-content">        `&lt;span class=&quot;highlight&quot; data-match=&quot;${this.lastSearchedContent}&quot;&gt;${match}&lt;/span&gt;`);</span></pre>
            <pre class="line"><span class="line-number">1028</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1029</span><span class="code-content">      return highlighted;</span></pre>
            <pre class="line"><span class="line-number">1030</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1031</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1032</span><span class="code-content">    // 将单元格数组格式化为表格数据</span></pre>
            <pre class="line"><span class="line-number">1033</span><span class="code-content">    formatCellsForTable(cells) {</span></pre>
            <pre class="line"><span class="line-number">1034</span><span class="code-content">      return cells.map((value, index) =&gt; ({</span></pre>
            <pre class="line"><span class="line-number">1035</span><span class="code-content">        column: this.getColumnLetter(index),</span></pre>
            <pre class="line"><span class="line-number">1036</span><span class="code-content">        value: value !== undefined &amp;&amp; value !== null ? String(value) : &#039;&#039;</span></pre>
            <pre class="line"><span class="line-number">1037</span><span class="code-content">      }));</span></pre>
            <pre class="line"><span class="line-number">1038</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1039</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1040</span><span class="code-content">    // 将列索引转换为Excel列字母（A, B, C...AA, AB...）</span></pre>
            <pre class="line"><span class="line-number">1041</span><span class="code-content">    getColumnLetter(index) {</span></pre>
            <pre class="line"><span class="line-number">1042</span><span class="code-content">      let column = &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1043</span><span class="code-content">      let temp = index;</span></pre>
            <pre class="line"><span class="line-number">1044</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1045</span><span class="code-content">      while (temp &gt;= 0) {</span></pre>
            <pre class="line"><span class="line-number">1046</span><span class="code-content">        column = String.fromCharCode(65 + (temp % 26)) + column;</span></pre>
            <pre class="line"><span class="line-number">1047</span><span class="code-content">        temp = Math.floor(temp / 26) - 1;</span></pre>
            <pre class="line"><span class="line-number">1048</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1049</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">1050</span><span class="code-content">      return column;</span></pre>
            <pre class="line"><span class="line-number">1051</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1052</span><span class="code-content">    // 获取总匹配数</span></pre>
            <pre class="line"><span class="line-number">1053</span><span class="code-content">    getTotalMatchCount() {</span></pre>
            <pre class="line"><span class="line-number">1054</span><span class="code-content">      return this.searchResults.reduce((total, file) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1055</span><span class="code-content">        return total + (file.matchedLines ? file.matchedLines.length : 0);</span></pre>
            <pre class="line"><span class="line-number">1056</span><span class="code-content">      }, 0);</span></pre>
            <pre class="line"><span class="line-number">1057</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1058</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1059</span><span class="code-content">    // 展开所有结果</span></pre>
            <pre class="line"><span class="line-number">1060</span><span class="code-content">    expandAllResults() {</span></pre>
            <pre class="line"><span class="line-number">1061</span><span class="code-content">      if (this.searchResults &amp;&amp; this.searchResults.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">1062</span><span class="code-content">        this.searchResults.forEach(file =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1063</span><span class="code-content">          if (file &amp;&amp; file.matchedLines &amp;&amp; file.matchedLines.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">1064</span><span class="code-content">            this.$set(file, &#039;showDetails&#039;, true);</span></pre>
            <pre class="line"><span class="line-number">1065</span><span class="code-content">            // 确保初始化筛选</span></pre>
            <pre class="line"><span class="line-number">1066</span><span class="code-content">            if (!file.hasOwnProperty(&#039;filterText&#039;)) {</span></pre>
            <pre class="line"><span class="line-number">1067</span><span class="code-content">              this.$set(file, &#039;filterText&#039;, &#039;&#039;);</span></pre>
            <pre class="line"><span class="line-number">1068</span><span class="code-content">              this.$set(file, &#039;filteredMatches&#039;, null);</span></pre>
            <pre class="line"><span class="line-number">1069</span><span class="code-content">            }</span></pre>
            <pre class="line"><span class="line-number">1070</span><span class="code-content">          }</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 37 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1071</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1072</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1073</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1074</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1075</span><span class="code-content">    // 收起所有结果</span></pre>
            <pre class="line"><span class="line-number">1076</span><span class="code-content">    collapseAllResults() {</span></pre>
            <pre class="line"><span class="line-number">1077</span><span class="code-content">      if (this.searchResults &amp;&amp; this.searchResults.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">1078</span><span class="code-content">        this.searchResults.forEach(file =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1079</span><span class="code-content">          if (file) {</span></pre>
            <pre class="line"><span class="line-number">1080</span><span class="code-content">            this.$set(file, &#039;showDetails&#039;, false);</span></pre>
            <pre class="line"><span class="line-number">1081</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">1082</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1083</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1084</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1085</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1086</span><span class="code-content">    // 获取API配置</span></pre>
            <pre class="line"><span class="line-number">1087</span><span class="code-content">    async getApiConfig() {</span></pre>
            <pre class="line"><span class="line-number">1088</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">1089</span><span class="code-content">        const response = await axios.get(`${API_BASE_URL}/api/config`);</span></pre>
            <pre class="line"><span class="line-number">1090</span><span class="code-content">        if (response.data &amp;&amp; response.data.config) {</span></pre>
            <pre class="line"><span class="line-number">1091</span><span class="code-content">          this.apiConfig.apiUrl = response.data.config.SOPHNET_API_URL || &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1092</span><span class="code-content">          this.apiConfig.apiKey = response.data.config.SOPHNET_API_KEY || &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1093</span><span class="code-content">          this.apiConfig.model = response.data.config.SOPHNET_MODEL || &#039;DeepSeek-R1&#039;;</span></pre>
            <pre class="line"><span class="line-number">1094</span><span class="code-content">          this.apiConfig.maxTokens = response.data.config.SOPHNET_MAX_TOKENS || 32768;</span></pre>
            <pre class="line"><span class="line-number">1095</span><span class="code-content">          // 清除错误信息</span></pre>
            <pre class="line"><span class="line-number">1096</span><span class="code-content">          this.apiErrorMessage = &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">1097</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">1098</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">1099</span><span class="code-content">        console.error(&#039;获取API配置失败:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1100</span><span class="code-content">        this.$message.error(&#039;获取API配置失败，请检查服务器连接&#039;);</span></pre>
            <pre class="line"><span class="line-number">1101</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1102</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1103</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1104</span><span class="code-content">    // 保存API配置</span></pre>
            <pre class="line"><span class="line-number">1105</span><span class="code-content">    async saveApiConfig() {</span></pre>
            <pre class="line"><span class="line-number">1106</span><span class="code-content">      this.saveConfigLoading = true;</span></pre>
            <pre class="line"><span class="line-number">1107</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">1108</span><span class="code-content">        const response = await axios.post(`${API_BASE_URL}/api/config`, {</span></pre>
            <pre class="line"><span class="line-number">1109</span><span class="code-content">          SOPHNET_API_URL: this.apiConfig.apiUrl,</span></pre>
            <pre class="line"><span class="line-number">1110</span><span class="code-content">          SOPHNET_API_KEY: this.apiConfig.apiKey,</span></pre>
            <pre class="line"><span class="line-number">1111</span><span class="code-content">          SOPHNET_MODEL: this.apiConfig.model,</span></pre>
            <pre class="line"><span class="line-number">1112</span><span class="code-content">          SOPHNET_MAX_TOKENS: this.apiConfig.maxTokens</span></pre>
            <pre class="line"><span class="line-number">1113</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1114</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1115</span><span class="code-content">        if (response.data &amp;&amp; response.data.success) {</span></pre>
            <pre class="line"><span class="line-number">1116</span><span class="code-content">          this.$message.success(&#039;API配置保存成功&#039;);</span></pre>
            <pre class="line"><span class="line-number">1117</span><span class="code-content">          this.showApiConfig = false;</span></pre>
            <pre class="line"><span class="line-number">1118</span><span class="code-content">          // 重新检查服务器连接</span></pre>
            <pre class="line"><span class="line-number">1119</span><span class="code-content">          this.checkServerConnection();</span></pre>
            <pre class="line"><span class="line-number">1120</span><span class="code-content">        } else {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 38 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1121</span><span class="code-content">          this.$message.error(&#039;保存失败: &#039; + (response.data.error || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1122</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">1123</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">1124</span><span class="code-content">        console.error(&#039;保存API配置失败:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1125</span><span class="code-content">        this.$message.error(&#039;保存API配置失败: &#039; + (error.response?.data?.error || error.message || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1126</span><span class="code-content">      } finally {</span></pre>
            <pre class="line"><span class="line-number">1127</span><span class="code-content">        this.saveConfigLoading = false;</span></pre>
            <pre class="line"><span class="line-number">1128</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1129</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1130</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1131</span><span class="code-content">    // 测试API连接</span></pre>
            <pre class="line"><span class="line-number">1132</span><span class="code-content">    async testApiConnection() {</span></pre>
            <pre class="line"><span class="line-number">1133</span><span class="code-content">      this.testApiLoading = true;</span></pre>
            <pre class="line"><span class="line-number">1134</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">1135</span><span class="code-content">        const response = await axios.post(`${API_BASE_URL}/api/test-connection`, {</span></pre>
            <pre class="line"><span class="line-number">1136</span><span class="code-content">          SOPHNET_API_URL: this.apiConfig.apiUrl,</span></pre>
            <pre class="line"><span class="line-number">1137</span><span class="code-content">          SOPHNET_API_KEY: this.apiConfig.apiKey,</span></pre>
            <pre class="line"><span class="line-number">1138</span><span class="code-content">          SOPHNET_MODEL: this.apiConfig.model</span></pre>
            <pre class="line"><span class="line-number">1139</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1140</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1141</span><span class="code-content">        if (response.data &amp;&amp; response.data.success) {</span></pre>
            <pre class="line"><span class="line-number">1142</span><span class="code-content">          this.$message.success(&#039;API连接测试成功!&#039;);</span></pre>
            <pre class="line"><span class="line-number">1143</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">1144</span><span class="code-content">          this.$message.error(&#039;API连接测试失败: &#039; + (response.data.error || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1145</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">1146</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">1147</span><span class="code-content">        console.error(&#039;API连接测试失败:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1148</span><span class="code-content">        this.$message.error(&#039;API连接测试失败: &#039; + (error.response?.data?.error || error.message || &#039;未知错误&#039;));</span></pre>
            <pre class="line"><span class="line-number">1149</span><span class="code-content">      } finally {</span></pre>
            <pre class="line"><span class="line-number">1150</span><span class="code-content">        this.testApiLoading = false;</span></pre>
            <pre class="line"><span class="line-number">1151</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">1152</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1153</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1154</span><span class="code-content">    // 对话框打开时的处理</span></pre>
            <pre class="line"><span class="line-number">1155</span><span class="code-content">    onConfigDialogOpen() {</span></pre>
            <pre class="line"><span class="line-number">1156</span><span class="code-content">      // 备份原始配置用于重置</span></pre>
            <pre class="line"><span class="line-number">1157</span><span class="code-content">      this.originalApiConfig = { ...this.apiConfig };</span></pre>
            <pre class="line"><span class="line-number">1158</span><span class="code-content">      // 默认隐藏API密钥</span></pre>
            <pre class="line"><span class="line-number">1159</span><span class="code-content">      this.showApiKey = false;</span></pre>
            <pre class="line"><span class="line-number">1160</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1161</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1162</span><span class="code-content">    // 重置API配置</span></pre>
            <pre class="line"><span class="line-number">1163</span><span class="code-content">    resetApiConfig() {</span></pre>
            <pre class="line"><span class="line-number">1164</span><span class="code-content">      this.apiConfig = { ...this.originalApiConfig };</span></pre>
            <pre class="line"><span class="line-number">1165</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1166</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1167</span><span class="code-content">    // 添加分析日志</span></pre>
            <pre class="line"><span class="line-number">1168</span><span class="code-content">    addAnalysisLog(message, type = &#039;info&#039;) {</span></pre>
            <pre class="line"><span class="line-number">1169</span><span class="code-content">      const now = new Date();</span></pre>
            <pre class="line"><span class="line-number">1170</span><span class="code-content">      const timeStr = `${now.getHours().toString().padStart(2, &#039;0&#039;)}:${now.getMinutes().toString().padStart(2, &#039;0&#039;)}:${now.getSeconds().toString().padStart(2, &#039;0&#039;)}`;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 39 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1171</span><span class="code-content">      this.analysisLogs.push({</span></pre>
            <pre class="line"><span class="line-number">1172</span><span class="code-content">        time: timeStr,</span></pre>
            <pre class="line"><span class="line-number">1173</span><span class="code-content">        message,</span></pre>
            <pre class="line"><span class="line-number">1174</span><span class="code-content">        type</span></pre>
            <pre class="line"><span class="line-number">1175</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">1176</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1177</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1178</span><span class="code-content">    // 清除分析日志</span></pre>
            <pre class="line"><span class="line-number">1179</span><span class="code-content">    clearAnalysisLogs() {</span></pre>
            <pre class="line"><span class="line-number">1180</span><span class="code-content">      this.analysisLogs = [];</span></pre>
            <pre class="line"><span class="line-number">1181</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1182</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1183</span><span class="code-content">    // 显示完整匹配内容</span></pre>
            <pre class="line"><span class="line-number">1184</span><span class="code-content">    showFullContent(match) {</span></pre>
            <pre class="line"><span class="line-number">1185</span><span class="code-content">      this.fullContentDialog.match = match;</span></pre>
            <pre class="line"><span class="line-number">1186</span><span class="code-content">      this.fullContentDialog.visible = true;</span></pre>
            <pre class="line"><span class="line-number">1187</span><span class="code-content">    },</span></pre>
            <pre class="line"><span class="line-number">1188</span><span class="code-content">  },</span></pre>
            <pre class="line"><span class="line-number">1189</span><span class="code-content">  beforeDestroy() {</span></pre>
            <pre class="line"><span class="line-number">1190</span><span class="code-content">    // 这个钩子中不再需要关闭EventSource，因为我们已经不使用SSE了</span></pre>
            <pre class="line"><span class="line-number">1191</span><span class="code-content">  }</span></pre>
            <pre class="line"><span class="line-number">1192</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1193</span><span class="code-content">&lt;/script&gt;</span></pre>
            <pre class="line"><span class="line-number">1194</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1195</span><span class="code-content">&lt;style scoped&gt;</span></pre>
            <pre class="line"><span class="line-number">1196</span><span class="code-content">.excel-content-finder {</span></pre>
            <pre class="line"><span class="line-number">1197</span><span class="code-content">  padding: 20px;</span></pre>
            <pre class="line"><span class="line-number">1198</span><span class="code-content">  max-width: 900px;</span></pre>
            <pre class="line"><span class="line-number">1199</span><span class="code-content">  margin: 0 auto;</span></pre>
            <pre class="line"><span class="line-number">1200</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1201</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1202</span><span class="code-content">.server-status-container {</span></pre>
            <pre class="line"><span class="line-number">1203</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1204</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1205</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1206</span><span class="code-content">  position: relative;</span></pre>
            <pre class="line"><span class="line-number">1207</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1208</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1209</span><span class="code-content">.server-status {</span></pre>
            <pre class="line"><span class="line-number">1210</span><span class="code-content">  flex: 1;</span></pre>
            <pre class="line"><span class="line-number">1211</span><span class="code-content">  padding: 10px;</span></pre>
            <pre class="line"><span class="line-number">1212</span><span class="code-content">  background-color: #f56c6c;</span></pre>
            <pre class="line"><span class="line-number">1213</span><span class="code-content">  color: white;</span></pre>
            <pre class="line"><span class="line-number">1214</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1215</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1216</span><span class="code-content">  transition: background-color 0.3s ease;</span></pre>
            <pre class="line"><span class="line-number">1217</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1218</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1219</span><span class="code-content">.server-status.connected {</span></pre>
            <pre class="line"><span class="line-number">1220</span><span class="code-content">  background-color: #67c23a;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 40 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1221</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1222</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1223</span><span class="code-content">.analysis-method-info {</span></pre>
            <pre class="line"><span class="line-number">1224</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1225</span><span class="code-content">  border: 1px solid #e6e6e6;</span></pre>
            <pre class="line"><span class="line-number">1226</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1227</span><span class="code-content">  overflow: hidden;</span></pre>
            <pre class="line"><span class="line-number">1228</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1229</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1230</span><span class="code-content">.folder-selection-section {</span></pre>
            <pre class="line"><span class="line-number">1231</span><span class="code-content">  margin-bottom: 15px;</span></pre>
            <pre class="line"><span class="line-number">1232</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1233</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1234</span><span class="code-content">  gap: 15px;</span></pre>
            <pre class="line"><span class="line-number">1235</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1236</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1237</span><span class="code-content">.selected-files-info {</span></pre>
            <pre class="line"><span class="line-number">1238</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1239</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1240</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1241</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1242</span><span class="code-content">.search-section {</span></pre>
            <pre class="line"><span class="line-number">1243</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1244</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1245</span><span class="code-content">  gap: 10px;</span></pre>
            <pre class="line"><span class="line-number">1246</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1247</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1248</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1249</span><span class="code-content">.search-input {</span></pre>
            <pre class="line"><span class="line-number">1250</span><span class="code-content">  flex: 1;</span></pre>
            <pre class="line"><span class="line-number">1251</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1252</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1253</span><span class="code-content">.file-list-section {</span></pre>
            <pre class="line"><span class="line-number">1254</span><span class="code-content">  margin-bottom: 20px;</span></pre>
            <pre class="line"><span class="line-number">1255</span><span class="code-content">  border: 1px solid #ebeef5;</span></pre>
            <pre class="line"><span class="line-number">1256</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1257</span><span class="code-content">  padding: 10px;</span></pre>
            <pre class="line"><span class="line-number">1258</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1259</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1260</span><span class="code-content">.status-section {</span></pre>
            <pre class="line"><span class="line-number">1261</span><span class="code-content">  margin: 20px 0;</span></pre>
            <pre class="line"><span class="line-number">1262</span><span class="code-content">  padding: 0;</span></pre>
            <pre class="line"><span class="line-number">1263</span><span class="code-content">  border: 1px solid #dcdfe6;</span></pre>
            <pre class="line"><span class="line-number">1264</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1265</span><span class="code-content">  background-color: #fff;</span></pre>
            <pre class="line"><span class="line-number">1266</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1267</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1268</span><span class="code-content">.status-section p {</span></pre>
            <pre class="line"><span class="line-number">1269</span><span class="code-content">  margin: 0 0 10px 0;</span></pre>
            <pre class="line"><span class="line-number">1270</span><span class="code-content">  font-weight: bold;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 41 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1271</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1272</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1273</span><span class="code-content">.results-section {</span></pre>
            <pre class="line"><span class="line-number">1274</span><span class="code-content">  margin-top: 20px;</span></pre>
            <pre class="line"><span class="line-number">1275</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1276</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1277</span><span class="code-content">.no-results {</span></pre>
            <pre class="line"><span class="line-number">1278</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1279</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1280</span><span class="code-content">  margin-top: 30px;</span></pre>
            <pre class="line"><span class="line-number">1281</span><span class="code-content">  padding: 20px;</span></pre>
            <pre class="line"><span class="line-number">1282</span><span class="code-content">  border: 1px dashed #dcdfe6;</span></pre>
            <pre class="line"><span class="line-number">1283</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1284</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1285</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1286</span><span class="code-content">:deep(.el-table .el-progress__text) {</span></pre>
            <pre class="line"><span class="line-number">1287</span><span class="code-content">  font-size: 12px !important;</span></pre>
            <pre class="line"><span class="line-number">1288</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1289</span><span class="code-content">:deep(.el-table .el-progress-bar) {</span></pre>
            <pre class="line"><span class="line-number">1290</span><span class="code-content">  padding-right: 50px;</span></pre>
            <pre class="line"><span class="line-number">1291</span><span class="code-content">  margin-right: -50px;</span></pre>
            <pre class="line"><span class="line-number">1292</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1293</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1294</span><span class="code-content">.small-text {</span></pre>
            <pre class="line"><span class="line-number">1295</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1296</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1297</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1298</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1299</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1300</span><span class="code-content">.match-summary {</span></pre>
            <pre class="line"><span class="line-number">1301</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1302</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1303</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1304</span><span class="code-content">  margin-bottom: 5px;</span></pre>
            <pre class="line"><span class="line-number">1305</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1306</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1307</span><span class="code-content">.match-count {</span></pre>
            <pre class="line"><span class="line-number">1308</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1309</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1310</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1311</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1312</span><span class="code-content">.toggle-btn {</span></pre>
            <pre class="line"><span class="line-number">1313</span><span class="code-content">  padding: 0;</span></pre>
            <pre class="line"><span class="line-number">1314</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1315</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1316</span><span class="code-content">.matched-lines {</span></pre>
            <pre class="line"><span class="line-number">1317</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1318</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1319</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1320</span><span class="code-content">.match-card {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 42 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1321</span><span class="code-content">  margin-bottom: 16px;</span></pre>
            <pre class="line"><span class="line-number">1322</span><span class="code-content">  max-width: 100%;</span></pre>
            <pre class="line"><span class="line-number">1323</span><span class="code-content">  overflow: hidden;</span></pre>
            <pre class="line"><span class="line-number">1324</span><span class="code-content">  border: 1px solid #dcdfe6;</span></pre>
            <pre class="line"><span class="line-number">1325</span><span class="code-content">  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);</span></pre>
            <pre class="line"><span class="line-number">1326</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1327</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1328</span><span class="code-content">.match-card :deep(.el-card__header) {</span></pre>
            <pre class="line"><span class="line-number">1329</span><span class="code-content">  padding: 12px 15px;</span></pre>
            <pre class="line"><span class="line-number">1330</span><span class="code-content">  background-color: #f6f8fa;</span></pre>
            <pre class="line"><span class="line-number">1331</span><span class="code-content">  font-size: 13px;</span></pre>
            <pre class="line"><span class="line-number">1332</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1333</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1334</span><span class="code-content">.match-card :deep(.el-card__body) {</span></pre>
            <pre class="line"><span class="line-number">1335</span><span class="code-content">  padding: 15px;</span></pre>
            <pre class="line"><span class="line-number">1336</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1337</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1338</span><span class="code-content">.match-header {</span></pre>
            <pre class="line"><span class="line-number">1339</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1340</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1341</span><span class="code-content">  font-size: 13px;</span></pre>
            <pre class="line"><span class="line-number">1342</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1343</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1344</span><span class="code-content">.sheet-name {</span></pre>
            <pre class="line"><span class="line-number">1345</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1346</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1347</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1348</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1349</span><span class="code-content">.row-number {</span></pre>
            <pre class="line"><span class="line-number">1350</span><span class="code-content">  color: #606266;</span></pre>
            <pre class="line"><span class="line-number">1351</span><span class="code-content">  font-weight: normal;</span></pre>
            <pre class="line"><span class="line-number">1352</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1353</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1354</span><span class="code-content">/* 单元格详情表格样式 */</span></pre>
            <pre class="line"><span class="line-number">1355</span><span class="code-content">.cell-details {</span></pre>
            <pre class="line"><span class="line-number">1356</span><span class="code-content">  margin-top: 15px;</span></pre>
            <pre class="line"><span class="line-number">1357</span><span class="code-content">  border-top: 1px solid #ebeef5;</span></pre>
            <pre class="line"><span class="line-number">1358</span><span class="code-content">  padding-top: 12px;</span></pre>
            <pre class="line"><span class="line-number">1359</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1360</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1361</span><span class="code-content">.cell-details-header {</span></pre>
            <pre class="line"><span class="line-number">1362</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1363</span><span class="code-content">  margin-bottom: 8px;</span></pre>
            <pre class="line"><span class="line-number">1364</span><span class="code-content">  font-size: 13px;</span></pre>
            <pre class="line"><span class="line-number">1365</span><span class="code-content">  color: #303133;</span></pre>
            <pre class="line"><span class="line-number">1366</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1367</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1368</span><span class="code-content">.cell-details .el-table {</span></pre>
            <pre class="line"><span class="line-number">1369</span><span class="code-content">  margin-top: 8px;</span></pre>
            <pre class="line"><span class="line-number">1370</span><span class="code-content">  border-radius: 4px;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 43 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1371</span><span class="code-content">  overflow: hidden;</span></pre>
            <pre class="line"><span class="line-number">1372</span><span class="code-content">  max-height: none;</span></pre>
            <pre class="line"><span class="line-number">1373</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1374</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1375</span><span class="code-content">.cell-details .el-table :deep(th) {</span></pre>
            <pre class="line"><span class="line-number">1376</span><span class="code-content">  background-color: #f5f7fa;</span></pre>
            <pre class="line"><span class="line-number">1377</span><span class="code-content">  color: #606266;</span></pre>
            <pre class="line"><span class="line-number">1378</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1379</span><span class="code-content">  padding: 8px 12px;</span></pre>
            <pre class="line"><span class="line-number">1380</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1381</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1382</span><span class="code-content">.cell-details .el-table :deep(td) {</span></pre>
            <pre class="line"><span class="line-number">1383</span><span class="code-content">  padding: 8px 12px;</span></pre>
            <pre class="line"><span class="line-number">1384</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1385</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1386</span><span class="code-content">/* 确保单元格内容完整显示 */</span></pre>
            <pre class="line"><span class="line-number">1387</span><span class="code-content">.cell-details .el-table :deep(.cell) {</span></pre>
            <pre class="line"><span class="line-number">1388</span><span class="code-content">  word-break: break-word;</span></pre>
            <pre class="line"><span class="line-number">1389</span><span class="code-content">  line-height: 1.5;</span></pre>
            <pre class="line"><span class="line-number">1390</span><span class="code-content">  min-height: 20px;</span></pre>
            <pre class="line"><span class="line-number">1391</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1392</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1393</span><span class="code-content">.batch-actions {</span></pre>
            <pre class="line"><span class="line-number">1394</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1395</span><span class="code-content">  margin-bottom: 15px;</span></pre>
            <pre class="line"><span class="line-number">1396</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1397</span><span class="code-content">  gap: 10px;</span></pre>
            <pre class="line"><span class="line-number">1398</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1399</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1400</span><span class="code-content">.match-total {</span></pre>
            <pre class="line"><span class="line-number">1401</span><span class="code-content">  margin-left: auto;</span></pre>
            <pre class="line"><span class="line-number">1402</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1403</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1404</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1405</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1406</span><span class="code-content">.match-filter {</span></pre>
            <pre class="line"><span class="line-number">1407</span><span class="code-content">  margin-bottom: 10px;</span></pre>
            <pre class="line"><span class="line-number">1408</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1409</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1410</span><span class="code-content">.no-filter-matches {</span></pre>
            <pre class="line"><span class="line-number">1411</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1412</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1413</span><span class="code-content">  padding: 10px;</span></pre>
            <pre class="line"><span class="line-number">1414</span><span class="code-content">  font-style: italic;</span></pre>
            <pre class="line"><span class="line-number">1415</span><span class="code-content">  background-color: #f9f9f9;</span></pre>
            <pre class="line"><span class="line-number">1416</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1417</span><span class="code-content">  margin-bottom: 10px;</span></pre>
            <pre class="line"><span class="line-number">1418</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1419</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1420</span><span class="code-content">.error-details {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 44 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1421</span><span class="code-content">  font-family: monospace;</span></pre>
            <pre class="line"><span class="line-number">1422</span><span class="code-content">  margin-top: 8px;</span></pre>
            <pre class="line"><span class="line-number">1423</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1424</span><span class="code-content">  white-space: pre-wrap;</span></pre>
            <pre class="line"><span class="line-number">1425</span><span class="code-content">  word-break: break-word;</span></pre>
            <pre class="line"><span class="line-number">1426</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1427</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1428</span><span class="code-content">.api-config-button {</span></pre>
            <pre class="line"><span class="line-number">1429</span><span class="code-content">  position: absolute;</span></pre>
            <pre class="line"><span class="line-number">1430</span><span class="code-content">  right: -15px;</span></pre>
            <pre class="line"><span class="line-number">1431</span><span class="code-content">  top: 50%;</span></pre>
            <pre class="line"><span class="line-number">1432</span><span class="code-content">  transform: translateY(-50%);</span></pre>
            <pre class="line"><span class="line-number">1433</span><span class="code-content">  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);</span></pre>
            <pre class="line"><span class="line-number">1434</span><span class="code-content">  z-index: 1;</span></pre>
            <pre class="line"><span class="line-number">1435</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1436</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1437</span><span class="code-content">.form-tip {</span></pre>
            <pre class="line"><span class="line-number">1438</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1439</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1440</span><span class="code-content">  line-height: 1.2;</span></pre>
            <pre class="line"><span class="line-number">1441</span><span class="code-content">  padding: 2px 0;</span></pre>
            <pre class="line"><span class="line-number">1442</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1443</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1444</span><span class="code-content">.analysis-logs {</span></pre>
            <pre class="line"><span class="line-number">1445</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1446</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1447</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1448</span><span class="code-content">.log-header {</span></pre>
            <pre class="line"><span class="line-number">1449</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1450</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1451</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1452</span><span class="code-content">  margin-bottom: 5px;</span></pre>
            <pre class="line"><span class="line-number">1453</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1454</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1455</span><span class="code-content">.log-container {</span></pre>
            <pre class="line"><span class="line-number">1456</span><span class="code-content">  max-height: 200px;</span></pre>
            <pre class="line"><span class="line-number">1457</span><span class="code-content">  overflow-y: auto;</span></pre>
            <pre class="line"><span class="line-number">1458</span><span class="code-content">  border: 1px solid #EBEEF5;</span></pre>
            <pre class="line"><span class="line-number">1459</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1460</span><span class="code-content">  padding: 8px;</span></pre>
            <pre class="line"><span class="line-number">1461</span><span class="code-content">  background-color: #FAFAFA;</span></pre>
            <pre class="line"><span class="line-number">1462</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1463</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1464</span><span class="code-content">.log-item {</span></pre>
            <pre class="line"><span class="line-number">1465</span><span class="code-content">  margin-bottom: 5px;</span></pre>
            <pre class="line"><span class="line-number">1466</span><span class="code-content">  padding: 4px 0;</span></pre>
            <pre class="line"><span class="line-number">1467</span><span class="code-content">  border-bottom: 1px dashed #EBEEF5;</span></pre>
            <pre class="line"><span class="line-number">1468</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1469</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1470</span><span class="code-content">.log-time {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 45 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1471</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1472</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1473</span><span class="code-content">  margin-right: 8px;</span></pre>
            <pre class="line"><span class="line-number">1474</span><span class="code-content">  display: inline-block;</span></pre>
            <pre class="line"><span class="line-number">1475</span><span class="code-content">  width: 80px;</span></pre>
            <pre class="line"><span class="line-number">1476</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1477</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1478</span><span class="code-content">.log-message {</span></pre>
            <pre class="line"><span class="line-number">1479</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1480</span><span class="code-content">  color: #606266;</span></pre>
            <pre class="line"><span class="line-number">1481</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1482</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1483</span><span class="code-content">.log-error {</span></pre>
            <pre class="line"><span class="line-number">1484</span><span class="code-content">  color: #F56C6C;</span></pre>
            <pre class="line"><span class="line-number">1485</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1486</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1487</span><span class="code-content">.log-error .log-time {</span></pre>
            <pre class="line"><span class="line-number">1488</span><span class="code-content">  color: #F56C6C;</span></pre>
            <pre class="line"><span class="line-number">1489</span><span class="code-content">  opacity: 0.8;</span></pre>
            <pre class="line"><span class="line-number">1490</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1491</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1492</span><span class="code-content">.log-success {</span></pre>
            <pre class="line"><span class="line-number">1493</span><span class="code-content">  color: #67C23A;</span></pre>
            <pre class="line"><span class="line-number">1494</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1495</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1496</span><span class="code-content">.log-success .log-time {</span></pre>
            <pre class="line"><span class="line-number">1497</span><span class="code-content">  color: #67C23A;</span></pre>
            <pre class="line"><span class="line-number">1498</span><span class="code-content">  opacity: 0.8;</span></pre>
            <pre class="line"><span class="line-number">1499</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1500</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1501</span><span class="code-content">.api-skipped-tag {</span></pre>
            <pre class="line"><span class="line-number">1502</span><span class="code-content">  margin-top: 2px;</span></pre>
            <pre class="line"><span class="line-number">1503</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1504</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1505</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1506</span><span class="code-content">.api-skipped-tag .el-tag {</span></pre>
            <pre class="line"><span class="line-number">1507</span><span class="code-content">  font-size: 10px;</span></pre>
            <pre class="line"><span class="line-number">1508</span><span class="code-content">  padding: 0 4px;</span></pre>
            <pre class="line"><span class="line-number">1509</span><span class="code-content">  height: 16px;</span></pre>
            <pre class="line"><span class="line-number">1510</span><span class="code-content">  line-height: 14px;</span></pre>
            <pre class="line"><span class="line-number">1511</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1512</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1513</span><span class="code-content">.batch-process-info {</span></pre>
            <pre class="line"><span class="line-number">1514</span><span class="code-content">  margin: 20px 0;</span></pre>
            <pre class="line"><span class="line-number">1515</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1516</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1517</span><span class="code-content">.batch-process-stats {</span></pre>
            <pre class="line"><span class="line-number">1518</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1519</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1520</span><span class="code-content">  align-items: center;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 46 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1521</span><span class="code-content">  margin-top: 8px;</span></pre>
            <pre class="line"><span class="line-number">1522</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1523</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1524</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1525</span><span class="code-content">.relevance-explanation {</span></pre>
            <pre class="line"><span class="line-number">1526</span><span class="code-content">  margin-bottom: 10px;</span></pre>
            <pre class="line"><span class="line-number">1527</span><span class="code-content">  font-style: italic;</span></pre>
            <pre class="line"><span class="line-number">1528</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1529</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1530</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1531</span><span class="code-content">.api-warning-tag {</span></pre>
            <pre class="line"><span class="line-number">1532</span><span class="code-content">  margin-top: 2px;</span></pre>
            <pre class="line"><span class="line-number">1533</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1534</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1535</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1536</span><span class="code-content">.api-warning-tag .el-tag {</span></pre>
            <pre class="line"><span class="line-number">1537</span><span class="code-content">  font-size: 10px;</span></pre>
            <pre class="line"><span class="line-number">1538</span><span class="code-content">  padding: 0 4px;</span></pre>
            <pre class="line"><span class="line-number">1539</span><span class="code-content">  height: 16px;</span></pre>
            <pre class="line"><span class="line-number">1540</span><span class="code-content">  line-height: 14px;</span></pre>
            <pre class="line"><span class="line-number">1541</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1542</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1543</span><span class="code-content">.score-tags {</span></pre>
            <pre class="line"><span class="line-number">1544</span><span class="code-content">  margin-top: 2px;</span></pre>
            <pre class="line"><span class="line-number">1545</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1546</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1547</span><span class="code-content">  justify-content: center;</span></pre>
            <pre class="line"><span class="line-number">1548</span><span class="code-content">  gap: 4px;</span></pre>
            <pre class="line"><span class="line-number">1549</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1550</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1551</span><span class="code-content">.score-tags .el-tag {</span></pre>
            <pre class="line"><span class="line-number">1552</span><span class="code-content">  font-size: 10px;</span></pre>
            <pre class="line"><span class="line-number">1553</span><span class="code-content">  padding: 0 4px;</span></pre>
            <pre class="line"><span class="line-number">1554</span><span class="code-content">  height: 16px;</span></pre>
            <pre class="line"><span class="line-number">1555</span><span class="code-content">  line-height: 14px;</span></pre>
            <pre class="line"><span class="line-number">1556</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1557</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1558</span><span class="code-content">.advanced-options {</span></pre>
            <pre class="line"><span class="line-number">1559</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1560</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1561</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1562</span><span class="code-content">.pagination-control {</span></pre>
            <pre class="line"><span class="line-number">1563</span><span class="code-content">  margin: 10px 0;</span></pre>
            <pre class="line"><span class="line-number">1564</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1565</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1566</span><span class="code-content">  align-items: center;</span></pre>
            <pre class="line"><span class="line-number">1567</span><span class="code-content">  flex-wrap: wrap;</span></pre>
            <pre class="line"><span class="line-number">1568</span><span class="code-content">  background-color: #f8f8f8;</span></pre>
            <pre class="line"><span class="line-number">1569</span><span class="code-content">  padding: 8px;</span></pre>
            <pre class="line"><span class="line-number">1570</span><span class="code-content">  border-radius: 4px;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 47 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1571</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1572</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1573</span><span class="code-content">.pagination-control.top {</span></pre>
            <pre class="line"><span class="line-number">1574</span><span class="code-content">  margin-bottom: 15px;</span></pre>
            <pre class="line"><span class="line-number">1575</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1576</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1577</span><span class="code-content">.pagination-control.bottom {</span></pre>
            <pre class="line"><span class="line-number">1578</span><span class="code-content">  margin-top: 15px;</span></pre>
            <pre class="line"><span class="line-number">1579</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1580</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1581</span><span class="code-content">.pagination-info {</span></pre>
            <pre class="line"><span class="line-number">1582</span><span class="code-content">  font-size: 12px;</span></pre>
            <pre class="line"><span class="line-number">1583</span><span class="code-content">  color: #606266;</span></pre>
            <pre class="line"><span class="line-number">1584</span><span class="code-content">  padding: 0 10px;</span></pre>
            <pre class="line"><span class="line-number">1585</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1586</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1587</span><span class="code-content">.el-pagination {</span></pre>
            <pre class="line"><span class="line-number">1588</span><span class="code-content">  padding: 0;</span></pre>
            <pre class="line"><span class="line-number">1589</span><span class="code-content">  margin: 0;</span></pre>
            <pre class="line"><span class="line-number">1590</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1591</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1592</span><span class="code-content">.match-content-wrapper {</span></pre>
            <pre class="line"><span class="line-number">1593</span><span class="code-content">  margin-bottom: 15px;</span></pre>
            <pre class="line"><span class="line-number">1594</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1595</span><span class="code-content">  overflow: hidden;</span></pre>
            <pre class="line"><span class="line-number">1596</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1597</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1598</span><span class="code-content">.match-content {</span></pre>
            <pre class="line"><span class="line-number">1599</span><span class="code-content">  white-space: pre-wrap;</span></pre>
            <pre class="line"><span class="line-number">1600</span><span class="code-content">  word-break: break-word;</span></pre>
            <pre class="line"><span class="line-number">1601</span><span class="code-content">  font-family: &#039;Consolas&#039;, monospace;</span></pre>
            <pre class="line"><span class="line-number">1602</span><span class="code-content">  font-size: 13px;</span></pre>
            <pre class="line"><span class="line-number">1603</span><span class="code-content">  background-color: #f9f9f9;</span></pre>
            <pre class="line"><span class="line-number">1604</span><span class="code-content">  padding: 15px;</span></pre>
            <pre class="line"><span class="line-number">1605</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1606</span><span class="code-content">  line-height: 1.6;</span></pre>
            <pre class="line"><span class="line-number">1607</span><span class="code-content">  border: 1px solid #e0e0e0;</span></pre>
            <pre class="line"><span class="line-number">1608</span><span class="code-content">  color: #303133;</span></pre>
            <pre class="line"><span class="line-number">1609</span><span class="code-content">  min-height: 40px;</span></pre>
            <pre class="line"><span class="line-number">1610</span><span class="code-content">  position: relative;</span></pre>
            <pre class="line"><span class="line-number">1611</span><span class="code-content">  overflow: visible; /* 允许内容溢出显示，不截断 */</span></pre>
            <pre class="line"><span class="line-number">1612</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1613</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1614</span><span class="code-content">.no-matches {</span></pre>
            <pre class="line"><span class="line-number">1615</span><span class="code-content">  color: #909399;</span></pre>
            <pre class="line"><span class="line-number">1616</span><span class="code-content">  font-style: italic;</span></pre>
            <pre class="line"><span class="line-number">1617</span><span class="code-content">  padding: 10px;</span></pre>
            <pre class="line"><span class="line-number">1618</span><span class="code-content">  text-align: center;</span></pre>
            <pre class="line"><span class="line-number">1619</span><span class="code-content">  background-color: #f9f9f9;</span></pre>
            <pre class="line"><span class="line-number">1620</span><span class="code-content">  border-radius: 4px;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 48 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1621</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1622</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1623</span><span class="code-content">:deep(.highlight) {</span></pre>
            <pre class="line"><span class="line-number">1624</span><span class="code-content">  background-color: #ffef40;</span></pre>
            <pre class="line"><span class="line-number">1625</span><span class="code-content">  padding: 2px 4px;</span></pre>
            <pre class="line"><span class="line-number">1626</span><span class="code-content">  border-radius: 2px;</span></pre>
            <pre class="line"><span class="line-number">1627</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1628</span><span class="code-content">  color: #d32f2f;</span></pre>
            <pre class="line"><span class="line-number">1629</span><span class="code-content">  box-shadow: 0 0 4px rgba(0, 0, 0, 0.2);</span></pre>
            <pre class="line"><span class="line-number">1630</span><span class="code-content">  position: relative;</span></pre>
            <pre class="line"><span class="line-number">1631</span><span class="code-content">  display: inline-block;</span></pre>
            <pre class="line"><span class="line-number">1632</span><span class="code-content">  z-index: 2;</span></pre>
            <pre class="line"><span class="line-number">1633</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1634</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1635</span><span class="code-content">.content-actions {</span></pre>
            <pre class="line"><span class="line-number">1636</span><span class="code-content">  margin-top: 10px;</span></pre>
            <pre class="line"><span class="line-number">1637</span><span class="code-content">  text-align: right;</span></pre>
            <pre class="line"><span class="line-number">1638</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1639</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1640</span><span class="code-content">.full-content-wrapper {</span></pre>
            <pre class="line"><span class="line-number">1641</span><span class="code-content">  padding: 15px;</span></pre>
            <pre class="line"><span class="line-number">1642</span><span class="code-content">  background-color: #f8f8f8;</span></pre>
            <pre class="line"><span class="line-number">1643</span><span class="code-content">  border-radius: 4px;</span></pre>
            <pre class="line"><span class="line-number">1644</span><span class="code-content">  border: 1px solid #e0e0e0;</span></pre>
            <pre class="line"><span class="line-number">1645</span><span class="code-content">  margin-bottom: 15px;</span></pre>
            <pre class="line"><span class="line-number">1646</span><span class="code-content">  white-space: pre-wrap;</span></pre>
            <pre class="line"><span class="line-number">1647</span><span class="code-content">  word-break: break-word;</span></pre>
            <pre class="line"><span class="line-number">1648</span><span class="code-content">  font-family: &#039;Consolas&#039;, monospace;</span></pre>
            <pre class="line"><span class="line-number">1649</span><span class="code-content">  font-size: 14px;</span></pre>
            <pre class="line"><span class="line-number">1650</span><span class="code-content">  line-height: 1.6;</span></pre>
            <pre class="line"><span class="line-number">1651</span><span class="code-content">  color: #303133;</span></pre>
            <pre class="line"><span class="line-number">1652</span><span class="code-content">  max-height: 400px;</span></pre>
            <pre class="line"><span class="line-number">1653</span><span class="code-content">  overflow-y: auto;</span></pre>
            <pre class="line"><span class="line-number">1654</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1655</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1656</span><span class="code-content">.sheet-info {</span></pre>
            <pre class="line"><span class="line-number">1657</span><span class="code-content">  margin-bottom: 10px;</span></pre>
            <pre class="line"><span class="line-number">1658</span><span class="code-content">  display: flex;</span></pre>
            <pre class="line"><span class="line-number">1659</span><span class="code-content">  justify-content: space-between;</span></pre>
            <pre class="line"><span class="line-number">1660</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1661</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1662</span><span class="code-content">.sheet-name-full {</span></pre>
            <pre class="line"><span class="line-number">1663</span><span class="code-content">  font-weight: bold;</span></pre>
            <pre class="line"><span class="line-number">1664</span><span class="code-content">  color: #409EFF;</span></pre>
            <pre class="line"><span class="line-number">1665</span><span class="code-content">  font-size: 14px;</span></pre>
            <pre class="line"><span class="line-number">1666</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1667</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1668</span><span class="code-content">.row-number-full {</span></pre>
            <pre class="line"><span class="line-number">1669</span><span class="code-content">  color: #606266;</span></pre>
            <pre class="line"><span class="line-number">1670</span><span class="code-content">}</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 49 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1671</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1672</span><span class="code-content">.cell-details-full {</span></pre>
            <pre class="line"><span class="line-number">1673</span><span class="code-content">  margin-top: 20px;</span></pre>
            <pre class="line"><span class="line-number">1674</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1675</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1676</span><span class="code-content">:deep(.full-content-dialog .el-dialog__body) {</span></pre>
            <pre class="line"><span class="line-number">1677</span><span class="code-content">  padding: 20px;</span></pre>
            <pre class="line"><span class="line-number">1678</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1679</span><span class="code-content">&lt;/style&gt; </span></pre>
            <pre class="line"><span class="line-number">1680</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1681</span><span class="code-content">// restructure/server/app.js</span></pre>
            <pre class="line"><span class="line-number">1682</span><span class="code-content">/**</span></pre>
            <pre class="line"><span class="line-number">1683</span><span class="code-content"> * Express应用程序主文件</span></pre>
            <pre class="line"><span class="line-number">1684</span><span class="code-content"> * 负责配置和启动Express服务器</span></pre>
            <pre class="line"><span class="line-number">1685</span><span class="code-content"> */</span></pre>
            <pre class="line"><span class="line-number">1686</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1687</span><span class="code-content">const express = require(&#039;express&#039;);</span></pre>
            <pre class="line"><span class="line-number">1688</span><span class="code-content">const cors = require(&#039;cors&#039;);</span></pre>
            <pre class="line"><span class="line-number">1689</span><span class="code-content">const morgan = require(&#039;morgan&#039;);</span></pre>
            <pre class="line"><span class="line-number">1690</span><span class="code-content">const path = require(&#039;path&#039;);</span></pre>
            <pre class="line"><span class="line-number">1691</span><span class="code-content">const dotenv = require(&#039;dotenv&#039;);</span></pre>
            <pre class="line"><span class="line-number">1692</span><span class="code-content">const { ensureDirectoryExists } = require(&#039;./utils/file&#039;);</span></pre>
            <pre class="line"><span class="line-number">1693</span><span class="code-content">const config = require(&#039;./config/default&#039;);</span></pre>
            <pre class="line"><span class="line-number">1694</span><span class="code-content">const routes = require(&#039;./routes&#039;);</span></pre>
            <pre class="line"><span class="line-number">1695</span><span class="code-content">const logger = require(&#039;./utils/logger&#039;);</span></pre>
            <pre class="line"><span class="line-number">1696</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1697</span><span class="code-content">// 加载环境变量</span></pre>
            <pre class="line"><span class="line-number">1698</span><span class="code-content">dotenv.config();</span></pre>
            <pre class="line"><span class="line-number">1699</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1700</span><span class="code-content">// 创建Express应用</span></pre>
            <pre class="line"><span class="line-number">1701</span><span class="code-content">const app = express();</span></pre>
            <pre class="line"><span class="line-number">1702</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1703</span><span class="code-content">// 确保上传和日志目录存在</span></pre>
            <pre class="line"><span class="line-number">1704</span><span class="code-content">ensureDirectoryExists(config.upload.directory);</span></pre>
            <pre class="line"><span class="line-number">1705</span><span class="code-content">ensureDirectoryExists(path.join(__dirname, &#039;logs&#039;));</span></pre>
            <pre class="line"><span class="line-number">1706</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1707</span><span class="code-content">// 配置中间件</span></pre>
            <pre class="line"><span class="line-number">1708</span><span class="code-content">app.use(cors({</span></pre>
            <pre class="line"><span class="line-number">1709</span><span class="code-content">  origin: config.server.corsOrigins</span></pre>
            <pre class="line"><span class="line-number">1710</span><span class="code-content">}));</span></pre>
            <pre class="line"><span class="line-number">1711</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1712</span><span class="code-content">// JSON解析中间件</span></pre>
            <pre class="line"><span class="line-number">1713</span><span class="code-content">app.use(express.json({ limit: &#039;5mb&#039; }));</span></pre>
            <pre class="line"><span class="line-number">1714</span><span class="code-content">app.use(express.urlencoded({ extended: true, limit: &#039;5mb&#039; }));</span></pre>
            <pre class="line"><span class="line-number">1715</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1716</span><span class="code-content">// 请求日志</span></pre>
            <pre class="line"><span class="line-number">1717</span><span class="code-content">app.use(morgan(&#039;dev&#039;));</span></pre>
            <pre class="line"><span class="line-number">1718</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1719</span><span class="code-content">// 静态文件服务 - 前端资源</span></pre>
            <pre class="line"><span class="line-number">1720</span><span class="code-content">app.use(express.static(path.join(__dirname, &#039;public&#039;)));</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 50 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1721</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1722</span><span class="code-content">// API路由</span></pre>
            <pre class="line"><span class="line-number">1723</span><span class="code-content">app.use(&#039;/api&#039;, routes);</span></pre>
            <pre class="line"><span class="line-number">1724</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1725</span><span class="code-content">// 错误处理中间件</span></pre>
            <pre class="line"><span class="line-number">1726</span><span class="code-content">app.use((err, req, res, next) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1727</span><span class="code-content">  logger.error(&#039;应用程序错误&#039;, err);</span></pre>
            <pre class="line"><span class="line-number">1728</span><span class="code-content">  res.status(err.status || 500).json({</span></pre>
            <pre class="line"><span class="line-number">1729</span><span class="code-content">    error: err.message || &#039;服务器内部错误&#039;</span></pre>
            <pre class="line"><span class="line-number">1730</span><span class="code-content">  });</span></pre>
            <pre class="line"><span class="line-number">1731</span><span class="code-content">});</span></pre>
            <pre class="line"><span class="line-number">1732</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1733</span><span class="code-content">// 未找到路由处理</span></pre>
            <pre class="line"><span class="line-number">1734</span><span class="code-content">app.use((req, res) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1735</span><span class="code-content">  res.status(404).json({</span></pre>
            <pre class="line"><span class="line-number">1736</span><span class="code-content">    error: &#039;未找到请求的资源&#039;</span></pre>
            <pre class="line"><span class="line-number">1737</span><span class="code-content">  });</span></pre>
            <pre class="line"><span class="line-number">1738</span><span class="code-content">});</span></pre>
            <pre class="line"><span class="line-number">1739</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1740</span><span class="code-content">module.exports = app; </span></pre>
            <pre class="line"><span class="line-number">1741</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1742</span><span class="code-content">// restructure/server/server.js</span></pre>
            <pre class="line"><span class="line-number">1743</span><span class="code-content">/**</span></pre>
            <pre class="line"><span class="line-number">1744</span><span class="code-content"> * 服务器入口文件</span></pre>
            <pre class="line"><span class="line-number">1745</span><span class="code-content"> * 负责启动HTTP服务</span></pre>
            <pre class="line"><span class="line-number">1746</span><span class="code-content"> */</span></pre>
            <pre class="line"><span class="line-number">1747</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1748</span><span class="code-content">const http = require(&#039;http&#039;);</span></pre>
            <pre class="line"><span class="line-number">1749</span><span class="code-content">const app = require(&#039;./app&#039;);</span></pre>
            <pre class="line"><span class="line-number">1750</span><span class="code-content">const config = require(&#039;./config/default&#039;);</span></pre>
            <pre class="line"><span class="line-number">1751</span><span class="code-content">const logger = require(&#039;./utils/logger&#039;);</span></pre>
            <pre class="line"><span class="line-number">1752</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1753</span><span class="code-content">// 设置端口</span></pre>
            <pre class="line"><span class="line-number">1754</span><span class="code-content">const port = parseInt(process.env.PORT || config.port, 10);</span></pre>
            <pre class="line"><span class="line-number">1755</span><span class="code-content">app.set(&#039;port&#039;, port);</span></pre>
            <pre class="line"><span class="line-number">1756</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1757</span><span class="code-content">// 创建HTTP服务器</span></pre>
            <pre class="line"><span class="line-number">1758</span><span class="code-content">const server = http.createServer(app);</span></pre>
            <pre class="line"><span class="line-number">1759</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1760</span><span class="code-content">// 监听指定端口</span></pre>
            <pre class="line"><span class="line-number">1761</span><span class="code-content">server.listen(port);</span></pre>
            <pre class="line"><span class="line-number">1762</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1763</span><span class="code-content">// 服务器事件处理</span></pre>
            <pre class="line"><span class="line-number">1764</span><span class="code-content">server.on(&#039;error&#039;, (error) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1765</span><span class="code-content">  if (error.syscall !== &#039;listen&#039;) {</span></pre>
            <pre class="line"><span class="line-number">1766</span><span class="code-content">    throw error;</span></pre>
            <pre class="line"><span class="line-number">1767</span><span class="code-content">  }</span></pre>
            <pre class="line"><span class="line-number">1768</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1769</span><span class="code-content">  const bind = typeof port === &#039;string&#039; ? &#039;Pipe &#039; + port : &#039;Port &#039; + port;</span></pre>
            <pre class="line"><span class="line-number">1770</span><span class="code-content"></span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 51 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1771</span><span class="code-content">  // 处理特定的监听错误</span></pre>
            <pre class="line"><span class="line-number">1772</span><span class="code-content">  switch (error.code) {</span></pre>
            <pre class="line"><span class="line-number">1773</span><span class="code-content">    case &#039;EACCES&#039;:</span></pre>
            <pre class="line"><span class="line-number">1774</span><span class="code-content">      logger.error(`${bind} 需要更高权限`);</span></pre>
            <pre class="line"><span class="line-number">1775</span><span class="code-content">      process.exit(1);</span></pre>
            <pre class="line"><span class="line-number">1776</span><span class="code-content">      break;</span></pre>
            <pre class="line"><span class="line-number">1777</span><span class="code-content">    case &#039;EADDRINUSE&#039;:</span></pre>
            <pre class="line"><span class="line-number">1778</span><span class="code-content">      logger.error(`${bind} 已被占用`);</span></pre>
            <pre class="line"><span class="line-number">1779</span><span class="code-content">      process.exit(1);</span></pre>
            <pre class="line"><span class="line-number">1780</span><span class="code-content">      break;</span></pre>
            <pre class="line"><span class="line-number">1781</span><span class="code-content">    default:</span></pre>
            <pre class="line"><span class="line-number">1782</span><span class="code-content">      throw error;</span></pre>
            <pre class="line"><span class="line-number">1783</span><span class="code-content">  }</span></pre>
            <pre class="line"><span class="line-number">1784</span><span class="code-content">});</span></pre>
            <pre class="line"><span class="line-number">1785</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1786</span><span class="code-content">server.on(&#039;listening&#039;, () =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1787</span><span class="code-content">  const addr = server.address();</span></pre>
            <pre class="line"><span class="line-number">1788</span><span class="code-content">  const bind = typeof addr === &#039;string&#039; ? &#039;pipe &#039; + addr : &#039;port &#039; + addr.port;</span></pre>
            <pre class="line"><span class="line-number">1789</span><span class="code-content">  logger.info(`服务器监听在 ${bind}`);</span></pre>
            <pre class="line"><span class="line-number">1790</span><span class="code-content">  console.log(`服务器已启动，监听在端口 ${port}`);</span></pre>
            <pre class="line"><span class="line-number">1791</span><span class="code-content">  console.log(`打开浏览器访问: http://localhost:${port}`);</span></pre>
            <pre class="line"><span class="line-number">1792</span><span class="code-content">});</span></pre>
            <pre class="line"><span class="line-number">1793</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1794</span><span class="code-content">// 处理未捕获的异常</span></pre>
            <pre class="line"><span class="line-number">1795</span><span class="code-content">process.on(&#039;uncaughtException&#039;, (error) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1796</span><span class="code-content">  logger.error(&#039;未捕获的异常:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1797</span><span class="code-content">  console.error(&#039;未捕获的异常:&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1798</span><span class="code-content">});</span></pre>
            <pre class="line"><span class="line-number">1799</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1800</span><span class="code-content">// 处理未处理的Promise拒绝</span></pre>
            <pre class="line"><span class="line-number">1801</span><span class="code-content">process.on(&#039;unhandledRejection&#039;, (reason, promise) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">1802</span><span class="code-content">  logger.error(&#039;未处理的Promise拒绝:&#039;, reason);</span></pre>
            <pre class="line"><span class="line-number">1803</span><span class="code-content">  console.error(&#039;未处理的Promise拒绝:&#039;, reason);</span></pre>
            <pre class="line"><span class="line-number">1804</span><span class="code-content">}); </span></pre>
            <pre class="line"><span class="line-number">1805</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1806</span><span class="code-content">// restructure/server/routes/index.js</span></pre>
            <pre class="line"><span class="line-number">1807</span><span class="code-content">/**</span></pre>
            <pre class="line"><span class="line-number">1808</span><span class="code-content"> * 路由模块</span></pre>
            <pre class="line"><span class="line-number">1809</span><span class="code-content"> * 集中管理所有API路由</span></pre>
            <pre class="line"><span class="line-number">1810</span><span class="code-content"> */</span></pre>
            <pre class="line"><span class="line-number">1811</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1812</span><span class="code-content">const express = require(&#039;express&#039;);</span></pre>
            <pre class="line"><span class="line-number">1813</span><span class="code-content">const router = express.Router();</span></pre>
            <pre class="line"><span class="line-number">1814</span><span class="code-content">const uploadMiddleware = require(&#039;../middleware/upload&#039;);</span></pre>
            <pre class="line"><span class="line-number">1815</span><span class="code-content">const fileController = require(&#039;../controllers/fileController&#039;);</span></pre>
            <pre class="line"><span class="line-number">1816</span><span class="code-content">const configController = require(&#039;../controllers/configController&#039;);</span></pre>
            <pre class="line"><span class="line-number">1817</span><span class="code-content">const systemController = require(&#039;../controllers/systemController&#039;);</span></pre>
            <pre class="line"><span class="line-number">1818</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1819</span><span class="code-content">// 系统相关路由</span></pre>
            <pre class="line"><span class="line-number">1820</span><span class="code-content">router.get(&#039;/health&#039;, systemController.healthCheck);</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 52 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1821</span><span class="code-content">router.get(&#039;/logs&#039;, systemController.getApiLogs);</span></pre>
            <pre class="line"><span class="line-number">1822</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1823</span><span class="code-content">// 文件上传和分析相关路由</span></pre>
            <pre class="line"><span class="line-number">1824</span><span class="code-content">router.post(&#039;/upload-and-analyze&#039;, uploadMiddleware.array(&#039;files&#039;), fileController.uploadAndAnalyze);</span></pre>
            <pre class="line"><span class="line-number">1825</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1826</span><span class="code-content">// API配置相关路由</span></pre>
            <pre class="line"><span class="line-number">1827</span><span class="code-content">router.get(&#039;/config&#039;, configController.getApiConfig);</span></pre>
            <pre class="line"><span class="line-number">1828</span><span class="code-content">router.post(&#039;/config&#039;, configController.updateApiConfig);</span></pre>
            <pre class="line"><span class="line-number">1829</span><span class="code-content">router.post(&#039;/test-connection&#039;, configController.testApiConnection);</span></pre>
            <pre class="line"><span class="line-number">1830</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1831</span><span class="code-content">module.exports = router; </span></pre>
            <pre class="line"><span class="line-number">1832</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1833</span><span class="code-content">// restructure/server/controllers/fileController.js</span></pre>
            <pre class="line"><span class="line-number">1834</span><span class="code-content">/**</span></pre>
            <pre class="line"><span class="line-number">1835</span><span class="code-content"> * 文件控制器</span></pre>
            <pre class="line"><span class="line-number">1836</span><span class="code-content"> * 处理文件上传和分析相关的请求</span></pre>
            <pre class="line"><span class="line-number">1837</span><span class="code-content"> */</span></pre>
            <pre class="line"><span class="line-number">1838</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1839</span><span class="code-content">const path = require(&#039;path&#039;);</span></pre>
            <pre class="line"><span class="line-number">1840</span><span class="code-content">const { analyzeExcelContent } = require(&#039;../services/excel&#039;);</span></pre>
            <pre class="line"><span class="line-number">1841</span><span class="code-content">const logger = require(&#039;../utils/logger&#039;);</span></pre>
            <pre class="line"><span class="line-number">1842</span><span class="code-content">const { deleteFile } = require(&#039;../utils/file&#039;);</span></pre>
            <pre class="line"><span class="line-number">1843</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1844</span><span class="code-content">/**</span></pre>
            <pre class="line"><span class="line-number">1845</span><span class="code-content"> * 上传并分析文件</span></pre>
            <pre class="line"><span class="line-number">1846</span><span class="code-content"> * @param {Object} req - 请求对象</span></pre>
            <pre class="line"><span class="line-number">1847</span><span class="code-content"> * @param {Object} res - 响应对象</span></pre>
            <pre class="line"><span class="line-number">1848</span><span class="code-content"> */</span></pre>
            <pre class="line"><span class="line-number">1849</span><span class="code-content">async function uploadAndAnalyze(req, res) {</span></pre>
            <pre class="line"><span class="line-number">1850</span><span class="code-content">  try {</span></pre>
            <pre class="line"><span class="line-number">1851</span><span class="code-content">    // 检查是否有文件上传</span></pre>
            <pre class="line"><span class="line-number">1852</span><span class="code-content">    if (!req.files || req.files.length === 0) {</span></pre>
            <pre class="line"><span class="line-number">1853</span><span class="code-content">      return res.status(400).json({ error: &#039;未上传文件&#039; });</span></pre>
            <pre class="line"><span class="line-number">1854</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">1855</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1856</span><span class="code-content">    // 获取搜索内容</span></pre>
            <pre class="line"><span class="line-number">1857</span><span class="code-content">    const searchContent = req.body.searchContent;</span></pre>
            <pre class="line"><span class="line-number">1858</span><span class="code-content">    if (!searchContent) {</span></pre>
            <pre class="line"><span class="line-number">1859</span><span class="code-content">      return res.status(400).json({ error: &#039;未提供搜索内容&#039; });</span></pre>
            <pre class="line"><span class="line-number">1860</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">1861</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1862</span><span class="code-content">    // 获取分析选项</span></pre>
            <pre class="line"><span class="line-number">1863</span><span class="code-content">    const options = {</span></pre>
            <pre class="line"><span class="line-number">1864</span><span class="code-content">      understandingMode: req.body.understandingMode || &#039;semantic&#039;,</span></pre>
            <pre class="line"><span class="line-number">1865</span><span class="code-content">      minRelevanceThreshold: parseInt(req.body.minRelevanceThreshold || &#039;0&#039;, 10),</span></pre>
            <pre class="line"><span class="line-number">1866</span><span class="code-content">      analysisDepth: req.body.analysisDepth || &#039;shallow&#039;</span></pre>
            <pre class="line"><span class="line-number">1867</span><span class="code-content">    };</span></pre>
            <pre class="line"><span class="line-number">1868</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1869</span><span class="code-content">    logger.info(`开始分析 ${req.files.length} 个文件，搜索内容: &quot;${searchContent}&quot;`, {</span></pre>
            <pre class="line"><span class="line-number">1870</span><span class="code-content">      options,</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 53 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1871</span><span class="code-content">      filesCount: req.files.length</span></pre>
            <pre class="line"><span class="line-number">1872</span><span class="code-content">    });</span></pre>
            <pre class="line"><span class="line-number">1873</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1874</span><span class="code-content">    // 存储分析结果</span></pre>
            <pre class="line"><span class="line-number">1875</span><span class="code-content">    const results = [];</span></pre>
            <pre class="line"><span class="line-number">1876</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1877</span><span class="code-content">    // 处理每个文件</span></pre>
            <pre class="line"><span class="line-number">1878</span><span class="code-content">    for (const file of req.files) {</span></pre>
            <pre class="line"><span class="line-number">1879</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">1880</span><span class="code-content">        const filePath = file.path;</span></pre>
            <pre class="line"><span class="line-number">1881</span><span class="code-content">        const originalName = file.decodedOriginalName || file.originalname;</span></pre>
            <pre class="line"><span class="line-number">1882</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1883</span><span class="code-content">        logger.info(`分析文件: ${originalName}`);</span></pre>
            <pre class="line"><span class="line-number">1884</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1885</span><span class="code-content">        // 分析文件内容</span></pre>
            <pre class="line"><span class="line-number">1886</span><span class="code-content">        const analysisResult = await analyzeExcelContent(filePath, searchContent, options);</span></pre>
            <pre class="line"><span class="line-number">1887</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1888</span><span class="code-content">        // 组织结果</span></pre>
            <pre class="line"><span class="line-number">1889</span><span class="code-content">        results.push({</span></pre>
            <pre class="line"><span class="line-number">1890</span><span class="code-content">          fileName: originalName,</span></pre>
            <pre class="line"><span class="line-number">1891</span><span class="code-content">          fileSize: file.size,</span></pre>
            <pre class="line"><span class="line-number">1892</span><span class="code-content">          relevance: analysisResult.score,</span></pre>
            <pre class="line"><span class="line-number">1893</span><span class="code-content">          matchedLines: analysisResult.matchedLines,</span></pre>
            <pre class="line"><span class="line-number">1894</span><span class="code-content">          sheets: analysisResult.sheets,</span></pre>
            <pre class="line"><span class="line-number">1895</span><span class="code-content">          totalMatches: analysisResult.totalMatches,</span></pre>
            <pre class="line"><span class="line-number">1896</span><span class="code-content">          matchCountExceedsLimit: analysisResult.matchCountExceedsLimit,</span></pre>
            <pre class="line"><span class="line-number">1897</span><span class="code-content">          apiSkipped: analysisResult.apiSkipped,</span></pre>
            <pre class="line"><span class="line-number">1898</span><span class="code-content">          apiWarning: analysisResult.apiWarning,</span></pre>
            <pre class="line"><span class="line-number">1899</span><span class="code-content">          error: analysisResult.error</span></pre>
            <pre class="line"><span class="line-number">1900</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1901</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1902</span><span class="code-content">        // 删除临时文件</span></pre>
            <pre class="line"><span class="line-number">1903</span><span class="code-content">        deleteFile(filePath);</span></pre>
            <pre class="line"><span class="line-number">1904</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1905</span><span class="code-content">      } catch (fileError) {</span></pre>
            <pre class="line"><span class="line-number">1906</span><span class="code-content">        logger.error(`处理文件失败: ${file.originalname}`, fileError);</span></pre>
            <pre class="line"><span class="line-number">1907</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1908</span><span class="code-content">        // 添加错误结果</span></pre>
            <pre class="line"><span class="line-number">1909</span><span class="code-content">        results.push({</span></pre>
            <pre class="line"><span class="line-number">1910</span><span class="code-content">          fileName: file.decodedOriginalName || file.originalname,</span></pre>
            <pre class="line"><span class="line-number">1911</span><span class="code-content">          fileSize: file.size,</span></pre>
            <pre class="line"><span class="line-number">1912</span><span class="code-content">          relevance: 0,</span></pre>
            <pre class="line"><span class="line-number">1913</span><span class="code-content">          error: `处理文件时出错: ${fileError.message}`</span></pre>
            <pre class="line"><span class="line-number">1914</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">1915</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">1916</span><span class="code-content">        // 删除临时文件</span></pre>
            <pre class="line"><span class="line-number">1917</span><span class="code-content">        if (file.path) {</span></pre>
            <pre class="line"><span class="line-number">1918</span><span class="code-content">          deleteFile(file.path);</span></pre>
            <pre class="line"><span class="line-number">1919</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">1920</span><span class="code-content">      }</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 54 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1921</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">1922</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1923</span><span class="code-content">    // 返回结果</span></pre>
            <pre class="line"><span class="line-number">1924</span><span class="code-content">    logger.info(`分析完成，找到 ${results.length} 个结果`);</span></pre>
            <pre class="line"><span class="line-number">1925</span><span class="code-content">    return res.json({ results });</span></pre>
            <pre class="line"><span class="line-number">1926</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1927</span><span class="code-content">  } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">1928</span><span class="code-content">    logger.error(&#039;上传分析处理失败&#039;, error);</span></pre>
            <pre class="line"><span class="line-number">1929</span><span class="code-content">    return res.status(500).json({ error: `处理请求失败: ${error.message}` });</span></pre>
            <pre class="line"><span class="line-number">1930</span><span class="code-content">  }</span></pre>
            <pre class="line"><span class="line-number">1931</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">1932</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1933</span><span class="code-content">module.exports = {</span></pre>
            <pre class="line"><span class="line-number">1934</span><span class="code-content">  uploadAndAnalyze</span></pre>
            <pre class="line"><span class="line-number">1935</span><span class="code-content">}; </span></pre>
            <pre class="line"><span class="line-number">1936</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1937</span><span class="code-content">// restructure/server/services/excel.js</span></pre>
            <pre class="line"><span class="line-number">1938</span><span class="code-content">/**</span></pre>
            <pre class="line"><span class="line-number">1939</span><span class="code-content"> * Excel分析服务</span></pre>
            <pre class="line"><span class="line-number">1940</span><span class="code-content"> * 提供Excel文件内容分析功能</span></pre>
            <pre class="line"><span class="line-number">1941</span><span class="code-content"> */</span></pre>
            <pre class="line"><span class="line-number">1942</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1943</span><span class="code-content">const XLSX = require(&#039;xlsx&#039;);</span></pre>
            <pre class="line"><span class="line-number">1944</span><span class="code-content">const fs = require(&#039;fs&#039;);</span></pre>
            <pre class="line"><span class="line-number">1945</span><span class="code-content">const path = require(&#039;path&#039;);</span></pre>
            <pre class="line"><span class="line-number">1946</span><span class="code-content">const config = require(&#039;../config/default&#039;);</span></pre>
            <pre class="line"><span class="line-number">1947</span><span class="code-content">const logger = require(&#039;../utils/logger&#039;);</span></pre>
            <pre class="line"><span class="line-number">1948</span><span class="code-content">const aiService = require(&#039;./ai&#039;);</span></pre>
            <pre class="line"><span class="line-number">1949</span><span class="code-content">const { deleteFile } = require(&#039;../utils/file&#039;);</span></pre>
            <pre class="line"><span class="line-number">1950</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">1951</span><span class="code-content">/**</span></pre>
            <pre class="line"><span class="line-number">1952</span><span class="code-content"> * 分析Excel文件内容</span></pre>
            <pre class="line"><span class="line-number">1953</span><span class="code-content"> * @param {string} filePath - Excel文件路径</span></pre>
            <pre class="line"><span class="line-number">1954</span><span class="code-content"> * @param {string} searchContent - 搜索内容</span></pre>
            <pre class="line"><span class="line-number">1955</span><span class="code-content"> * @param {Object} options - 分析选项</span></pre>
            <pre class="line"><span class="line-number">1956</span><span class="code-content"> * @returns {Object} 分析结果</span></pre>
            <pre class="line"><span class="line-number">1957</span><span class="code-content"> */</span></pre>
            <pre class="line"><span class="line-number">1958</span><span class="code-content">async function analyzeExcelContent(filePath, searchContent, options = {}) {</span></pre>
            <pre class="line"><span class="line-number">1959</span><span class="code-content">  // 设置默认选项</span></pre>
            <pre class="line"><span class="line-number">1960</span><span class="code-content">  const defaultOptions = {</span></pre>
            <pre class="line"><span class="line-number">1961</span><span class="code-content">    understandingMode: &#039;semantic&#039;, // semantic, exact, balanced</span></pre>
            <pre class="line"><span class="line-number">1962</span><span class="code-content">    minRelevanceThreshold: 0,</span></pre>
            <pre class="line"><span class="line-number">1963</span><span class="code-content">    analysisDepth: &#039;shallow&#039; // shallow, deep</span></pre>
            <pre class="line"><span class="line-number">1964</span><span class="code-content">  };</span></pre>
            <pre class="line"><span class="line-number">1965</span><span class="code-content">  </span></pre>
            <pre class="line"><span class="line-number">1966</span><span class="code-content">  // 合并选项</span></pre>
            <pre class="line"><span class="line-number">1967</span><span class="code-content">  const analysisOptions = { ...defaultOptions, ...options };</span></pre>
            <pre class="line"><span class="line-number">1968</span><span class="code-content">  </span></pre>
            <pre class="line"><span class="line-number">1969</span><span class="code-content">  try {</span></pre>
            <pre class="line"><span class="line-number">1970</span><span class="code-content">    if (!fs.existsSync(filePath)) {</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 55 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">1971</span><span class="code-content">      logger.error(`文件未找到: ${filePath}`);</span></pre>
            <pre class="line"><span class="line-number">1972</span><span class="code-content">      return { score: 0, error: &#039;文件未找到&#039; };</span></pre>
            <pre class="line"><span class="line-number">1973</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">1974</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1975</span><span class="code-content">    // 读取Excel文件</span></pre>
            <pre class="line"><span class="line-number">1976</span><span class="code-content">    let workbook;</span></pre>
            <pre class="line"><span class="line-number">1977</span><span class="code-content">    try {</span></pre>
            <pre class="line"><span class="line-number">1978</span><span class="code-content">      // 使用更高效的选项读取，只读取可见工作表</span></pre>
            <pre class="line"><span class="line-number">1979</span><span class="code-content">      workbook = XLSX.readFile(filePath, {</span></pre>
            <pre class="line"><span class="line-number">1980</span><span class="code-content">        type: &#039;binary&#039;,</span></pre>
            <pre class="line"><span class="line-number">1981</span><span class="code-content">        sheetStubs: true,  // 生成空单元格</span></pre>
            <pre class="line"><span class="line-number">1982</span><span class="code-content">        cellStyles: false, // 不读取样式信息，提高性能</span></pre>
            <pre class="line"><span class="line-number">1983</span><span class="code-content">        bookVBA: false,    // 不读取宏，提高性能</span></pre>
            <pre class="line"><span class="line-number">1984</span><span class="code-content">        cellDates: true,   // 将日期转换为JS日期对象</span></pre>
            <pre class="line"><span class="line-number">1985</span><span class="code-content">        dateNF: &#039;yyyy-mm-dd&#039; // 日期格式</span></pre>
            <pre class="line"><span class="line-number">1986</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">1987</span><span class="code-content">    } catch (readError) {</span></pre>
            <pre class="line"><span class="line-number">1988</span><span class="code-content">      logger.error(`读取Excel文件 ${path.basename(filePath)} 出错:`, readError);</span></pre>
            <pre class="line"><span class="line-number">1989</span><span class="code-content">      return { score: 0, error: &#039;无法读取Excel文件&#039; };</span></pre>
            <pre class="line"><span class="line-number">1990</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">1991</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1992</span><span class="code-content">    // 确保有工作表</span></pre>
            <pre class="line"><span class="line-number">1993</span><span class="code-content">    if (!workbook.SheetNames || workbook.SheetNames.length === 0) {</span></pre>
            <pre class="line"><span class="line-number">1994</span><span class="code-content">      return { score: 0, error: &#039;Excel文件没有工作表&#039; };</span></pre>
            <pre class="line"><span class="line-number">1995</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">1996</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">1997</span><span class="code-content">    // 设置最大匹配行数限制，避免返回过多数据</span></pre>
            <pre class="line"><span class="line-number">1998</span><span class="code-content">    const MAX_MATCHED_LINES = config.analysis.maxMatchedLines;</span></pre>
            <pre class="line"><span class="line-number">1999</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2000</span><span class="code-content">    // 分析所有工作表</span></pre>
            <pre class="line"><span class="line-number">2001</span><span class="code-content">    const sheets = [];</span></pre>
            <pre class="line"><span class="line-number">2002</span><span class="code-content">    const matchedLines = [];</span></pre>
            <pre class="line"><span class="line-number">2003</span><span class="code-content">    let matchCountExceedsLimit = false;</span></pre>
            <pre class="line"><span class="line-number">2004</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2005</span><span class="code-content">    // 如果搜索内容为空，则返回0分</span></pre>
            <pre class="line"><span class="line-number">2006</span><span class="code-content">    if (!searchContent || searchContent.trim() === &#039;&#039;) {</span></pre>
            <pre class="line"><span class="line-number">2007</span><span class="code-content">      return { score: 0, error: &#039;搜索内容为空&#039; };</span></pre>
            <pre class="line"><span class="line-number">2008</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2009</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2010</span><span class="code-content">    // 转为小写以便不区分大小写比较</span></pre>
            <pre class="line"><span class="line-number">2011</span><span class="code-content">    const searchContentLower = searchContent.toLowerCase();</span></pre>
            <pre class="line"><span class="line-number">2012</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2013</span><span class="code-content">    // 处理每个工作表</span></pre>
            <pre class="line"><span class="line-number">2014</span><span class="code-content">    for (const sheetName of workbook.SheetNames) {</span></pre>
            <pre class="line"><span class="line-number">2015</span><span class="code-content">      // 如果已达到最大匹配数，跳过后续工作表</span></pre>
            <pre class="line"><span class="line-number">2016</span><span class="code-content">      if (matchedLines.length &gt;= MAX_MATCHED_LINES) {</span></pre>
            <pre class="line"><span class="line-number">2017</span><span class="code-content">        matchCountExceedsLimit = true;</span></pre>
            <pre class="line"><span class="line-number">2018</span><span class="code-content">        break;</span></pre>
            <pre class="line"><span class="line-number">2019</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">2020</span><span class="code-content">      </span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 56 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">2021</span><span class="code-content">      const worksheet = workbook.Sheets[sheetName];</span></pre>
            <pre class="line"><span class="line-number">2022</span><span class="code-content">      if (!worksheet) continue; // 跳过无效的工作表</span></pre>
            <pre class="line"><span class="line-number">2023</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">2024</span><span class="code-content">      // 转换为JSON</span></pre>
            <pre class="line"><span class="line-number">2025</span><span class="code-content">      let jsonData;</span></pre>
            <pre class="line"><span class="line-number">2026</span><span class="code-content">      try {</span></pre>
            <pre class="line"><span class="line-number">2027</span><span class="code-content">        jsonData = XLSX.utils.sheet_to_json(worksheet, { </span></pre>
            <pre class="line"><span class="line-number">2028</span><span class="code-content">          header: 1,</span></pre>
            <pre class="line"><span class="line-number">2029</span><span class="code-content">          raw: false, // 将所有值转为字符串以简化搜索</span></pre>
            <pre class="line"><span class="line-number">2030</span><span class="code-content">          defval: &#039;&#039;  // 空单元格的默认值</span></pre>
            <pre class="line"><span class="line-number">2031</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">2032</span><span class="code-content">      } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">2033</span><span class="code-content">        logger.error(`解析工作表 ${sheetName} 出错:`, error);</span></pre>
            <pre class="line"><span class="line-number">2034</span><span class="code-content">        continue; // 跳过出错的工作表</span></pre>
            <pre class="line"><span class="line-number">2035</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">2036</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">2037</span><span class="code-content">      // 存储这个工作表的信息</span></pre>
            <pre class="line"><span class="line-number">2038</span><span class="code-content">      sheets.push({</span></pre>
            <pre class="line"><span class="line-number">2039</span><span class="code-content">        name: sheetName,</span></pre>
            <pre class="line"><span class="line-number">2040</span><span class="code-content">        rowCount: jsonData.length</span></pre>
            <pre class="line"><span class="line-number">2041</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">2042</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">2043</span><span class="code-content">      // 查找匹配的行</span></pre>
            <pre class="line"><span class="line-number">2044</span><span class="code-content">      for (let rowIndex = 0; rowIndex &lt; jsonData.length; rowIndex++) {</span></pre>
            <pre class="line"><span class="line-number">2045</span><span class="code-content">        // 如果已达到最大匹配数，跳出循环</span></pre>
            <pre class="line"><span class="line-number">2046</span><span class="code-content">        if (matchedLines.length &gt;= MAX_MATCHED_LINES) {</span></pre>
            <pre class="line"><span class="line-number">2047</span><span class="code-content">          matchCountExceedsLimit = true;</span></pre>
            <pre class="line"><span class="line-number">2048</span><span class="code-content">          break;</span></pre>
            <pre class="line"><span class="line-number">2049</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">2050</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">2051</span><span class="code-content">        const row = jsonData[rowIndex];</span></pre>
            <pre class="line"><span class="line-number">2052</span><span class="code-content">        if (!row || row.length === 0) continue;</span></pre>
            <pre class="line"><span class="line-number">2053</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">2054</span><span class="code-content">        // 过滤掉空值，并转为字符串</span></pre>
            <pre class="line"><span class="line-number">2055</span><span class="code-content">        const filteredRow = row.map(cell =&gt; {</span></pre>
            <pre class="line"><span class="line-number">2056</span><span class="code-content">          // 处理各种类型的单元格值</span></pre>
            <pre class="line"><span class="line-number">2057</span><span class="code-content">          if (cell === null || cell === undefined) return &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">2058</span><span class="code-content">          if (typeof cell === &#039;object&#039;) {</span></pre>
            <pre class="line"><span class="line-number">2059</span><span class="code-content">            // 处理日期或其他复杂对象</span></pre>
            <pre class="line"><span class="line-number">2060</span><span class="code-content">            if (cell instanceof Date) {</span></pre>
            <pre class="line"><span class="line-number">2061</span><span class="code-content">              return cell.toISOString().split(&#039;T&#039;)[0]; // 只返回日期部分</span></pre>
            <pre class="line"><span class="line-number">2062</span><span class="code-content">            }</span></pre>
            <pre class="line"><span class="line-number">2063</span><span class="code-content">            return JSON.stringify(cell);</span></pre>
            <pre class="line"><span class="line-number">2064</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">2065</span><span class="code-content">          return String(cell);</span></pre>
            <pre class="line"><span class="line-number">2066</span><span class="code-content">        });</span></pre>
            <pre class="line"><span class="line-number">2067</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">2068</span><span class="code-content">        const rowText = filteredRow.join(&#039; &#039;);</span></pre>
            <pre class="line"><span class="line-number">2069</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">2070</span><span class="code-content">        // 不区分大小写搜索</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 57 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">2071</span><span class="code-content">        if (rowText.toLowerCase().includes(searchContentLower)) {</span></pre>
            <pre class="line"><span class="line-number">2072</span><span class="code-content">          matchedLines.push({</span></pre>
            <pre class="line"><span class="line-number">2073</span><span class="code-content">            sheet: sheetName,</span></pre>
            <pre class="line"><span class="line-number">2074</span><span class="code-content">            row: rowIndex + 1, // Excel行号从1开始</span></pre>
            <pre class="line"><span class="line-number">2075</span><span class="code-content">            content: rowText,</span></pre>
            <pre class="line"><span class="line-number">2076</span><span class="code-content">            cells: filteredRow</span></pre>
            <pre class="line"><span class="line-number">2077</span><span class="code-content">          });</span></pre>
            <pre class="line"><span class="line-number">2078</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">2079</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">2080</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2081</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2082</span><span class="code-content">    // 提取用于分析的文本样本</span></pre>
            <pre class="line"><span class="line-number">2083</span><span class="code-content">    let textForAnalysis = &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">2084</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2085</span><span class="code-content">    // 如果有匹配行，优先使用匹配行的内容</span></pre>
            <pre class="line"><span class="line-number">2086</span><span class="code-content">    if (matchedLines.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">2087</span><span class="code-content">      // 使用匹配行构建上下文，但同时保留一些非匹配行以获取更完整的上下文</span></pre>
            <pre class="line"><span class="line-number">2088</span><span class="code-content">      const matchedTexts = matchedLines.map(line =&gt; line.content);</span></pre>
            <pre class="line"><span class="line-number">2089</span><span class="code-content">      textForAnalysis = matchedTexts.join(&#039;\n\n&#039;);</span></pre>
            <pre class="line"><span class="line-number">2090</span><span class="code-content">    } else {</span></pre>
            <pre class="line"><span class="line-number">2091</span><span class="code-content">      // 从所有工作表中提取内容样本</span></pre>
            <pre class="line"><span class="line-number">2092</span><span class="code-content">      for (const sheetName of workbook.SheetNames) {</span></pre>
            <pre class="line"><span class="line-number">2093</span><span class="code-content">        const worksheet = workbook.Sheets[sheetName];</span></pre>
            <pre class="line"><span class="line-number">2094</span><span class="code-content">        if (!worksheet) continue;</span></pre>
            <pre class="line"><span class="line-number">2095</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">2096</span><span class="code-content">        try {</span></pre>
            <pre class="line"><span class="line-number">2097</span><span class="code-content">          const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });</span></pre>
            <pre class="line"><span class="line-number">2098</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">2099</span><span class="code-content">          textForAnalysis += `【工作表: ${sheetName}】\n`;</span></pre>
            <pre class="line"><span class="line-number">2100</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">2101</span><span class="code-content">          // 提取更多内容，最多处理15行</span></pre>
            <pre class="line"><span class="line-number">2102</span><span class="code-content">          const sampleRows = jsonData.slice(0, 15);</span></pre>
            <pre class="line"><span class="line-number">2103</span><span class="code-content">          for (const row of sampleRows) {</span></pre>
            <pre class="line"><span class="line-number">2104</span><span class="code-content">            if (row &amp;&amp; row.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">2105</span><span class="code-content">              const rowText = row</span></pre>
            <pre class="line"><span class="line-number">2106</span><span class="code-content">                .filter(cell =&gt; cell !== null &amp;&amp; cell !== undefined)</span></pre>
            <pre class="line"><span class="line-number">2107</span><span class="code-content">                .map(cell =&gt; {</span></pre>
            <pre class="line"><span class="line-number">2108</span><span class="code-content">                  if (typeof cell === &#039;object&#039;) {</span></pre>
            <pre class="line"><span class="line-number">2109</span><span class="code-content">                    if (cell instanceof Date) {</span></pre>
            <pre class="line"><span class="line-number">2110</span><span class="code-content">                      return cell.toISOString().split(&#039;T&#039;)[0];</span></pre>
            <pre class="line"><span class="line-number">2111</span><span class="code-content">                    }</span></pre>
            <pre class="line"><span class="line-number">2112</span><span class="code-content">                    return JSON.stringify(cell);</span></pre>
            <pre class="line"><span class="line-number">2113</span><span class="code-content">                  }</span></pre>
            <pre class="line"><span class="line-number">2114</span><span class="code-content">                  return String(cell);</span></pre>
            <pre class="line"><span class="line-number">2115</span><span class="code-content">                })</span></pre>
            <pre class="line"><span class="line-number">2116</span><span class="code-content">                .join(&#039; | &#039;);</span></pre>
            <pre class="line"><span class="line-number">2117</span><span class="code-content">                </span></pre>
            <pre class="line"><span class="line-number">2118</span><span class="code-content">              if (rowText.trim()) {</span></pre>
            <pre class="line"><span class="line-number">2119</span><span class="code-content">                textForAnalysis += rowText + &#039;\n&#039;;</span></pre>
            <pre class="line"><span class="line-number">2120</span><span class="code-content">              }</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 58 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">2121</span><span class="code-content">              </span></pre>
            <pre class="line"><span class="line-number">2122</span><span class="code-content">              // 如果已收集足够的文本，停止收集当前工作表</span></pre>
            <pre class="line"><span class="line-number">2123</span><span class="code-content">              if (textForAnalysis.length &gt; 3000) {</span></pre>
            <pre class="line"><span class="line-number">2124</span><span class="code-content">                textForAnalysis += `[...工作表${sheetName}包含更多内容...]\n`;</span></pre>
            <pre class="line"><span class="line-number">2125</span><span class="code-content">                break;</span></pre>
            <pre class="line"><span class="line-number">2126</span><span class="code-content">              }</span></pre>
            <pre class="line"><span class="line-number">2127</span><span class="code-content">            }</span></pre>
            <pre class="line"><span class="line-number">2128</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">2129</span><span class="code-content">          </span></pre>
            <pre class="line"><span class="line-number">2130</span><span class="code-content">          textForAnalysis += &#039;\n&#039;;</span></pre>
            <pre class="line"><span class="line-number">2131</span><span class="code-content">        } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">2132</span><span class="code-content">          logger.error(`提取工作表 ${sheetName} 样本时出错:`, error);</span></pre>
            <pre class="line"><span class="line-number">2133</span><span class="code-content">          continue; // 跳过出错的工作表</span></pre>
            <pre class="line"><span class="line-number">2134</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">2135</span><span class="code-content">        </span></pre>
            <pre class="line"><span class="line-number">2136</span><span class="code-content">        // 如果已收集足够的总体文本，停止收集更多工作表</span></pre>
            <pre class="line"><span class="line-number">2137</span><span class="code-content">        if (textForAnalysis.length &gt; 4000) {</span></pre>
            <pre class="line"><span class="line-number">2138</span><span class="code-content">          const remainingSheets = workbook.SheetNames.slice(</span></pre>
            <pre class="line"><span class="line-number">2139</span><span class="code-content">            workbook.SheetNames.indexOf(sheetName) + 1</span></pre>
            <pre class="line"><span class="line-number">2140</span><span class="code-content">          );</span></pre>
            <pre class="line"><span class="line-number">2141</span><span class="code-content">          if (remainingSheets.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">2142</span><span class="code-content">            textForAnalysis += `[...文档还包含${remainingSheets.length}个工作表未显示...]\n`;</span></pre>
            <pre class="line"><span class="line-number">2143</span><span class="code-content">          }</span></pre>
            <pre class="line"><span class="line-number">2144</span><span class="code-content">          break;</span></pre>
            <pre class="line"><span class="line-number">2145</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">2146</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">2147</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2148</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2149</span><span class="code-content">    // 如果内容太少，可能不是一个有效的文档</span></pre>
            <pre class="line"><span class="line-number">2150</span><span class="code-content">    if (textForAnalysis.length &lt; 10) {</span></pre>
            <pre class="line"><span class="line-number">2151</span><span class="code-content">      return { score: 0, error: &#039;Excel文件内容不足&#039; };</span></pre>
            <pre class="line"><span class="line-number">2152</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2153</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2154</span><span class="code-content">    // 预处理文本，去除多余空白字符</span></pre>
            <pre class="line"><span class="line-number">2155</span><span class="code-content">    textForAnalysis = textForAnalysis.replace(/\s+/g, &#039; &#039;).trim();</span></pre>
            <pre class="line"><span class="line-number">2156</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2157</span><span class="code-content">    // 智能选择分析片段长度，根据语义内容提取关键部分</span></pre>
            <pre class="line"><span class="line-number">2158</span><span class="code-content">    let contentSnippet = &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">2159</span><span class="code-content">    const maxContentLength = analysisOptions.analysisDepth === &#039;deep&#039; ? </span></pre>
            <pre class="line"><span class="line-number">2160</span><span class="code-content">      config.analysis.maxContentLength * 1.5 : </span></pre>
            <pre class="line"><span class="line-number">2161</span><span class="code-content">      config.analysis.maxContentLength;</span></pre>
            <pre class="line"><span class="line-number">2162</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2163</span><span class="code-content">    if (textForAnalysis.length &lt;= maxContentLength) {</span></pre>
            <pre class="line"><span class="line-number">2164</span><span class="code-content">      // 如果总文本不超过限制，使用全部内容</span></pre>
            <pre class="line"><span class="line-number">2165</span><span class="code-content">      contentSnippet = textForAnalysis;</span></pre>
            <pre class="line"><span class="line-number">2166</span><span class="code-content">    } else if (matchedLines.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">2167</span><span class="code-content">      // 如果有匹配行，组合一些重要匹配行和上下文</span></pre>
            <pre class="line"><span class="line-number">2168</span><span class="code-content">      // 优先使用匹配度高的行</span></pre>
            <pre class="line"><span class="line-number">2169</span><span class="code-content">      const sortedMatches = [...matchedLines].sort((a, b) =&gt; {</span></pre>
            <pre class="line"><span class="line-number">2170</span><span class="code-content">        const scoreA = (a.content.toLowerCase().includes(searchContent.toLowerCase())) ? 2 : 1;</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 59 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">2171</span><span class="code-content">        const scoreB = (b.content.toLowerCase().includes(searchContent.toLowerCase())) ? 2 : 1;</span></pre>
            <pre class="line"><span class="line-number">2172</span><span class="code-content">        return scoreB - scoreA;</span></pre>
            <pre class="line"><span class="line-number">2173</span><span class="code-content">      });</span></pre>
            <pre class="line"><span class="line-number">2174</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">2175</span><span class="code-content">      // 取最重要的匹配行，最多1000字符</span></pre>
            <pre class="line"><span class="line-number">2176</span><span class="code-content">      let importantMatches = &#039;&#039;;</span></pre>
            <pre class="line"><span class="line-number">2177</span><span class="code-content">      for (const match of sortedMatches) {</span></pre>
            <pre class="line"><span class="line-number">2178</span><span class="code-content">        if (importantMatches.length + match.content.length + 10 &lt; 1000) {</span></pre>
            <pre class="line"><span class="line-number">2179</span><span class="code-content">          importantMatches += match.content + &#039;\n\n&#039;;</span></pre>
            <pre class="line"><span class="line-number">2180</span><span class="code-content">        } else {</span></pre>
            <pre class="line"><span class="line-number">2181</span><span class="code-content">          break;</span></pre>
            <pre class="line"><span class="line-number">2182</span><span class="code-content">        }</span></pre>
            <pre class="line"><span class="line-number">2183</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">2184</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">2185</span><span class="code-content">      // 添加文档开头的内容作为上下文</span></pre>
            <pre class="line"><span class="line-number">2186</span><span class="code-content">      const intro = textForAnalysis.substring(0, 500);</span></pre>
            <pre class="line"><span class="line-number">2187</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">2188</span><span class="code-content">      // 组合内容，确保总长度不超过maxContentLength</span></pre>
            <pre class="line"><span class="line-number">2189</span><span class="code-content">      contentSnippet = intro + &#039;\n\n&#039; + importantMatches;</span></pre>
            <pre class="line"><span class="line-number">2190</span><span class="code-content">      if (contentSnippet.length &gt; maxContentLength) {</span></pre>
            <pre class="line"><span class="line-number">2191</span><span class="code-content">        contentSnippet = contentSnippet.substring(0, maxContentLength);</span></pre>
            <pre class="line"><span class="line-number">2192</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">2193</span><span class="code-content">    } else {</span></pre>
            <pre class="line"><span class="line-number">2194</span><span class="code-content">      // 没有匹配行，使用文档的开头、中间和结尾部分</span></pre>
            <pre class="line"><span class="line-number">2195</span><span class="code-content">      const beginning = textForAnalysis.substring(0, maxContentLength * 0.4);</span></pre>
            <pre class="line"><span class="line-number">2196</span><span class="code-content">      const middle = textForAnalysis.substring(</span></pre>
            <pre class="line"><span class="line-number">2197</span><span class="code-content">        Math.floor(textForAnalysis.length / 2 - maxContentLength * 0.2),</span></pre>
            <pre class="line"><span class="line-number">2198</span><span class="code-content">        Math.floor(textForAnalysis.length / 2 + maxContentLength * 0.2)</span></pre>
            <pre class="line"><span class="line-number">2199</span><span class="code-content">      );</span></pre>
            <pre class="line"><span class="line-number">2200</span><span class="code-content">      const end = textForAnalysis.substring(textForAnalysis.length - maxContentLength * 0.2);</span></pre>
            <pre class="line"><span class="line-number">2201</span><span class="code-content">      </span></pre>
            <pre class="line"><span class="line-number">2202</span><span class="code-content">      contentSnippet = beginning + &#039;\n\n&#039; + middle + &#039;\n\n&#039; + end;</span></pre>
            <pre class="line"><span class="line-number">2203</span><span class="code-content">      if (contentSnippet.length &gt; maxContentLength) {</span></pre>
            <pre class="line"><span class="line-number">2204</span><span class="code-content">        contentSnippet = contentSnippet.substring(0, maxContentLength);</span></pre>
            <pre class="line"><span class="line-number">2205</span><span class="code-content">      }</span></pre>
            <pre class="line"><span class="line-number">2206</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2207</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2208</span><span class="code-content">    // 如果有明确的关键词匹配，可以跳过API调用直接返回较高分数</span></pre>
            <pre class="line"><span class="line-number">2209</span><span class="code-content">    if (matchedLines.length &gt; 5 &amp;&amp; (analysisOptions.understandingMode === &#039;exact&#039; || </span></pre>
            <pre class="line"><span class="line-number">2210</span><span class="code-content">        (analysisOptions.understandingMode === &#039;balanced&#039; &amp;&amp; matchedLines.length &gt; 10))) {</span></pre>
            <pre class="line"><span class="line-number">2211</span><span class="code-content">      logger.info(`文件 ${path.basename(filePath)} 有 ${matchedLines.length} 处直接匹配，跳过API分析 (${analysisOptions.understandingMode}模式)`);</span></pre>
            <pre class="line"><span class="line-number">2212</span><span class="code-content">      const score = 70 + Math.min(matchedLines.length, 30); // 基于匹配数计算分数，最高100</span></pre>
            <pre class="line"><span class="line-number">2213</span><span class="code-content">      return { </span></pre>
            <pre class="line"><span class="line-number">2214</span><span class="code-content">        score,</span></pre>
            <pre class="line"><span class="line-number">2215</span><span class="code-content">        matchedLines: matchedLines.length &gt; 0 ? matchedLines : null,</span></pre>
            <pre class="line"><span class="line-number">2216</span><span class="code-content">        sheets: sheets.map(s =&gt; s.name),</span></pre>
            <pre class="line"><span class="line-number">2217</span><span class="code-content">        totalMatches: matchedLines.length + (matchCountExceedsLimit ? &#039;+&#039; : &#039;&#039;),</span></pre>
            <pre class="line"><span class="line-number">2218</span><span class="code-content">        matchCountExceedsLimit,</span></pre>
            <pre class="line"><span class="line-number">2219</span><span class="code-content">        apiSkipped: true // 标记跳过了API调用</span></pre>
            <pre class="line"><span class="line-number">2220</span><span class="code-content">      };</span></pre>
        </div>
    </div>
    <div class="page">
        <div class="header">厦门佰能思维 ExcelAIFinder V1.0 源程序</div>
        <div class="page-number">第 60 页</div>
        <div class="content">
            <pre class="line"><span class="line-number">2221</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2222</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">2223</span><span class="code-content">    // 在精确匹配模式下，即使匹配较少也可以基于匹配结果返回分数</span></pre>
            <pre class="line"><span class="line-number">2224</span><span class="code-content">    if (analysisOptions.understandingMode === &#039;exact&#039; &amp;&amp; matchedLines.length &gt; 0) {</span></pre>
            <pre class="line"><span class="line-number">2225</span><span class="code-content">      const score = 50 + Math.min(matchedLines.length * 5, 50); // 基于匹配行数计算分数</span></pre>
            <pre class="line"><span class="line-number">2226</span><span class="code-content">      logger.info(`文件 ${path.basename(filePath)} 在精确匹配模式下发现 ${matchedLines.length} 处匹配，评分: ${score}`);</span></pre>
            <pre class="line"><span class="line-number">2227</span><span class="code-content">      return { </span></pre>
            <pre class="line"><span class="line-number">2228</span><span class="code-content">        score,</span></pre>
            <pre class="line"><span class="line-number">2229</span><span class="code-content">        matchedLines: matchedLines.length &gt; 0 ? matchedLines : null,</span></pre>
            <pre class="line"><span class="line-number">2230</span><span class="code-content">        sheets: sheets.map(s =&gt; s.name),</span></pre>
            <pre class="line"><span class="line-number">2231</span><span class="code-content">        totalMatches: matchedLines.length + (matchCountExceedsLimit ? &#039;+&#039; : &#039;&#039;),</span></pre>
            <pre class="line"><span class="line-number">2232</span><span class="code-content">        matchCountExceedsLimit,</span></pre>
            <pre class="line"><span class="line-number">2233</span><span class="code-content">        apiSkipped: true // 标记跳过了API调用</span></pre>
            <pre class="line"><span class="line-number">2234</span><span class="code-content">      };</span></pre>
            <pre class="line"><span class="line-number">2235</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2236</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2237</span><span class="code-content">    // 使用AI服务对内容进行评分</span></pre>
            <pre class="line"><span class="line-number">2238</span><span class="code-content">    const analysisResult = await aiService.analyzeContent(</span></pre>
            <pre class="line"><span class="line-number">2239</span><span class="code-content">      searchContent, </span></pre>
            <pre class="line"><span class="line-number">2240</span><span class="code-content">      contentSnippet, </span></pre>
            <pre class="line"><span class="line-number">2241</span><span class="code-content">      analysisOptions</span></pre>
            <pre class="line"><span class="line-number">2242</span><span class="code-content">    );</span></pre>
            <pre class="line"><span class="line-number">2243</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2244</span><span class="code-content">    // 如果有匹配行，确保相关度至少为50</span></pre>
            <pre class="line"><span class="line-number">2245</span><span class="code-content">    if (matchedLines.length &gt; 0 &amp;&amp; analysisResult.score &lt; 50) {</span></pre>
            <pre class="line"><span class="line-number">2246</span><span class="code-content">      const originalScore = analysisResult.score;</span></pre>
            <pre class="line"><span class="line-number">2247</span><span class="code-content">      analysisResult.score = 50 + Math.min(matchedLines.length * 2, 50); // 根据匹配行数增加分数，最高100</span></pre>
            <pre class="line"><span class="line-number">2248</span><span class="code-content">      logger.info(`文件 ${path.basename(filePath)} 有 ${matchedLines.length} 处直接匹配，将分数从 ${originalScore} 提高到 ${analysisResult.score}`);</span></pre>
            <pre class="line"><span class="line-number">2249</span><span class="code-content">    }</span></pre>
            <pre class="line"><span class="line-number">2250</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2251</span><span class="code-content">    // 组合结果</span></pre>
            <pre class="line"><span class="line-number">2252</span><span class="code-content">    return {</span></pre>
            <pre class="line"><span class="line-number">2253</span><span class="code-content">      score: analysisResult.score,</span></pre>
            <pre class="line"><span class="line-number">2254</span><span class="code-content">      matchedLines: matchedLines.length &gt; 0 ? matchedLines : null,</span></pre>
            <pre class="line"><span class="line-number">2255</span><span class="code-content">      sheets: sheets.map(s =&gt; s.name),</span></pre>
            <pre class="line"><span class="line-number">2256</span><span class="code-content">      totalMatches: matchedLines.length + (matchCountExceedsLimit ? &#039;+&#039; : &#039;&#039;),</span></pre>
            <pre class="line"><span class="line-number">2257</span><span class="code-content">      matchCountExceedsLimit,</span></pre>
            <pre class="line"><span class="line-number">2258</span><span class="code-content">      apiWarning: analysisResult.warning</span></pre>
            <pre class="line"><span class="line-number">2259</span><span class="code-content">    };</span></pre>
            <pre class="line"><span class="line-number">2260</span><span class="code-content">    </span></pre>
            <pre class="line"><span class="line-number">2261</span><span class="code-content">  } catch (error) {</span></pre>
            <pre class="line"><span class="line-number">2262</span><span class="code-content">    logger.error(`处理文件时发生错误:`, error);</span></pre>
            <pre class="line"><span class="line-number">2263</span><span class="code-content">    return { score: 0, error: `处理文件时发生错误: ${error.message}` };</span></pre>
            <pre class="line"><span class="line-number">2264</span><span class="code-content">  }</span></pre>
            <pre class="line"><span class="line-number">2265</span><span class="code-content">}</span></pre>
            <pre class="line"><span class="line-number">2266</span><span class="code-content"></span></pre>
            <pre class="line"><span class="line-number">2267</span><span class="code-content">module.exports = {</span></pre>
            <pre class="line"><span class="line-number">2268</span><span class="code-content">  analyzeExcelContent</span></pre>
            <pre class="line"><span class="line-number">2269</span><span class="code-content">}; </span></pre>
            <pre class="line"><span class="line-number">2270</span><span class="code-content"></span></pre>
        </div>
    </div>
</body>
</html>